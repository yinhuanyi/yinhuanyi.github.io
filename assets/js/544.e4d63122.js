(window.webpackJsonp=window.webpackJsonp||[]).push([[544],{2543:function(s,a,e){"use strict";e.r(a);var t=e(9),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"一-什么是vuex"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-什么是vuex"}},[s._v("#")]),s._v(" 一：什么是Vuex")]),s._v(" "),e("ul",[e("li",[s._v("说明")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。Vuex 也集成到 Vue 的官方调试工具 devtools extension，提供了诸如零配置的 time-travel 调试、状态快照导入导出等高级调试功能。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"二-在vue中引入vuex"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-在vue中引入vuex"}},[s._v("#")]),s._v(" 二：在Vue中引入Vuex")]),s._v(" "),e("h3",{attrs:{id:"一-在src-store-目录下-创建index-js、mutations-js、action-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-在src-store-目录下-创建index-js、mutations-js、action-js"}},[s._v("#")]),s._v(" "),e("code",[s._v("(一)：在src/store/目录下，创建index.js、mutations.js、action.js")])]),s._v(" "),e("ul",[e("li",[s._v("1：index.js内容如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import Vue from 'vue'\nimport Vuex from 'vuex'\nimport mutations from './mutations'\nimport actions from './action'\n\n// 应用Vuex\nVue.use(Vuex);\n\n// 声明状态\nconst state = {\n    // 登录用户名\n    username: '',\n    // 购物车商品数量\n    cartCount: 0\n}\n\n// 导出Vuex\nexport default new Vuex.Store({\n    // 下面是一种简写方式，state 等价于 state: state\n    state,\n    mutations,\n    actions\n})\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("ul",[e("li",[s._v("2：mutations.js内容如下, 这里其实是导出mutations")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// Vuex-mutations\nexport default {\n\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("3：action.js内容如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// Vuex-actions\nexport default {\n\t\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("4：在main.js中，导入Vuex，并且加入到Vue实例中")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// 导入index.js，也就是导入Vuex, 这里导入的./store，默认会导入./store/index.js\nimport store from './store'\n\n\n// 初始化Vue实例，将App.vue根组件渲染，并且将App组件挂载到id为app的节点上\nnew Vue({\n  // 这里是将Vuex挂载到Vue实例中\n  store,\n  // 如果属性key是router，value也是router，那么直接在这写router即可\n  router,\n  render: h =### h(App),\n}).$mount('#app');\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h2",{attrs:{id:"三-vuex如何进行数据的存储-dispatch-、传输-mutations-、提交-actions-、读取-this-store-state-使得在navheader中能够获取到值"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-vuex如何进行数据的存储-dispatch-、传输-mutations-、提交-actions-、读取-this-store-state-使得在navheader中能够获取到值"}},[s._v("#")]),s._v(" 三：Vuex如何进行数据的存储(dispatch)、传输(mutations)、提交(actions)、读取(this.$store.state)，使得在NavHeader中能够获取到值")]),s._v(" "),e("h3",{attrs:{id:"一-vuex的dispatch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-vuex的dispatch"}},[s._v("#")]),s._v(" "),e("code",[s._v("(一)：Vuex的dispatch")])]),s._v(" "),e("ul",[e("li",[s._v("在login.vue组件中的login()方法里面，存储用户登录成功后的用户名")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// 由于Vuex已经挂载到Vue实例，这里可以使用this.$store直接访问到Vuex\n// 当用户登录成功之后，需要将用户数据存储到Vuex中，由于这个存储是一个行为，需要dispatch一个saveUserName的action\n// 这是Vuex的第一步，存储\nthis.$store.dispatch('saveUserName', res.username);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("在App.vue组件的getUser方法中，将用户信息保存到Vuex里面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("      // 获取用户信息\n      getUser(){\n        // 如果用户已经登录了，那么就会写下cookie信息，那么再次访问/user的时候，会带上这个cookie信息\n        this.axios.get('/user').then((res)=>{\n          // 将用户信息保存到vuex里面\n          this.$store.dispatch('saveUserName', res.username);\n        })\n      },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("在App.vue组件的getCartCount方法中，将用户购物车商品数存储到Vuex里面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("      // 获取用户购物车信息总和\n      getCartCount(){\n        // 这个res就是sum的数量\n        this.axios.get('/carts/products/sum').then((res)=>{\n          this.$store.dispatch('saveCartCount', res);\n        })\n      },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"二-在store-mutations-js里面声明存储用户名、用户商品数的方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-在store-mutations-js里面声明存储用户名、用户商品数的方法"}},[s._v("#")]),s._v(" "),e("code",[s._v("(二)：在store/mutations.js里面声明存储用户名、用户商品数的方法")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// Vuex-mutations\nexport default {\n    // 这是第二步：传输\n    saveUserName(state, username){\n        state.username = username;\n    },\n\n    // 由于在store/index.js中声明的变量名称为cartCount，所以这里赋值也是cartCount\n    saveCartCount(state, count){\n        state.cartCount = count;\n    }\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h3",{attrs:{id:"三-在store-action-js里面commit存储用户名、用户商品数的方法提交"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-在store-action-js里面commit存储用户名、用户商品数的方法提交"}},[s._v("#")]),s._v(" "),e("code",[s._v("(三)：在store/action.js里面commit存储用户名、用户商品数的方法提交")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("// Vuex-actions\nexport default {\n    // 这里需要派发一个上下文对象context, 参数是username\n    // 这是第三步：提交方法，也就是真正的执行函数\n    saveUserName(context, username){\n        context.commit('saveUserName', username);\n    },\n\n    saveCartCount(context, count){\n        context.commit('saveCartCount', count);\n    }\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h3",{attrs:{id:"四-由于单页面的vue渲染-首先是渲染app-vue-会发起请求-请求就会产生延时-因此在navheader组件渲染的时候-通过this-store-state获取的属性值是空-所以username、cartcount两个变量需要使用计算属性申明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-由于单页面的vue渲染-首先是渲染app-vue-会发起请求-请求就会产生延时-因此在navheader组件渲染的时候-通过this-store-state获取的属性值是空-所以username、cartcount两个变量需要使用计算属性申明"}},[s._v("#")]),s._v(" "),e("code",[s._v("(四)：由于单页面的Vue渲染，首先是渲染App.vue，会发起请求，请求就会产生延时，因此在NavHeader组件渲染的时候，通过this.$store.state获取的属性值是空，所以username、cartCount两个变量需要使用计算属性申明")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1：在data属性中，删除username、cartCount两个变量\n\n2：将username、cartCount两个变量写在计算属性中，写成方法，一旦在App.vue组件中将username和cartCount的值请求到了，会存储到this.$store.state中，那么this.$store.state发生变化，就会重新给username、cartCount两个变量赋值\n// 计算属性目的是当this.$store.state.username值变化的时候，重新给username变量赋值\n        computed:{\n            username(){\n                return this.$store.state.username;\n            },\n            cartCount(){\n                return this.$store.state.cartCount;\n            }\n        },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h2",{attrs:{id:"四-vuex中使用mapactions、mapstate简化代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-vuex中使用mapactions、mapstate简化代码"}},[s._v("#")]),s._v(" 四：Vuex中使用"),e("code",[s._v("mapActions、mapState")]),s._v("简化代码")]),s._v(" "),e("h3",{attrs:{id:"一-解构mapactions中的方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-解构mapactions中的方法"}},[s._v("#")]),s._v(" "),e("code",[s._v("(一)：解构mapActions中的方法")])]),s._v(" "),e("ul",[e("li",[s._v("例如：可以将login.vue组件中的"),e("code",[s._v("this.$store.dispatch('saveUserName', res.username);")]),s._v("替换为"),e("code",[s._v("this.saveUserName(res.username);")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1: 在login.vue中导入mapActions对象\nimport { mapActions } from 'vuex'\n\n2：解构mapActions中的方法\n// 结构mapActions对象, 会结构出saveUserName方法\n...mapActions(['saveUserName']),\n\n3：调用方法\nthis.saveUserName(res.username);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"二-解构mapstate中的属性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-解构mapstate中的属性"}},[s._v("#")]),s._v(" "),e("code",[s._v("(二)：解构mapState中的属性")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1: 在NavHeader.vue组件中，导入mapState\nimport { mapState } from 'vuex'\n\n2：在computed计算属性中，解构username、cartCount\n// 计算属性目的是当this.$store.state.username值变化的时候，重新给username，cartCount变量赋值\ncomputed:{\n\t...mapState(['username', 'cartCount'])\n},\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);