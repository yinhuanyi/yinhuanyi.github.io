(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{1029:function(s,n,a){s.exports=a.p+"assets/img/fir.14e8fd72.png"},1030:function(s,n,a){s.exports=a.p+"assets/img/2018-08-194.20.20.c088b6ef.png"},1031:function(s,n,a){s.exports=a.p+"assets/img/2018-08-194.21.20.727dab66.png"},1032:function(s,n){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA7UAAACFCAYAAACEy98FAAASH0lEQVR4Xu3dfayW5X0H8N9RDhRBRO0x9kWboZRWnRNEhdVqtNm62VZLE1zSt4hNne4l2Ay1wBxWji+k1lkW1w01Nq0mtQ1trdoY94fYWu0aXxK004nFpmJSsWPjpXDgwXOWBzaVgr3v6zkP51yX94d/r+u+7+/9+V0mfjnPc+gZGhoaCn8IECBAgAABAgQIECBAgECBAj1KbYFTE5kAAQIECBAgQIAAAQIEdgkotQ4CAQIECBAgQIAAAQIECBQroNQWOzrBCRAgQIAAAQIECBAgQECpdQYIECBAgAABAgQIECBAoFgBpbbY0QlOgAABAgQIECBAgAABAkqtM0CAAAECBAgQIECAAAECxQootcWOTnACBAgQIECAAAECBAgQUGqdAQIECBAgQIAAAQIECBAoVkCpLXZ0ghMgQIAAAQIECBAgQICAUusMECBAgAABAgQIECBAgECxAkptsaMTnAABAgQIECBAgAABAgSUWmeAAAECBAgQIECAAAECBIoVUGqLHZ3gBAgQIECAAAECBAgQIKDUOgMECBAgQIAAAQIECBAgUKyAUlvs6AQnQIAAAQIECBAgQIAAAaXWGSBAgAABAgQIECBAgACBYgWU2mJHJzgBAgQIECBAgAABAgQIKLXOAAECBAgQIECAAAECBAgUK6DUFjs6wQkQIECAAAECBAgQIEBAqXUGCBAgQIAAAQIECBAgQKBYAaW22NEJToAAAQIECBAgQIAAAQJKrTNAgAABAgQIECBAgAABAsUKKLXFjk5wAgQIECBAgAABAgQIEFBqnQECBAgQIECAAAECBAgQKFZAqS12dIITIECAAAECBAgQIECAgFLrDBAgQIAAAQIECBAgQIBAsQJKbbGjE5wAAQIECBAgQIAAAQIElFpngAABAgQIECBAgAABAgSKFVBqix2d4AQIECBAgAABAgQIECCg1DoDBAgQIECAAAECBAgQIFCsgFJb7OgEJ0CAAAECBAgQIECAAAGl1hkgQIAAAQIECBAgQIAAgWIFlNpiRyc4AQIECBAgQIAAAQIECCi1zgABAgQIECBAgAABAgQIFCug1BY7OsEJECBAgAABAgQIECBAQKl1BggQIECAAAECBAgQIECgWAGlttjRCU6AAAECBAgQIECAAAECSq0zQIAAAQIECBAgQIAAAQLFCii1xY5OcAIECBAgQIAAAQIECBBQap0BAgQIECBAgAABAgQIEChWQKktdnSCEyBAgAABAgQIECBAgIBS6wwQIECAAAECBAgQIECAQLECSm2xoxOcAAECBAgQIECAAAECBJRaZ4AAAQKZC7zyyiujkrCvr6/Wc+XbN1PufrWG28BNdefWQBqvTIAAgWwFlNpsRyMYAQIEdgu0S+N11103ohwLFy6Muv9z385Xd2+3XiLlmSl7m5KvW+/5VrvPaJyVt5qh9yFAgMBoCCi1o6HumQQIEEgQUGr3xkopHyl7E8bye7emPDNlb7fyuc++BczCySBAgECZAkptmXOTmgCBBgkotUptg477qL6qUjuq/B5OgACBjgWU2o7pXEiAAIGREVBqldqROWmeotQ6AwQIEChTQKktc25SEyDQIAGlVqlt0HEf1VdVakeV38MJECDQsYBS2zGdCwkQIDAyAkqtUjsyJ81TlFpngAABAmUKKLVlzk1qAgQaJKDUKrUNOu6j+qpK7ajyezgBAgQ6FlBqO6ZzIQECBEZGQKlVakfmpHmKUusMECBAoEwBpbbMuUlNgECDBJRapbZBx31UX1WpHVV+DydAgEDHAkptx3QuJECAwMgIKLVK7cicNE9Rap0BAgQIlCmg1JY5N6kJEGiQwFu11G7bsilaO8fHpMm9ydNMKR8pe98YZFe+GB+TJuaZLxntTS54df3q+MEjv4je3tffs2dMbwztbO1xRavVivfO+kgcf+TYpEcPvPRw3L7yyegZ9/r9x/SOjzHRioHWztfu1doeMXvOhTHzqLT7J4Wp2NzpWelmBvciQIAAgXQBpTbdzBUECBAYUYFOS+3ZFyyOj57watx2+bL4+eBQUuaFCxdGX19frWtSi8ALq26JG1eufu3ek479k1g0/9yYUOtpuzelPDNlb/vev5tvTN+M+LvL58W731Y/YMozU/bWT1B/58BLq+LmO56InjHta3qjt3drrF2zLia+a2occVBPtP6v27ZL7ow5F8dZ7z2o/s0jol2a7/7RL2LCpN3Xtbvzfz54X7xw0Iz4s9OOjnZZbv/57aatMe309NKcFEap7SaXexEgQCAbAaU2m1EIQoAAgX0LpJbacVPnxpK/nB1vOyAidq6P276YV6l9cuVN8dPB6XHeh06IVx5fGbf+4KmYNW9pfGrG5NpHIKUIpuxtB3jirpviJwecFB+b/b7Ytu7hWHHnQ3HY7Iviyk/+YRb5aofoeOPOuGXxVXF2f38c09PxTfa6cM2/PxhrNw7tKs2Pfu+B2HD0B+Lck/tioNWKCX3HxenTj+rewzq8U+pZ6fAxLiNAgACBLgsotV0GdTsCBAh0WyC11A71nBTnfXxKHHr0jPijo7Zk95PaPX02xPL5V8VvTp4XV392em26lPKRsnfvAJvj5vmLY/1pn48vNabUDsTti6+IZw89JS6cd35MO7wbHwfeHCsWLI51R74/3nlwT7Q/fhyxLdqfcB54+T/i+d9Mj2XL5yX9tL72YUnYOLyzkvAgWwkQIECgqwJKbVc53YwAAQLdF0gttf+f4MS5l8UFsw+M2xbk9ZPaNwoNbng45i+5Kz74uaVx/kl5/KR2d77N8fi/PRSPPbEqnl739rjk6iviuEPr/9gypRyl7O3+6drXHQfi60uWxPpJvfHiLzfGkSedE389789jcvsn/xEx+NtN8d/b9/y+7ZvlmjD58N2fGIjNccviZXHG1f0x7cCIZ+++Ie4fnBOXzjkmWs/fFV9YvjW+snxejBuZF3zTp+Q3i1EG8XgCBAgUIqDUFjIoMQkQaK5Ap6V21tzL4vysS+2GXR9zXb35fbHkq38Vb6/fGffrd2rbJ21o+5q46Uv/Ems374iIqfGFa/82phxcP2BKOUrZOzL/FbxeQI/59epYfuOt8cKOMXHG3L+JuWdMiadWLo0Vq9bXitL+2Pbun3DvvufMLy6N6Qf3xM/uWBTf3z43rv3c9Ni0+o5YdGtLqa0lahMBAgQI7EtAqXUuCBAgkLnAW7PU7ox7/nFBPLB2bHzmqmVx6uH1C2N7XClFMGXv3kfh5fjnBdfEC8deEF++eEbtk5LyzJS9tQMMa+OeBbR9q8fuXhGPDc6Oi+fU/17xnhH2vOcTdy6Kla/OjWs+Oz02PXNHLPqaUjuskbmYAAECDRdQaht+ALw+AQL5C3RaavP9+PFA3PNPV8YDz/XGpxdfE6cdmVZoR7bURqzsnx8/HvxQ3PAP58auXxBc409KUU3ZW+PRXdiyd6kd/k3b303uj1P7r49TDt6y63vKR1z05Zh7/LjY+szX44qv7Yjrl1/kO7XDh3YHAgQINFJAqW3k2L00AQIlCaSX2nfGrNOnxFHHnxmzpx0QD933YLz04iPx2HODtV97f/6TPvevuCzue2ogTvjwhfGnJ0yIrVtb0dN7WBw39R2186UUwZS9EQPx7RuXR+/Mc+LME98R6578Ydzy3Z/FsR++NOZ/9JgM8tWOMIyN+6PURqz+8aNx9Adnx5qVS+Mbqw6Ks86cHL/aeEScNfOQ2LDt3XHWrCnDyNydS9POSnee6S4ECBAgMHwBpXb4hu5AgACB/SqQWmrHTf1k9F8yMw58Q6qXn/xOLPvmo7Vz7r9SOxB39l8RP335dwp274y4/sb6v/02pXyk7I3YGfevuDLue2rLa1a5/Tu6tYfY8cbul9qhHZtj7TOPxrduuzd+PTQxPnX538e07Y/Ht797bzz94taY+K6T4xN/MSdO+YNDOk7djQvTzko3nugeBAgQINANAaW2G4ruQYAAgf0okFpquxFl/5XabqQbge/UDrZi66ZtsXPM+Jg0sTc5dEo5StmbHKSjC9ofFb4qTu2/IU5J+OVYb/qowefjyku/Gv8zND5mnP3xmHPeH7/2m5Tb1wxuXBN3feNf45HnxsaCm66N97zxb2M6yt/5RfnNovN3cSUBAgSaJKDUNmna3pUAgSIFlNq9x5ZSPlL2duuApDwzZW+38lXdZ+OG/4oJhx1e+zvEVfcb2tGKnrG//y8HdmxpxdgO/gKh6tkp6znOIiW/vQQIEGiqgFLb1Ml7bwIEihFQapXaYg5r4UGV2sIHKD4BAo0VUGobO3ovToBAKQJKrVJbylktPadSW/oE5SdAoKkCSm1TJ++9CRAoRkCpVWqLOayFB1VqCx+g+AQINFZAqW3s6L04AQKlCCi1Sm0pZ7X0nEpt6ROUnwCBpgootU2dvPcmQKAYAaVWqS3msBYeVKktfIDiEyDQWAGltrGj9+IECJQioNQqtaWc1dJzKrWlT1B+AgSaKqDUNnXy3psAgWIE2v+jPRp/+vr6aj1Wvn0z5e5Xa7gN3FR3bg2k8coECBDIVkCpzXY0ghEgQIAAAQIECBAgQIBAlYBSWyVknQABAgQIECBAgAABAgSyFVBqsx2NYAQIECBAgAABAgQIECBQJaDUVglZJ0CAAAECBAgQIECAAIFsBZTabEcjGAECBAgQIECAAAECBAhUCSi1VULWCRAgQIAAAQIECBAgQCBbAaU229EIRoAAAQIECBAgQIAAAQJVAkptlZB1AgQIECBAgAABAgQIEMhWQKnNdjSCESBAgAABAgQIECBAgECVgFJbJWSdAAECBAgQIECAAAECBLIVUGqzHY1gBAgQIECAAAECBAgQIFAloNRWCVknQIAAAQIECBAgQIAAgWwFlNpsRyMYAQIECBAgQIAAAQIECFQJKLVVQtYJECBAgAABAgQIECBAIFsBpTbb0QhGgAABAgQIECBAgAABAlUCSm2VkHUCBAgQIECAAAECBAgQyFZAqc12NIIRIECAAAECBAgQIECAQJWAUlslZJ0AAQIECBAgQIAAAQIEshVQarMdjWAECBAgQIAAAQIECBAgUCWg1FYJWSdAgAABAgQIECBAgACBbAWU2mxHIxgBAgQIECBAgAABAgQIVAkotVVC1gkQIECAAAECBAgQIEAgWwGlNtvRCEaAAAECBAgQIECAAAECVQJKbZWQdQIECBAgQIAAAQIECBDIVkCpzXY0ghEgQIAAAQIECBAgQIBAlYBSWyVknQABAgQIECBAgAABAgSyFVBqsx2NYAQIECBAgAABAgQIECBQJaDUVglZJ0CAAAECBAgQIECAAIFsBZTabEcjGAECBAgQIECAAAECBAhUCSi1VULWCRAgQIAAAQIECBAgQCBbAaU229EIRoAAAQIECBAgQIAAAQJVAkptlZB1AgQIECBAgAABAgQIEMhWQKnNdjSCESBAgAABAgQIECBAgECVgFJbJWSdAAECBAgQIECAAAECBLIVUGqzHY1gBAgQIECAAAECBAgQIFAloNRWCVknQIAAAQIECBAgQIAAgWwFlNpsRyMYAQIECBAgQIAAAQIECFQJKLVVQtYJECBAgAABAgQIECBAIFsBpTbb0QhGgAABAgQIECBAgAABAlUCSm2VkHUCBAgQIECAAAECBAgQyFZAqc12NIIRIECAAAECBAgQIECAQJWAUlslZJ0AAQIECBAgQIAAAQIEshVQarMdjWAECBAgQIAAAQIECBAgUCWg1FYJWSdAgAABAgQIECBAgACBbAWU2mxHIxgBAgQIECBAgAABAgQIVAkotVVC1gkQIECAAAECBAgQIEAgWwGlNtvRCEaAAAECBAgQIECAAAECVQJKbZWQdQIECBAgQIAAAQIECBDIVkCpzXY0ghEgQIAAAQIECBAgQIBAlYBSWyVknQABAgQIECBAgAABAgSyFVBqsx2NYAQIECBAgAABAgQIECBQJaDUVglZJ0CAAAECBAgQIECAAIFsBZTabEcjGAECBAgQIECAAAECBAhUCSi1VULWCRAgQIAAAQIECBAgQCBbAaU229EIRoAAAQIECBAgQIAAAQJVAkptlZB1AgQIECBAgAABAgQIEMhWQKnNdjSCESBAgAABAgQIECBAgECVgFJbJWSdAAECBAgQIECAAAECBLIVUGqzHY1gBAgQIECAAAECBAgQIFAl8L84+5zMwKJ0rAAAAABJRU5ErkJggg=="},1033:function(s,n,a){s.exports=a.p+"assets/img/2018-08-151.53.27.b4b6526a.png"},1034:function(s,n,a){s.exports=a.p+"assets/img/2018-08-156.54.25.206f63e1.png"},1035:function(s,n,a){s.exports=a.p+"assets/img/2018-08-162.56.10.66b5678b.png"},2406:function(s,n,a){"use strict";a.r(n);var e=a(9),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"一-给注册用户发送激活邮件-让用户点击激活链接激活邮箱"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-给注册用户发送激活邮件-让用户点击激活链接激活邮箱"}},[s._v("#")]),s._v(" （一）"),e("strong",[e("code",[s._v("给注册用户发送激活邮件，让用户点击激活链接激活邮箱")])])]),s._v(" "),e("ul",[e("li",[s._v("在apps目录下，创建一个utils工具包，创建email_send.py 文件，给新注册的用户发送邮件，首先需要修改settings文件，设置发送邮件的接口")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 调用django自带的sendmail发送邮件\nEMAIL_HOST = "smtp.163.com"\nEMAIL_POST = 25\nEMAIL_HOST_USER = "yinhuanyi_cn@163.com"\nEMAIL_HOST_PASSWORD = "你懂的"\nEMAIL_USE_TLS = False\nEMAIL_FROM = "yinhuanyi_cn@163.com"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("编辑email_send.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('#!usr/bin/env python  \n#-*- coding:utf-8 _*-  \n""" \n    1：用户注册\n    2：用户找回密码\n    3：用户修改邮箱\n在发送邮箱验证码之前，需要先将随机字符串和用户的邮箱保存到数据库，之后再根据不同的需求发送邮件，\n用户在接收到邮件之后，\n    如果是注册、重置密码，那么需要点击邮箱中的链接，这个链接中有之前生成的随机字符串，且保存在数据库中，用户点击这个链接，会发起一个get请求，服务器端接收这个get请求之后，获取链接中的随机字符串，与数据库中的随机字符串比对，如果数据库中有，那么通过用户的邮箱拿到Userprofile的记录，最后修改Userprofile记录的字段\n\n    如果是修改邮箱，那么需要复制这个随机字符串，粘贴到对应的input框中，当用户点击提交，那么后台的处理逻辑和上面类似\n\n"""\nimport random\n\n# 导入邮箱验证码model\nfrom users.models import EmailVerifyRecord   # 验证码model\nfrom django.core.mail import send_mail       # 导入Django自带邮箱发送函数\nfrom MxOnline.settings import EMAIL_FROM     # 这里的EMAIL_FROM就是163邮箱地址\n\n# 像这种以后直接打包上传到pypi服务器\ndef generate_ramdom_str(random_length=8):\n    \'\'\'\n    生成随机字符串\n    :param random_length: 表示随机字符串的长度\n    :return: 返回一个随机字符串\n    \'\'\'\n    string = ""\n    chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"\n    length = len(chars) - 1  # 因为字符串后面需在这个chars字符串中取字符，因此需要减去1\n    for _ in range(random_length):  # 默认循环8次\n        string += chars[random.randint(0, length)]\n\n    return string\n\n\ndef send_register_email(email, send_type="register"):\n    \'\'\'\n    将发送给用户的邮件信息保存到数据库中，方便密码找回\n    :param email: 发送邮件的目标地址\n    :param send_type: 发送邮件的类型\n    :return: None,\n    \'\'\'\n    # 发送邮件之前保存到数据库\n    email_record = EmailVerifyRecord() # 实例化这个邮箱认证的model， 将发送认证邮件的信息保存到数据库\n    code = generate_ramdom_str(4) if send_type == "update_email" else generate_ramdom_str(16) # 生成一个16位的字符串\n    email_record.code = code # 发送的随机验证码\n    email_record.email = email # 发送的邮箱地址\n    email_record.send_type = send_type # 发送的类型有两种，一种是注册，一种是找回密码\n    email_record.save() # 保存到数据库\n\n    # 发送邮件的内容\n    email_title = ""\n    email_body = ""\n\n    # 发送邮件的类型是注册类型， 由于用户注册发送邮件\n    if send_type == "register":\n        email_title = "尹欢一教育在线网注册链接"\n        # 这个处理连接激活的逻辑需要写在urls.py中\n        email_body = "请点击下边的连接，激活您的账号: http://127.0.0.1:8000/active/{}".format(code) # 测试\n        # email_body = "请点击下边的连接，激活您的账号: http://edu.yhyblog.cn:8000/active/{}".format(code) # 部署\n        # 调用Django的邮件函数发送邮件， 需要在setting中配置发送邮件的人\n        send_status = send_mail(email_title, email_body, EMAIL_FROM, [email])\n        if send_status: # 如果邮件发送成功\n            return\n\n    elif send_type == \'forget\':\n        email_title = "尹欢一教育在线网密码重置链接"\n        email_body = "请点击下边的连接，重置您的密码: http://127.0.0.1:8000/reset/{}".format(code)\n        send_status = send_mail(email_title, email_body, EMAIL_FROM, [email])\n        if send_status: # 如果邮件发送成功\n            return\n\n\n    elif send_type == "update_email":\n        email_title = "尹欢一教育在线网 修改邮箱验证码"\n        email_body = "您的邮箱验证码是：{}".format(code)\n        send_status = send_mail(email_title, email_body, EMAIL_FROM, [email])\n        if send_status:  # 如果邮件发送成功\n            return\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br")])]),e("h3",{attrs:{id:"二-django日志打印详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-django日志打印详解"}},[s._v("#")]),s._v(" （二）"),e("strong",[e("code",[s._v("Django日志打印详解")])])]),s._v(" "),e("ul",[e("li",[s._v("Django的日志级别以及处理在settings文件中定义")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("LOGGING "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'version'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'disable_existing_loggers'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" True,\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'formatters'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志的打印格式")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'standard'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'format'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%(asctime)s %(name)s %(lineno)d %(levelname)s %(message)s'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filters'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'handlers'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志处理过程：handlers")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug_level'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'level'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DEBUG'")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'class'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'logging.handlers.RotatingFileHandler'")]),s._v(",  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用轮询日志")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filename'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s/logs/debug.log'")]),s._v(" % BASE_DIR,  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志输出文件")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'maxBytes'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(",  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件大小")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backupCount'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(",  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份份数")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'formatter'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'standard'")]),s._v(",  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用哪种formatters日志格式")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error_level'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'level'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ERROR'")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'class'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'logging.handlers.RotatingFileHandler'")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'filename'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s/logs/error.log'")]),s._v(" % BASE_DIR,\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'maxBytes'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" * "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backupCount'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'formatter'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'standard'")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'loggers'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定logger")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django_debug_error'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'handlers'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error_level'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug_level'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'level'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DEBUG'")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'propagate'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" True,\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br")])]),e("ul",[e("li",[s._v("在任何Python代码的地方都可以打印日志,  例如使用Django orm查询数据库的时候，如果没有数据返回，一般是抛异常的，因此这里查询数据库最好使用try exaption语句，然后将异常打印出来")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import logging\nlogger = logging.getLogger('django_debug_error')\n\n\n# 例如在views.py文件里面, 打印日志\nif send_status:\n\tlogger.debug(send_status)\nelse:\n\tlogger.error(send_status)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ul",[e("li",[s._v("在logs/debug.log日志中显示的日志为")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("2018-08-10 13:51:57,909 django_debug_error 42  [DEBUG]  1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"三-实现用户点击邮箱激活链接之后-激活用户功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-实现用户点击邮箱激活链接之后-激活用户功能"}},[s._v("#")]),s._v(" （三）"),e("strong",[e("code",[s._v("实现用户点击邮箱激活链接之后，激活用户功能")])])]),s._v(" "),e("ul",[e("li",[s._v("修改urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 这是使用了正则表达式提取URL, 方便在数据库中匹配对应的code， 这里的active_code名称需要与ActiveUserView中的get方法中的active_code名称一样\nurl(r'^active/(?P<active_code>.*)/$', ActiveUserView.as_view(), name=\"user_active\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 处理邮箱验证连接请求\nclass ActiveUserView(View):\n    def get(self, request, active_code): # 这里的active_code传递进来的就是URL中的正则表达式匹配到的code\n        all_code_set = EmailVerifyRecord.objects.filter(code=active_code) # 这里不用get过滤的原因是可能在EmailVerifyRecord表中生成的随机字符串重复\n        if all_code_set: # 如果这个验证码的随机随机字符串在后台有\n            for record in all_code_set: # 取出每一条记录， 一般是一条\n                email = record.email # 拿到邮箱地址\n                user = UserProfile.objects.get(email=email) # 通过邮箱在UserProfile表中找到对应的用户注册记录， 可能一个邮箱会有多条记录，因此需要\n                user.is_active = True # 最后将这条记录的is_active激活属性改为true\n                user.save()\n            # return render(request, 'login.html')\n            return HttpResponseRedirect(reverse(\"login\"))\n        else:  # 如果这个验证码在后台没有\n            return render(request, 'active_fail.html')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h3",{attrs:{id:"四-实现用户找回密码的功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-实现用户找回密码的功能"}},[s._v("#")]),s._v(" （四）"),e("strong",[e("code",[s._v("实现用户找回密码的功能")])])]),s._v(" "),e("ul",[e("li",[s._v("修改urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from users.views import LoginView, RegisterView, ActiveUserView, ForgetPwdView\n\nurl(r'^forget/', ForgetPwdView.as_view(), name=\"forget_pwd\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("编辑forms文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('class ForgetForm(forms.Form):\n    email = forms.EmailField(required=True, )\n    captcha = CaptchaField(error_messages={"invalid": u"验证码错误, 请重新输入"})\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("修改views.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 处理忘记密码的逻辑\nclass ForgetPwdView(View):\n    def get(self, request):\n        forget_form = ForgetForm()   # 这是实例化ForgetForm的目的在于在HTML页面中自动生成验证码图片\n        return render(request, "forgetpwd.html", {"forget_form": forget_form}) # 将实例传递到HTML页面中\n\n    def post(self, request):\n        forget_form = ForgetForm(request.POST)  # 对用户填写的信息进行验证\n        if forget_form.is_valid(): # 如果验证通过，查询数据库\n            email = request.POST.get("email", "")\n\n            # 拿到了用户的邮箱，生成随机字符串, 给用户的邮箱发送邮件\n            send_register_email(email, \'forget\')\n            return render(request, \'send_success.html\')\n\n        else: # 如果验证没有通过，依然返回找回密码页面, 且返回forget_form提示错误的原因\n            return render(request, \'forgetpwd.html\', {"forget_form": forget_form})\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("ul",[e("li",[s._v("将"),e("code",[s._v("forgetpwd.html")]),s._v("拷贝到templates目录中")]),s._v(" "),e("li",[s._v("在编辑urls.py文件， 创建用户点击重置密码的连接邮件时候的逻辑")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^reset/(?P<active_code>.*)/$', ResetView.as_view(), name=\"reset_pwd\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 处理邮箱中找回密码的请求\nclass ResetView(View):\n    def get(self, request, active_code): # 这里的active_code传递进来的就是URL中的正则表达式匹配到的code\n        all_code_set = EmailVerifyRecord.objects.filter(code=active_code) # 这里不用get过滤的原因是可能在EmailVerifyRecord表中生成的随机字符串重复\n        if all_code_set: # 如果这个验证码的随机随机字符串在数据库里面有，这里的all_code_set是一个可迭代对象，需要使用for循环取值\n            for record in all_code_set: # 取出每一条记录， 一般只有一条\n                email = record.email # 拿到邮箱地址\n                user = UserProfile.objects.get(email=email) # 通过邮箱在UserProfile表中找到对应的用户注册记录，可能一个邮箱会有多条记录，因此需要\n                return render(request, "password_reset.html", {"email": email})\n\n        else:  # 如果这个验证码在数据库没有, 返回链接失效\n            return render(request, \'active_fail.html\')\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("ul",[e("li",[s._v("这个password_reset.html文件要注意了，这里有三个input标签，中间的那个是隐藏的，value值由ResetView中传递来的，目的是：当用户点击提交的使用，会将两个密码的值和email的值 传递到 modify_pwd对应的ModifyPwdView")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<form id="reset_password_form" action="{% url \'modify_pwd\' %}" method="post">\n    <ul>\n        <li>\n            <span class="">新 密 码 ：</span>\n            <input type="password" name="password1" iplaceholder="6-20位非中文字符">\n            <i></i>\n        </li>\n        <input type="hidden"  name="email" value="{{ email }}">\n        <li>\n            <span class="">确定密码：</span>\n            <input type="password" name="password2" id=placeholder="6-20位非中文字符">\n            <i></i>\n        </li>\n        <li class="button">\n            <input type="submit" value="提交">\n        </li>\n    </ul>\n    {% csrf_token %}\n</form>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("ul",[e("li",[s._v("编辑urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^modify_pwd/', ModifyPwdView.as_view(), name=\"modify_pwd\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('class ModifyPwdView(View):\n    def post(self, request): # 修改密码的post处理\n        modify_pwd_form = ModifyPwdForm(request.POST)\n        if modify_pwd_form.is_valid():\n            pwd1 = request.POST.get(\'password1\', "")\n            pwd2 = request.POST.get(\'password2\', "")\n            email = request.POST.get(\'email\', "")\n            if pwd1 != pwd2:\n                return render(request, \'password_reset.html\', {"email": email, "msg": "请确保两次输入的密码相同"})\n            user = UserProfile.objects.get(email=email) # get方法取出的直接是记录对象，不是一个可迭代的对象\n            user.password = make_password(pwd1) # 修改密码\n            user.save()\n            # todo: 这里还可以判断，此链接是否已经被点击过。可以在EmailVerifyRecord表中添加一个字段is_alive，然后根据获取email或code从表中过滤出这条记录，然后把is_alive设置为True， 每次进来先查询这个is_alive字段，如果为true，直接返回一个链接失效的HTML\n            return render(request, \'login.html\') #  返回登入页面，让用户登入\n\n        else: # 如果用户填写的密码不合法\n            email = request.POST.get(\'email\', "")\n            return render(request, \'password_reset.html\', {"email": email, "msg": modify_pwd_form})\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h3",{attrs:{id:"五-django的模板继承"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-django的模板继承"}},[s._v("#")]),s._v(" （五）"),e("strong",[e("code",[s._v("Django的模板继承")])])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("因为从网站的布局来看，可以发现，所有的页面都有一个头部和尾部\n"),e("img",{attrs:{src:a(1029),alt:"Alt text"}})])]),s._v(" "),e("li",[e("p",[s._v("创建一个base.html页面，这个base.html页面就作为所有的模板的基模板，其他的页面都可以继承于这个页面， 页面中的"),e("code",[s._v("{% block title %} {% endblock %}")]),s._v("部分都是可以重载的")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<!DOCTYPE html>\n\x3c!-- base页面被所有的公开课，授课教师，授课机构所继承 --\x3e\n<html>\n{% load staticfiles %}\n<head>\n    <meta charset="UTF-8">\n    <meta name="renderer" content="webkit">\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">\n    \x3c!-- 重载 --### \n    <title>{% block title %}课程机构列表-尹欢一在线网{% endblock %}</title>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/reset.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/animate.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/style.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'js/plugins/queryCity/css/cityLayout.css\' %}">\n    \x3c!-- 重载 --\x3e\n    {% block custom_css %}  {% endblock %}\n    <script src="{% static \'js/jquery.min.js\' %}" type="text/javascript"><\/script>\n    <script src="{% static \'js/jquery.min.js\' %}" type="text/javascript"><\/script>\n</head>\n<body>\n\n\x3c!-- 全局头部 --\x3e\n<section class="headerwrap ">\n    <header>\n        <div class=" header">\n\n            {% if request.user.is_authenticated %}\n                <div class="top">\n                    <div class="wp">\n                        <div class="fl"><p>服务电话：<b>18670236750</b></p></div>\n                        <div class="personal">\n                            <dl class="user fr">\n                                <dd>{{ request.user.username }}\n                                    <img class="down fr" src={% static "images/top_down.png" %}/>\n                                </dd>\n                                <dt>\n                                    <img width="20" height="20" src="{{ MEDIA_URL }}{{ request.user.image }}"/>\n                                </dt>\n                            </dl>\n                            <div class="userdetail">\n                                <dl>\n                                    <dt><img width="80" height="80" src="{{ MEDIA_URL }}{{ request.user.image }}"/></dt>\n                                    <dd>\n                                        <h2>{% if request.user.is_superuser %}管理员{% else %}{% endif %}</h2>\n                                        <p>{{ request.user.username }}</p>\n                                    </dd>\n                                </dl>\n                                <div class="btn">\n                                    <a class="personcenter fl" href="{% url \'users:user_info\' %}">进入个人中心</a>\n                                    <a class="fr" href="{% url \'logout\' %}">退出</a>\n                                </div>\n                            </div>\n                        </div>\n                        <a href="{% url \'users:mymsg\' %}">\n                            <div class="msg-num">{{ request.user.get_unread_nums }}</div>\n                        </a>\n                    </div>\n                </div>\n            {% else %}\n                <div style="color: #FFFFFF;">没有登录</div>\n                <div class="top">\n                    <div class="wp">\n                        <div class="fl">\n                            <p>联系方式：<b>3333333333</b></p>\n                        </div>\n                        \x3c!-- 这里使用路由的name关键字 {% url "register" %} --\x3e\n                        <a style="color:white" class="fr registerbtn" href={% url "register" %}>注册</a>\n                        <a style="color:white" class="fr loginbtn" href={% url "login" %}>登录</a>\n                    </div>\n                </div>\n            {% endif %}\n\n            <div class="middle">\n                <div class="wp">\n                    <a href="/"><img class="fl" src="{% static \'images/logo.jpg\' %}"/></a>\n                    <div class="searchbox fr">\n                        <div class="selectContainer fl">\n                            <span class="selectOption" id="jsSelectOption" data-value="course">\n                                公开课\n                            </span>\n                            <ul class="selectMenu" id="jsSelectMenu">\n                                <li data-value="course">公开课</li>\n                                <li data-value="teacher">授课老师</li>\n                                <li data-value="org">授课机构</li>\n                            </ul>\n                        </div>\n\n                        <input id="search_keywords" class="fl" type="text" value="" placeholder="请输入搜索内容"/>\n                        <img class="search_btn fr" id="jsSearchBtn" src="{% static \'images/search_btn.png\' %}"/>\n                    </div>\n                </div>\n            </div>\n\n\n            <nav>\n                <div class="nav">\n                    <div class="wp">\n                        <ul>\n                            <li {% if request.path == \'/\' %} class="active" {% endif %}>\n                                <a href="{% url \'index\' %}">首页</a>\n                            </li>\n\n                            <li {% if request.path|slice:\'7\' == \'/course\' %} class="active" {% endif %}>\n                                <a href="{% url \'courses:course_list\' %}">公开课</a>\n                            </li>\n\n                            <li {% if request.path|slice:\'12\' == \'/org/teacher\' %} class="active" {% endif %}>\n                                <a href="{% url \'org:teacher_list\' %}">授课教师</a>\n                            </li>\n\n                            <li {% if request.path|slice:\'9\' == \'/org/list\' %} class="active" {% endif %}>\n                                <a href="{% url \'org:org_list\' %}">授课机构</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </nav>\n\n        </div>\n    </header>\n</section>\n\n\x3c!-- 重载面包屑 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <ul class="crumbs">\n                <li><a href="/">首页</a>></li>\n\n            </ul>\n        </div>\n    </section>\n{% endblock %}\n\n\x3c!-- 重载内容 --\x3e\n{% block content %}\n    \n{% endblock %}\n\n\n<footer>\n    <div class="footer">\n        <div class="wp">\n            <ul class="cont">\n                <li class="logo"><a href="{% url \'index\' %}"><img src="{% static \'images/footlogo.png\' %}"/></a></li>\n                <li class="code"><img src="{% static \'images/code.png\' %}"/>\n                    <p class="center">扫描关注我的微信</p></li>\n                <li class="third"><img class="fl" src="{% static \'images/tell.png\' %}"/>\n                    <p class="tell">18670236750</p>\n                    <p class="time">时刻为您保持畅通</p></li>\n            </ul>\n\n        </div>\n        <p class="line"></p>\n        <div class="wp clear">\n            <span class="fl">上课备课项目</span>\n            <span class="fr">尚观IT培训</span>\n        </div>\n    </div>\n</footer>\n\n\n<section>\n    <ul class="sidebar">\n        <li class="qq">\n            <a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=2023525077&site=qq&menu=yes"></a>\n        </li>\n        <li class="totop"></li>\n    </ul>\n</section>\n\n</div>\n<script src="{% static \'js/selectUi.js\' %}" type=\'text/javascript\'><\/script>\n<script type="text/javascript" src="{% static \'js/plugins/laydate/laydate.js\' %}"><\/script>\n<script src="{% static \'js/plugins/layer/layer.js\' %}"><\/script>\n<script src="{% static \'js/plugins/queryCity/js/public.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/unslider.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/plugins/jquery.scrollLoading.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/validateDialog.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/deco-common.js\' %}" type="text/javascript"><\/script>\n<script>\n    $(function () {\n        $(\'#jsStayBtn\').on(\'click\', function () {\n            let _this = $(this);\n            verify = verifyDialogSubmit(\n                [\n                    {id: \'#companyName\', tips: Dml.Msg.epComName, errorTips: \'\', require: true},\n                    {\n                        id: \'#companyMobile\',\n                        tips: Dml.Msg.epPhone,\n                        errorTips: Dml.Msg.erPhone,\n                        regName: \'phone\',\n                        require: true\n                    },\n                    {id: \'#companyAddress\', tips: Dml.Msg.epComAddress, require: true}\n                ]\n            );\n            if (!verify) {\n                return;\n            }\n            $.ajax({\n                cache: false,\n                type: "POST",\n                url: "/company/company_apply/",\n                data: $(\'#jsStayForm\').serialize(),\n                async: true,\n                beforeSend: function (xhr, settings) {\n                    _this.val("提交中...")\n                    _this.attr("disabled", "disabled");\n                    xhr.setRequestHeader("X-CSRFToken", "mymQDzHWl2REXIfPMg2mJaLqDfaS1sD5");\n                },\n                success: function (data) {\n                    if (data.status == \'success\') {\n                        $(\'#jsStayForm\')[0].reset();\n                        Dml.fun.showTipsDialog({\n                            title: \'提交成功\',\n                            h2: \'您的入住申请提交成功!\',\n                        });\n                        Dml.fun.winReload();\n                    } else if (data.status == \'failure\') {\n                        $(\'#jsCompanyTips\').html(data.error_msg).show();\n                    }\n                },\n                complete: function (XMLHttpRequest) {\n                    _this.val("立即申请 >");\n                    _this.removeAttr("disabled");\n                }\n            });\n        });\n    })\n<\/script>\n\x3c!-- 重载 --\x3e\n{% block custom_js %}  {% endblock %}\n</body>\n</html>\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br"),e("span",{staticClass:"line-number"},[s._v("163")]),e("br"),e("span",{staticClass:"line-number"},[s._v("164")]),e("br"),e("span",{staticClass:"line-number"},[s._v("165")]),e("br"),e("span",{staticClass:"line-number"},[s._v("166")]),e("br"),e("span",{staticClass:"line-number"},[s._v("167")]),e("br"),e("span",{staticClass:"line-number"},[s._v("168")]),e("br"),e("span",{staticClass:"line-number"},[s._v("169")]),e("br"),e("span",{staticClass:"line-number"},[s._v("170")]),e("br"),e("span",{staticClass:"line-number"},[s._v("171")]),e("br"),e("span",{staticClass:"line-number"},[s._v("172")]),e("br"),e("span",{staticClass:"line-number"},[s._v("173")]),e("br"),e("span",{staticClass:"line-number"},[s._v("174")]),e("br"),e("span",{staticClass:"line-number"},[s._v("175")]),e("br"),e("span",{staticClass:"line-number"},[s._v("176")]),e("br"),e("span",{staticClass:"line-number"},[s._v("177")]),e("br"),e("span",{staticClass:"line-number"},[s._v("178")]),e("br"),e("span",{staticClass:"line-number"},[s._v("179")]),e("br"),e("span",{staticClass:"line-number"},[s._v("180")]),e("br"),e("span",{staticClass:"line-number"},[s._v("181")]),e("br"),e("span",{staticClass:"line-number"},[s._v("182")]),e("br"),e("span",{staticClass:"line-number"},[s._v("183")]),e("br"),e("span",{staticClass:"line-number"},[s._v("184")]),e("br"),e("span",{staticClass:"line-number"},[s._v("185")]),e("br"),e("span",{staticClass:"line-number"},[s._v("186")]),e("br"),e("span",{staticClass:"line-number"},[s._v("187")]),e("br"),e("span",{staticClass:"line-number"},[s._v("188")]),e("br"),e("span",{staticClass:"line-number"},[s._v("189")]),e("br"),e("span",{staticClass:"line-number"},[s._v("190")]),e("br"),e("span",{staticClass:"line-number"},[s._v("191")]),e("br"),e("span",{staticClass:"line-number"},[s._v("192")]),e("br"),e("span",{staticClass:"line-number"},[s._v("193")]),e("br"),e("span",{staticClass:"line-number"},[s._v("194")]),e("br"),e("span",{staticClass:"line-number"},[s._v("195")]),e("br"),e("span",{staticClass:"line-number"},[s._v("196")]),e("br"),e("span",{staticClass:"line-number"},[s._v("197")]),e("br"),e("span",{staticClass:"line-number"},[s._v("198")]),e("br"),e("span",{staticClass:"line-number"},[s._v("199")]),e("br"),e("span",{staticClass:"line-number"},[s._v("200")]),e("br"),e("span",{staticClass:"line-number"},[s._v("201")]),e("br"),e("span",{staticClass:"line-number"},[s._v("202")]),e("br"),e("span",{staticClass:"line-number"},[s._v("203")]),e("br"),e("span",{staticClass:"line-number"},[s._v("204")]),e("br"),e("span",{staticClass:"line-number"},[s._v("205")]),e("br"),e("span",{staticClass:"line-number"},[s._v("206")]),e("br"),e("span",{staticClass:"line-number"},[s._v("207")]),e("br"),e("span",{staticClass:"line-number"},[s._v("208")]),e("br"),e("span",{staticClass:"line-number"},[s._v("209")]),e("br"),e("span",{staticClass:"line-number"},[s._v("210")]),e("br"),e("span",{staticClass:"line-number"},[s._v("211")]),e("br"),e("span",{staticClass:"line-number"},[s._v("212")]),e("br"),e("span",{staticClass:"line-number"},[s._v("213")]),e("br"),e("span",{staticClass:"line-number"},[s._v("214")]),e("br"),e("span",{staticClass:"line-number"},[s._v("215")]),e("br"),e("span",{staticClass:"line-number"},[s._v("216")]),e("br"),e("span",{staticClass:"line-number"},[s._v("217")]),e("br"),e("span",{staticClass:"line-number"},[s._v("218")]),e("br"),e("span",{staticClass:"line-number"},[s._v("219")]),e("br"),e("span",{staticClass:"line-number"},[s._v("220")]),e("br"),e("span",{staticClass:"line-number"},[s._v("221")]),e("br"),e("span",{staticClass:"line-number"},[s._v("222")]),e("br"),e("span",{staticClass:"line-number"},[s._v("223")]),e("br"),e("span",{staticClass:"line-number"},[s._v("224")]),e("br"),e("span",{staticClass:"line-number"},[s._v("225")]),e("br"),e("span",{staticClass:"line-number"},[s._v("226")]),e("br"),e("span",{staticClass:"line-number"},[s._v("227")]),e("br"),e("span",{staticClass:"line-number"},[s._v("228")]),e("br"),e("span",{staticClass:"line-number"},[s._v("229")]),e("br"),e("span",{staticClass:"line-number"},[s._v("230")]),e("br"),e("span",{staticClass:"line-number"},[s._v("231")]),e("br"),e("span",{staticClass:"line-number"},[s._v("232")]),e("br"),e("span",{staticClass:"line-number"},[s._v("233")]),e("br"),e("span",{staticClass:"line-number"},[s._v("234")]),e("br"),e("span",{staticClass:"line-number"},[s._v("235")]),e("br"),e("span",{staticClass:"line-number"},[s._v("236")]),e("br")])]),e("ul",[e("li",[s._v("那么机构页面就可以这样引入base.html页面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\x3c!-- 继承base.html模板 --\x3e\n{% extends "base.html" %}\n{% load staticfiles %}\n{% block title %} 公开课 {% endblock %}\n\n\x3c!-- 面包屑部分 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <ul class="crumbs">\n                <li><a href="/">首页</a>></li>\n                <li>公开课</li>\n            </ul>\n        </div>\n    </section>\n{% endblock %}\n\n{% block content %}\n    <section>\n        <div class="wp">\n            <div class="list" style="margin-top:0;">\n                \x3c!-- 左边是公开课列表 --\x3e\n                <div class="left layout">\n                    \x3c!-- 头部 --\x3e\n                    <div class="head">\n                        <ul class="tab_header">\n                            <li {% if sort == "new" %}  class="active" {% endif %}><a href="?sort=new">最新 </a></li>\n                            <li {% if sort == "hot" %}  class="active" {% endif %}><a href="?sort=hot">最热门</a></li>\n                            <li {% if sort == "students" %}  class="active" {% endif %}><a\n                                    href="?sort=students">参与人数</a></li>\n                        </ul>\n                    </div>\n\n                    \x3c!-- 课程列表 --\x3e\n                    <div id="inWindow">\n                        <div class="tab_cont " id="content">\n                            <div class="group_list">\n                                {% for course in all_courses.object_list %}\n                                    <div class="box">\n                                        <a href="{% url \'courses:course_detail\' course.id %}">\n                                            <img width="280" height="350" class="scrollLoading"\n                                                 data-url="{{ MEDIA_URL }}{{ course.image }}"\n                                                 src="{% static \'images/pixel.gif\' %}"/>\n                                        </a>\n                                        <div class="des">\n                                            <a href="{% url \'courses:course_detail\' course.id %}">\n                                                <h2>{{ course.name }}</h2>\n                                            </a>\n                                            <span class="fl">时长：<i class="key">{{ course.learn_times }}</i></span>\n                                            <span class="fr">学习人数：{{ course.students }}&nbsp;&nbsp;</span>\n                                        </div>\n                                        <div class="bottom">\n                                            <a href="org-detail-homepage.html"><span\n                                                    class="fl">{{ course.course_org }}</span></a>\n                                            <span class="star fr  notlogin\n                                        " data-favid="15">\n                                        {{ course.fav_num }}\n                                    </span>\n                                        </div>\n                                    </div>\n                                {% endfor %}\n                            </div>\n\n                            \x3c!-- 底部分页需要看看官方文档： https://pypi.python.org/pypi/django-pure-pagination --\x3e\n                            <div class="pageturn">\n\n                                \x3c!-- 显示前一页 --\x3e\n                                {% if all_courses.has_previous %}\n\n                                    <li class="long" style="list-style: none">\n                                        <a href="?{{ all_courses.previous_page_number.querystring }}">上一页</a>\n                                    </li>\n                                {% endif %}\n\n                                \x3c!-- 显示中间的页面 --\x3e\n                                {% for page in all_courses.pages %}\n                                    {% if page %}\n                                        {% ifequal page all_courses.number %}\n                                            <li class="active" style="list-style: none">\n                                                <a>{{ page }}</a>\n                                            </li>\n                                        {% else %}\n                                            <li class="page" style="list-style: none">\n                                                <a href="?{{ page.querystring }}">{{ page }}</a>\n                                            </li>\n                                        {% endifequal %}\n                                    {% else %}\n                                        <li class="none" style="list-style: none">\n                                            <a href="">...</a>\n                                        </li>\n                                    {% endif %}\n                                {% endfor %}\n\n                                \x3c!-- 显示末尾页面 --\x3e\n                                {% if all_courses.has_next %}\n                                    <li class="long" style="list-style: none">\n                                        <a href="?{{ all_courses.next_page_number.querystring }}">下一页</a>\n                                    </li>\n\n                                {% endif %}\n\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- 右边是热门课程推荐列表 --\x3e\n                <div class="right layout">\n                    <div class="head">热门课程推荐</div>\n\n                    <div class="group_recommend">\n\n                        \x3c!-- 开始遍历热门课程 --\x3e\n                        {% for course in hot_courses %}\n                            <dl>\n                                <dt>\n                                    <a target="_blank" href="{{ ecmall_ad.url }}">\n                                        <img width="240" height="220" class="scrollLoading"\n                                             data-url="{{ MEDIA_URL }}{{ course.image }}"\n                                             src="{{ MEDIA_URL }}{{ course.image }}"/>\n                                    </a>\n                                </dt>\n                                <dd>\n                                    <a target="_blank" href="{{ ecmall_ad.url }}"><h2>{{ course.name }}</h2></a>\n                                    \x3c!-- 注意这里的get_degree_display可以显示choice字段的显示名称，而不是数据库中取出的数据名称 --\x3e\n                                    <span class="fl">课程难度：<i class="key">{{ course.get_degree_display }}</i></span>\n                                </dd>\n                            </dl>\n                        {% endfor %}\n\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </section>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br")])]),e("h3",{attrs:{id:"六-django的media路径的配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六-django的media路径的配置"}},[s._v("#")]),s._v(" （六）"),e("strong",[e("code",[s._v("Django的MEDIA路径的配置")])])]),s._v(" "),e("ul",[e("li",[s._v("由于在后台可以上传一些图片，那么这些图片保存到哪里呢？编辑settings文件，添加如下配置， 那么用户上传的所有的东西就会保存到这个/media/目录下，")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("MEDIA_URL = '/media/'\nMEDIA_ROOT = os.path.join(BASE_DIR, 'media')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("因为图片上传的字段在model中是这样写的, 因此，图片上传，会上传到/media/banner/%Y/%m/目录下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("image = models.ImageField(max_length=100, upload_to='banner/%Y/%m', verbose_name='轮播图')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("那么在前端的html页面中，我们就可以使用用户上传的图片或其他的可以在html页面显示的东西, 因为数据库中保存了图片上传的路径，"),e("code",[s._v("MEDIA_URL")]),s._v("相当于 "),e("code",[s._v("/media/")]),s._v("， "),e("code",[s._v("request.user.image")]),s._v(" 相当于 "),e("code",[s._v("user/1.png")]),s._v("，那么 "),e("code",[s._v("MEDIA_URL request.user.image")]),s._v(" 相当于 "),e("code",[s._v("/media/user/1.png")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<img width="20" height="20" src="{{ MEDIA_URL }}{{ request.user.image }}"/>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("因此，就必须写个路由处理逻辑,")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# todo:处理图片的请求， 指定在MEDIA_ROOT下面找\nfrom django.views.static import serve\n\nurl(r'^media/(?P<path>.*)', serve, {'document_root': MEDIA_ROOT})\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"七-将之前的settings的urls-py的一级路由改为一级和二级路由"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#七-将之前的settings的urls-py的一级路由改为一级和二级路由"}},[s._v("#")]),s._v(" （七）"),e("strong",[e("code",[s._v("将之前的settings的urls.py的一级路由改为一级和二级路由")])])]),s._v(" "),e("ul",[e("li",[s._v("因为每一个app里面都可以设置一个二级路由，这样使得Future_edu目录下的urls.py文件，不会显得非常臃肿，因此可以在每一个app底下创建一个urls.py文件")]),s._v(" "),e("li",[s._v("试着将之前的urls.py文件中，除了xadmin、根路径、captcha、media的路由保留，其他的全部写入users的urls.py文件里面")]),s._v(" "),e("li",[e("strong",[s._v("修改之前是这样的")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("urlpatterns = [\n    url(r'^xadmin/', xadmin.site.urls),\n    url(r'^$', TemplateView.as_view(template_name='index.html'), name='index'),\n    url(r'login/$', LoginView.as_view(), name='login'),\n    url(r'register/', RegisterView.as_view(), name='register'),\n    url(r'^captcha/', include('captcha.urls')),\n    url(r'^active/(?P<active_code>.*)/$', ActiveUserView.as_view(), name=\"user_active\"),\n    url(r'^forget/', ForgetPwdView.as_view(), name=\"forget_pwd\"),\n    url(r'^reset/(?P<active_code>.*)/$', ResetView.as_view(), name=\"reset_pwd\"),\n    url(r'^modify_pwd/', ModifyPwdView.as_view(), name=\"modify_pwd\"),\n    url(r'^media/(?P<path>.*)', serve, {'document_root': MEDIA_ROOT}),\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("ul",[e("li",[e("strong",[s._v("修改之后是这样的")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("urlpatterns = [\n    url(r'^xadmin/', xadmin.site.urls),\n    url(r'^$', IndexView.as_view(), name='index'),    # 根路径的路由也从模板渲染改为了继承view的方式\n    url(r'^captcha/', include('captcha.urls')),\n    url(r'^media/(?P<path>.*)', serve, {'document_root': MEDIA_ROOT}),\n    url(r'^users/', include('users.urls', namespace=\"users\")),\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[e("strong",[s._v("修改之后的users底下的urls.py文件是这样的")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django.conf.urls import url, include\n\nfrom .views import LoginView, RegisterView, ActiveUserView, ForgetPwdView, ResetView, ModifyPwdView\nurlpatterns = [\n    url(r'login/$', LoginView.as_view(), name='login'),\n    url(r'register/', RegisterView.as_view(), name='register'),\n    url(r'^active/(?P<active_code>.*)/$', ActiveUserView.as_view(), name=\"user_active\"),\n    url(r'^forget/', ForgetPwdView.as_view(), name=\"forget_pwd\"),\n    url(r'^reset/(?P<active_code>.*)/$', ResetView.as_view(), name=\"reset_pwd\"),\n    url(r'^modify_pwd/', ModifyPwdView.as_view(), name=\"modify_pwd\"),\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("那么如果有HTML文件使用Django的语法特性反解了url的命名，那么也需要修改，如果不修改，那么会抛出异常")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 例如之前HTML里面是这样的：\n<p class=\"form-p\">您还未加入Dee Future？<a href=\"{% url 'register' %}\">[立即加入]</a></p>\n\n# 需要修改为如下设置，如果不修改，那么会出现 2018-08-12 06:26:07,225 django_debug_error 39  [ERROR]  Reverse for 'user_info' with arguments '()' and keyword arguments '{}' not found. 0 pattern(s) tried: []\n\n<p class=\"form-p\">您还未加入Dee Future？<a href=\"{% url 'users:register' %}\">[立即加入]</a></p>\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"八-开始处理结构列表页面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#八-开始处理结构列表页面"}},[s._v("#")]),s._v(" （八）"),e("strong",[e("code",[s._v("开始处理结构列表页面")])])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("也就是下面这个页面\n"),e("img",{attrs:{src:a(1030),alt:"Alt text"}})])]),s._v(" "),e("li",[e("p",[s._v("首先编写一级路由逻辑")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# todo:课程机构首页，使用二级路由, namespace参数，使得二级路由的name可以重复，不会导致冲突\nurl(r'^org/', include('organization.urls',namespace=\"org\")),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("再在organization这个APP下面的views.py文件中，编写")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django.shortcuts import render\nfrom django.views.generic import View\nfrom .models import CourseOrg, CityDict, Teacher\n\n\n\n# 课程机构列表\nclass OrgView(View):\n    def get(self, request):\n        # 获取数据库中所有的机构数据\n        all_orgs = CourseOrg.objects.all()\n\n        # 获取数据库中所有的城市数据\n        all_citys = CityDict.objects.all()\n\t\t\n        return render(request, 'org-list.html', {'all_orgs': all_orgs, 'all_citys': all_citys})\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("ul",[e("li",[s._v("再在organization这个APP下面创建一个urls.py文件，作为二级路由")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django.conf.urls import url\n\nfrom .views import OrgView\n\nurlpatterns = [\n    url(r'^list/', OrgView.as_view(), name=\"org_list\"),\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("在base.html中修改课程结构的跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<li {% if request.path|slice:'9' == '/org/list' %} class=\"active\" {% endif %}>\n\t<a href=\"{% url 'org:org_list' %}\">授课机构</a>\n</li>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("然后在org-list.html中，将OrgView传递到前端的对象显示出来")]),s._v(" "),e("li",[s._v("之前是这样的")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li>\n\t<h2>所在地区</h2>\n\t<div class="more">\n\t\t更多\n\t</div>\n\t\n\t<div class="cont">\n\t\t<a href="?ct="><span class="active2">全部</span></a>\n\n        <a href="?city=1&ct="><span class="">北京市</span></a>\n\n        <a href="?city=2&ct="><span class="">上海市</span></a>\n\n        <a href="?city=3&ct="><span class="">广州市</span></a>\n\n        <a href="?city=4&ct="><span class="">深圳市</span></a>\n\n        <a href="?city=5&ct="><span class="">天津市</span></a>\n\t</div>\n</li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("ul",[e("li",[s._v("修改后是这样的")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li>\n    <h2>所在地区</h2>\n    <div class="more">更多</div>\n    <div class="cont">\n        <a href="?ct="><span class="active2">全部</span></a>\n            {% for city in all_citys %}\n                <a href="?city=1&ct="><span class="">{{ city.name }}</span></a>\n            {% endfor %}\n    </div>\n</li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[s._v("再修改机构的logo部分, 修改前是这样的")])]),s._v(" "),e("div",{staticClass:"language-htmlbars line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="layout">\n\t\x3c!-- 这里是学习人数这块 --\x3e\n    <div class="head">...</div###  \n    \x3c!-- 这里开始显示结构的logo --\x3e\n    <dl class="des difdes">...</dl>\n    <dl class="des difdes">...</dl>\n    <dl class="des difdes">...</dl>\n    <dl class="des difdes">...</dl>\n    <dl class="des difdes">...</dl>\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[s._v("修改之后是这样的")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="layout">\n    <div class="head">\n    </div>\n    \x3c!-- 使用Django的模板语法遍历所有的机构 --\x3e\n    {% for course_org in all_orgs %}\n        <dl class="des difdes">...</dl>\n    {% endfor %}\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("目前这个布局是这样的")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1031),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("因此，可以在html中找到对应的标签，使用数据库中的数据修改html的数据")]),s._v(" "),e("li",[s._v("那么对于dt标签，需要显示logo")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\x3c!-- 这里需要显示数据库中保存的图片的地址 --\x3e\n<img width="200" height="120" class="scrollLoading" data-url="{{ MEDIA_URL }}{{ course_org.image }}" src="{{ MEDIA_URL }}{{ course_org.image }}"/>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("那么显示图片就依赖settings文件的MEDIA_ROOT")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("MEDIA_URL = '/media/'\nMEDIA_ROOT = os.path.join(BASE_DIR, 'media')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("还需要在settings文件中配置一个Django的内部templates的处理类")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("TEMPLATES "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BACKEND'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.template.backends.django.DjangoTemplates'")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DIRS'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("os.path.join"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BASE_DIR, "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'templates'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'APP_DIRS'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" True,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'OPTIONS'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'context_processors'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.template.context_processors.debug'")]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.template.context_processors.request'")]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.contrib.auth.context_processors.auth'")]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.contrib.messages.context_processors.messages'")]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 为了引用图片地址的时候，使用data-url="{{ MEDIA_URL }}{{ course_org.image }}"， 因此，需要加入这个类, 使得{{ MEDIA_URL }}能够取到值')]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.core.context_processors.media'")]),s._v(",  \n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("ul",[e("li",[s._v("最后还需要在项目的urls.py文件中添加， 能够让图片引用被找到")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^media/(?P<path>.*)', serve, {'document_root': MEDIA_ROOT}),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"九-django的分页库-django-pure-pagination-介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#九-django的分页库-django-pure-pagination-介绍"}},[s._v("#")]),s._v(" （九）"),e("strong",[e("code",[s._v("Django的分页库 django-pure-pagination 介绍")])])]),s._v(" "),e("ul",[e("li",[s._v("安装django-pure-pagination")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 安装Django的分页库\npip install django-pure-pagination\n\n# 添加到settings文件的apps里面\nINSTALLED_APPS = (\n    ...\n    'pure_pagination',\n)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("在views.py中应用，之前都是讲数据库中所有的机构返回到前端HTML页面中，但是如果有100个机构，那么页面将会非常的长，因此，在将机构的model返回之前，需要将这个model在pure_pagination内部先处理")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 课程机构列表\nclass OrgView(View):\n    def get(self, request):\n        # 获取数据库中所有的机构数据, [<CourseOrg: 北京大学>, <CourseOrg: 清华大学>, <CourseOrg: 深圳大学>, <CourseOrg: 湖南大学>] 每一条记录是一个元素\n        all_orgs = CourseOrg.objects.all()\n        # 获取机构的数量\n        org_nums = all_orgs.count()\n\n        try:\n            page = request.GET.get('page', 1)\n\n        except PageNotAnInteger:\n            page = 1\n        #\n        p = Paginator(object_list=all_orgs, per_page=5 ,request=request)\n        orgs = p.page(page) # 使用分页器将所有的机构分页，per_page指定为5个，因此，orgs里面一定是5个机构组成的列表\n\n        # 获取数据库中所有的城市数据\n        all_citys = CityDict.objects.all()\n\n        return render(request, 'org-list.html', {\n            'all_orgs': orgs,\n            'all_citys': all_citys,\n            'org_nums': org_nums,\n        })\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br")])]),e("ul",[e("li",[s._v("这么返回的orgs model是被分页器处理过的，显示到前端页面， 进行for循环的时候，就需要修改下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("{% for course_org in all_orgs.object_list %}\n{% endfor %}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("分页的页脚，只需要这样就会有页面出现了, 外面的div不需要任何样式")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div id="pagination"###  \n    {{ people.render }}\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("效果是这样的\n"),e("img",{attrs:{src:a(518),alt:"Alt text"}})])]),s._v(" "),e("li",[e("p",[s._v("那么如果需要之定义页脚的话，需要这样写, 这是作者给出的示例， 这里面的page_obj就是传递到前端页面的model列表，对应我们的就是all_orgs")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% load i18n %}\n<div class="pagination">\n\t# 如果有前一页，显示前一页，如果没有，就disable\n    {% if page_obj.has_previous %}\n        <a href="?{{ page_obj.previous_page_number.querystring }}" class="prev">&lsaquo;&lsaquo; {% trans "previous" %}</a>\n    {% else %}\n        <span class="disabled prev">&lsaquo;&lsaquo; {% trans "previous" %}</span>\n    {% endif %}\n\t\n\n\t# 显示中间的页面\n    {% for page in page_obj.pages %}\n        {% if page %}\n            {% ifequal page page_obj.number %}\n\t            # 如果是当前页面，显示当前页面的标号不能被点击\n                <span class="current page">{{ page }}</span>\n            {% else %}\n\t            # 如果不是当前页面，可以跳转\n                <a href="?{{ page.querystring }}" class="page">{{ page }}</a>\n            {% endifequal %}\n\t\t# 中间其他的页面，用...表示\n        {% else %}\n            ...\n        {% endif %}\n    {% endfor %}\n\n\n\t# 如果有下一页，显示下一页，如果没有，就disable\n    {% if page_obj.has_next %}\n        <a href="?{{ page_obj.next_page_number.querystring }}" class="next">{% trans "next" %} &rsaquo;&rsaquo;</a>\n    {% else %}\n        <span class="disabled next">{% trans "next" %} &rsaquo;&rsaquo;</span>\n    {% endif %}\n    \n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("如果按照官方的写法修改我们的代码，还是这样的\n"),e("img",{attrs:{src:a(518),alt:"Alt text"}})])]),s._v(" "),e("li",[e("p",[s._v("因此需要将样式改变一下， 让元素左浮动")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="pageturn">\n\n    \x3c!-- 显示前一页 --\x3e\n    {% if all_orgs.has_previous %}\n        <li class="long" style="list-style: none">\n            <a href="?{{ all_orgs.previous_page_number.querystring }}">上一页</a>\n        </li>\n    {% endif %}\n    \x3c!-- 显示中间的页面 --\x3e\n    {% for page in all_orgs.pages %}\n        {% if page %}\n            {% ifequal page all_orgs.number %}\n                <li class="active" style="list-style: none">\n                    <a>{{ page }}</a>\n                </li>\n            {% else %}\n                <li  class="page" style="list-style: none">\n                    <a href="?{{ page.querystring }}" >{{ page }}</a>\n                </li>\n            {% endifequal %}\n        {% else %}\n            <li class="none" style="list-style: none">\n                <a href="">...</a>\n            </li>\n        {% endif %}\n    {% endfor %}\n    \x3c!-- 显示末尾页面 --\x3e\n    {% if all_orgs.has_next %}\n        <li class="long" style="list-style: none">\n            <a  href="?{{ all_orgs.next_page_number.querystring }}" >下一页</a>\n        </li>\n    {% endif %}\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br")])]),e("ul",[e("li",[s._v("就变成这样了\n"),e("img",{attrs:{src:a(1032),alt:"Alt text"}})])]),s._v(" "),e("h3",{attrs:{id:"十-实现-点击对应的城市的时候-过滤出属于城市的机构-点击结构类别的时候-过滤属于对应的机构类别的机构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十-实现-点击对应的城市的时候-过滤出属于城市的机构-点击结构类别的时候-过滤属于对应的机构类别的机构"}},[s._v("#")]),s._v(" （十）"),e("strong",[e("code",[s._v("实现 点击对应的城市的时候，过滤出属于城市的机构, 点击结构类别的时候，过滤属于对应的机构类别的机构")])])]),s._v(" "),e("ul",[e("li",[s._v("当用户点击某个城市的时候，可以将属于这个城市的机构显示出来，不属于这个城市的机构不显示")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="cont">\n    <a href="?city="><span {% ifequal city_view_id \'\' %} class="active2" {% endifequal %}>全部</span></a>\n    {% for city in all_citys %}\n    \t# 这里的a标签会携带参数访问，例如：192.168.23.10?city=1\n        <a href="?city={{ city.id }}"><span class="{% ifequal city_view_id city.id|stringformat:"i" %}active2{% endifequal %}">{{ city.name }}</span></a>\n    {% endfor %}\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("在views.py里面这样处理")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 先拿到city_id，再从对应的机构中过滤出与city_id相关的机构\ncity_id = request.GET.get('city', \"\")\nif city_id:\n\tall_orgs = all_orgs.filter(city_id=city_id)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("当用户点击机构类别的时候，可以将属于这个城市的机构显示出来，不属于这个城市的机构不显示")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="cont">\n    <a href="?ct="><span {% ifequal category "" %}  class="active2" {% endifequal %} >全部</span></a>\n    <a href="?ct=pxjg"><span {% ifequal category "pxjg" %} class="active2" {% endifequal %}>培训机构</span></a>\n    <a href="?ct=gx"><span {% ifequal category "gx" %} class="active2" {% endifequal %}>高校</span></a>\n    <a href="?ct=gr"><span {% ifequal category "gr" %} class="active2" {% endifequal %}>个人</span></a>\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("ul",[e("li",[s._v("在views.py里面这样处理")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("category = request.GET.get('ct', \"\")\nif category:\n\tall_orgs = all_orgs.filter(category=category)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("为了在前端高亮用户点击了哪个，需要将后台获取到前端的值再次传递回来")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("return render(request, 'org-list.html', {\n\t'all_orgs': orgs,\n    'all_citys': all_citys,\n    'org_nums': org_nums,\n    'city_view_id': city_id,\n    'category': category,\n})\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"十一-实现-机构类别和城市的联动过滤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十一-实现-机构类别和城市的联动过滤"}},[s._v("#")]),s._v(" （十一）"),e("strong",[e("code",[s._v("实现 机构类别和城市的联动过滤")])])]),s._v(" "),e("ul",[e("li",[s._v("现在还有一个问题，就是当点击了机构类别之后，再点击所在地区的话，结构类别又会跳转到全部，这是因为：机构类别和所在地区没有做关联")]),s._v(" "),e("li",[s._v("再次修改前端页面的html")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li>\n\t<h2>机构类别</h2>\n\t<div class="cont">\n       <a href="?city={{ city_view_id }}"><span {% ifequal category "" %}  class="active2" {% endifequal %} >全部</span></a>\n       <a href="?ct=pxjg&city={{ city_view_id }}"><span {% ifequal category "pxjg" %} class="active2" {% endifequal %}>培训机构</span></a>\n       <a href="?ct=gx&city={{ city_view_id }}"><span {% ifequal category "gx" %} class="active2" {% endifequal %}>高校</span></a>\n       <a href="?ct=gr&city={{ city_view_id }}"><span {% ifequal category "gr" %} class="active2" {% endifequal %}>个人</span></a>\n\t</div>\n</li>\n\n<li>\n\t<h2>所在地区</h2>\n\t<div class="more">更多</div>\n\t<div class="cont">\n        <a href="?ct={{ category }}"><span {% ifequal city_view_id \'\' %} class="active2" {% endifequal %}>全部</span></a>\n            {% for city in all_citys %}\n                <a href="?city={{ city.id }}&ct={{ category }}"><span class="{% ifequal city_view_id city.id|stringformat:"i" %}active2{% endifequal %}">{{ city.name }}</span></a>\n            {% endfor %}\n\t</div>\n</li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("ul",[e("li",[s._v("那么机构类别和所在地区就可以联动过滤了\n"),e("img",{attrs:{src:a(1033),alt:"Alt text"}})])]),s._v(" "),e("h3",{attrs:{id:"十二-实现授课机构的排名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十二-实现授课机构的排名"}},[s._v("#")]),s._v(" （十二）"),e("strong",[e("code",[s._v("实现授课机构的排名")])])]),s._v(" "),e("ul",[e("li",[s._v("在右边有一个课程机构排名，谁的点击数多就排在前面")]),s._v(" "),e("li",[s._v("编辑views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 获取热门的机构， 获取前三点击最多的机构\nhot_orgs = all_orgs.order_by(\"-click_nums\")[:3]\n\nreturn render(request, 'org-list.html', {\n    'all_orgs': orgs,\n    'all_citys': all_citys,\n    'org_nums': org_nums,\n    'city_view_id': city_id,\n    'category': category,\n    'hot_orgs': hot_orgs,  # 将点击最多的机构返回\n})\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("在HTML显示")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<div class="right companyrank layout">\n    <div class="head">授课机构排名</div>\n    {% for hot_org in hot_orgs %}\n    <dl class="des">\n\t    # forloop.counter 会记录了循环的次数, 这是Django的模板语法\n        <dt class="num fl">{{ forloop.counter }}</dt>\n        <dd>\n            <a href="/company/2/"><h1>{{ hot_org.name }}</h1></a>\n            <p>{{ hot_org.address }}</p>\n        </dd>\n    </dl>\n    {% endfor %}\n</div>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"十三-实现-课程结构根据学习人数和课程数多少排名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十三-实现-课程结构根据学习人数和课程数多少排名"}},[s._v("#")]),s._v(" （十三）"),e("strong",[e("code",[s._v("实现 课程结构根据学习人数和课程数多少排名")])])]),s._v(" "),e("ul",[e("li",[s._v("在前端页面将指定的排序字段通过url传递进来")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<ul class="tab_header">\n\t<li {% ifequal sort \'\' %} class="active" {% endifequal %}><a href="?ct={{ category }}&city={{ city_view_id }}">全部</a### </li>\n\t<li {% ifequal sort \'students\' %} class="active" {% endifequal %}><a href="?sort=students&ct={{ category }}&city={{ city_view_id }}">学习人数 &#8595;</a></li>\n\t<li {% ifequal sort \'courses\' %} class="active" {% endifequal %}><a href="?sort=courses&ct={{ category }}&city={{ city_view_id }}">课程数 &#8595;</a></li>\n</ul>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[s._v("在view.py里面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("if sort:\n    # c= a if a>1 else b Python三元运算符\n    all_orgs = all_orgs.order_by('-students') if sort == 'students' else all_orgs.order_by('-course_numbers')\n\n\nreturn render(request, 'org-list.html', {\n            'all_orgs': orgs,\n            'all_citys': all_citys,\n            'org_nums': org_nums,\n            'city_view_id': city_id,\n            'category': category,\n            'hot_orgs': hot_orgs,\n            'sort': sort,  # 将sort返回\n})\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h3",{attrs:{id:"十四-实现-机构列表页的我要学习功能-引入modelform"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十四-实现-机构列表页的我要学习功能-引入modelform"}},[s._v("#")]),s._v(" （十四）"),e("strong",[e("code",[s._v("实现 机构列表页的我要学习功能( 引入ModelForm )")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1034),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("django中的ModelForm的主要功能就是将已经存在的model转化成为对应的form，对前端页面的表单提交做验证")])]),s._v(" "),e("li",[s._v("在organization下创建一个forms.py文件，因为我要学习的表单提交的字段数据与operation app的UserAsk类似，因此验证我要学习提交的表单数据的form可以使用modelform，直接继承UserAsk，生成modelform,  forms.py内容如下：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django import forms\nfrom operation.models import UserAsk\n\n\n# ModelForm 不仅可以继承其他model的字段，还可以有自己的字段\nclass UserAskForm(forms.ModelForm):\n\n\n    class Meta:\n        model = UserAsk\n        fields = ['name', 'mobile', 'course_name']\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("在organization的urls.py中添加url")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^add_ask/', AddUserAskView.as_view(), name='add_ask'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("前端页面提交数据的form不再是使用原生的表单提交方式，而是ajax提交方式")])]),s._v(" "),e("div",{staticClass:"language-htmlbars line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 这个form标签并没有action\n<form class="rightform" id="jsStayForm">\n\t<div>\n        <img src="{% static \'images/person_name.png\' %}"/>\n        <input type="text" name="name" id="companyName" placeholder="名字" maxlength="25" />\n    </div>\n\t<div>\n        <img src="{% static \'images/phone.png\' %}"/>\n        <input type="text" name="mobile" id="companyMobile" placeholder="联系电话"/>\n    </div>\n\t<div>\n        <img src="{% static \'images/course_name.png\' %}"/>\n        <input type="text" name="course_name" id="companyAddress" placeholder="课程名" maxlength="50" />\n    </div>\n    <p class="error company-tips" id="jsCompanyTips"></p>\n    # 这个input标签的type的值不是submit，而是text\n\t<input class="btn" type="text" id="jsStayBtn" value="立即咨询 >" />\n    {% csrf_token %}\n</form>\n\n\n\n\x3c!-- ajax异步请求 --\x3e\n{% block custom_js %}\n    <script>\n        $(function () {\n            $("#jsStayBtn").on(\'click\', function () {\n                $.ajax({\n                    cache: false,\n                    type: "POST",\n                    url: "{% url \'org:add_ask\' %}",\n                    data: $("#jsStayForm").serialize(),  // 这里要注意，是拿到form表达序列化的，不是拿到input标签\n                    async: true,\n                    dataType: \'json\',\n                    //dataType: "json",\n                    // 如果请求发送成功， 会接到一个data参数\n                    success: function (data) {  // data是返回的json对象, 这是一个回调函数\n                        if(data.status == "success"){  // 如果验证成功\n                            $("#jsStayForm")[0].reset();\n                            $("#jsCompanyTips").html("恭喜您，请求提交成功");\n                        }else if(data.status == "fail"){ // 如果验证失败\n                            $("#jsCompanyTips").html(data.msg);\n                        };\n                    },\n                    error: function (data) {\n                        $("#jsCompanyTips").html("请求提交失败，请重新提交");\n                    },\n                });\n            });\n        });\n    <\/script>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br")])]),e("ul",[e("li",[s._v("在views.py文件里面这样写, ajax是以json方式提交到后台的，那么在view中返回到前端页面不是渲染一个前端页面了，是返回json字符串，实现异步刷新。 那么在django中返回json对象，就是使用HttpResponse")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django.http import HttpResponse\nimport json\n\n\nclass AddUserAskView(View):\n\n    def post(self, request):\n        # 检验提交的数据是否合法\n        user_ask_form = UserAskForm(request.POST)\n        if user_ask_form.is_valid():\n            user_ask = user_ask_form.save(commit=True)\n            success = {'status': 'success'}\n            return HttpResponse(json.dumps(success), content_type=\"application/json\")\n        else:\n            error = {'status': 'fail', 'msg': '提交出错!!!'}\n            return HttpResponse(json.dumps(error), content_type=\"application/json\")\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("ul",[e("li",[s._v("但是现在有个问题，就是填写了电话号码之后，如果号码不正确，也会通过modelform的验证。那么就需要重载手机号码认证的方法")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django import forms\nfrom operation.models import UserAsk\nimport re\n\nclass UserAskForm(forms.ModelForm):  # Model Form还可以有自己的字段\n\n    # 这个Meta信息，记录了这个AnotherUserForm由哪一个Model转变而来的，且使用这个Model中的哪些字段\n    class Meta:\n        model = UserAsk # 使用UserAsk这个model\n        fields = ['name', 'mobile', 'course_name'] # 使用这些字段\n\n    # 重写对于mobile字段的验证方法, 当UserAskForm这个model form实例化的时候，会主动调用这个方法验证mobile字段\n    # 这个方法必须是clean开头，且IDE会有提示\n    def clean_mobile(self):\n        '''\n        验证手机是否合法\n        :return:\n        '''\n        # 获取到input提交的mobile的值\n        mobile = self.cleaned_data['mobile']\n        # 手机正则表达式\n        REGEX_MOBILE = \"^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\\d{8}$\"\n        p = re.compile(REGEX_MOBILE)\n        if p.match(mobile):\n            return mobile\n        else:\n            raise forms.ValidationError(u'手机号码格式不正确', code=\"mobile_invalid\")\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("ul",[e("li",[s._v("但是这个抛出的"),e("code",[s._v("forms.ValidationError")]),s._v("结果直接返回到了前端页面，这是很奇怪的，这个再次开发的时候解决")])]),s._v(" "),e("h3",{attrs:{id:"十五-机构详情首页页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十五-机构详情首页页面的开发"}},[s._v("#")]),s._v(" （十五）"),e("strong",[e("code",[s._v("机构详情首页页面的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1035),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("机构的详情页涉及到四个html页面，分别是："),e("code",[s._v("org-detail-homepage.html，org-detail-course.html，org-detail-desc.html，org-detail-teachers.html，")]),s._v(" 将这四个HTML拷贝到templates目录下面。 但是这四个页面的页面布局与index.html页面不一样。因此，需要在写个org_base.html页面，其他的四个页面都继承这个org_base.html页面")]),s._v(" "),e("li",[s._v("如果页面出现这样的错误"),e("code",[s._v("user_info reverse error")]),s._v(", 一定是HTML中使用到的Django模板语法无法解析，那么将这个删除即可")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<!DOCTYPE html>\n<html>\n\x3c!-- 这是课程机构详情页的base页面 --\x3e\n\x3c!-- 使用homepage页面为母版 --\x3e\n\x3c!-- 从课程机构进入的页面都是继承这个模板的 --\x3e\n{% load staticfiles %}\n<head>\n    <meta charset="UTF-8">\n    <meta name="renderer" content="webkit">\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">\n    <title>\n        {% block title %}\n            机构详情---在线网\n        {% endblock %}\n    </title>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/reset.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/animate.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/style.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'js/plugins/queryCity/css/cityLayout.css\' %}">\n    {% block custom_css %}\n    {% endblock %}\n    <script src="{% static \'js/jquery.min.js\' %}" type="text/javascript"><\/script>\n    <script src="{% static \'js/jquery-migrate-1.2.1.min.js\' %}" type="text/javascript"><\/script>\n    {% block custom_js %}\n    {% endblock %}\n</head>\n<body>\n\n\x3c!-- 登录的栏 --\x3e\n<section class="headerwrap headerwrap2">\n    <header>\n        <div class="header2 header">\n\n            {% if request.user.is_authenticated %}\n                <div class="top">\n                    <div class="wp">\n                        <div class="fl"><p>服务电话：<b>18670236750</b></p></div>\n                        <div class="personal">\n                            <dl class="user fr">\n                                <dd>{{ request.user.username }}\n                                    <img class="down fr" src={% static "images/top_down.png" %}/>\n                                </dd>\n                                <dt>\n                                    <img width="20" height="20" src="{{ MEDIA_URL }}{{ request.user.image }}"/>\n                                </dt>\n                            </dl>\n                            <div class="userdetail">\n                                <dl>\n                                    <dt><img width="80" height="80" src="{{ MEDIA_URL }}{{ request.user.image }}"/></dt>\n                                    <dd>\n                                        <h2>{% if request.user.is_superuser %}管理员{% else %}{% endif %}</h2>\n                                        <p>{{ request.user.username }}</p>\n                                    </dd>\n                                </dl>\n                                <div class="btn">\n                                    <a class="personcenter fl" href="{% url \'users:user_info\' %}">进入个人中心</a>\n                                    <a class="fr" href="{% url \'logout\' %}">退出</a>\n                                </div>\n                            </div>\n                        </div>\n                        <a href="{% url \'users:mymsg\' %}">\n                            <div class="msg-num">{{ request.user.get_unread_nums }}</div>\n                        </a>\n                    </div>\n                </div>\n            {% else %}\n                <div style="color: #FFFFFF;">没有导入</div>\n                <div class="top">\n                    <div class="wp">\n                        <div class="fl">\n                            <p>联系方式：<b>3333333333</b></p>\n                        </div>\n                        \x3c!-- 这里使用路由的name关键字 {% url "register" %} --\x3e\n                        <a style="color:white" class="fr registerbtn" href={% url "register" %}>注册</a>\n                        <a style="color:white" class="fr loginbtn" href={% url "login" %}>登录</a>\n                    </div>\n                </div>\n            {% endif %}\n\n            <div class="middle companyheader">\n                <div class="wp">\n                    <img class="fl" style="width: 112px;height: 103px" src="{{ MEDIA_URL }}{{ course_org.image }}"/>\n                    <div class="head fl">\n                        <h1>\n                            慕课网\n                            <img src="{% static \'images/authentication.png\' %}"/>\n                            <img src="{% static \'images/gold.png\' %}"/>\n                        </h1>\n                        <p class="fl">\n                            <span class="fl" style="margin-top:8px;color:#848484;">推荐指数： </span>\n                            <span class="precision company-credit" data-star-scope="5.0"></span>\n                            <span class="key">5.0</span>\n                        </p>\n                    </div>\n                    <div class="btn fr collectionbtn  notlogin\n                 " data-favid="22" data-fav-type="1">\n                        {% if fav_status %} 已收藏 {% else %} 收藏 {% endif %}\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    </header>\n</section>\n\n\x3c!-- 面包屑部分 --\x3e\n<section>\n    <div class="wp">\n        <ul class="crumbs">\n            <li><a href="{% url \'index\' %}">首页</a>></li>\n            <li><a href="{% url \'org:org_list\' %}">课程机构</a>></li>\n            <li>{% block page_path %} 课程首页 {% endblock %}</li>\n        </ul>\n    </div>\n</section>\n\n\x3c!-- 内容区分为两块，左边是一样的，右边不一样  --\x3e\n<section>\n    <div class="wp list personal_list comp">\n\n        \x3c!-- 左边一样的 --\x3e\n        <div class="left">\n            <ul>\n                \x3c!-- 这里的course_org是机构的一条记录，是有机构列表页传递进来的，views中又传递到了这个模板的子模板中，最后在这个base模板中可以拿到course_org， 这是被点击的那个机构记录 --\x3e\n                \x3c!-- 这里的course_org.id会写入到url，例如：url为/org/course/1 这样的 --\x3e\n                <li {% ifequal current_page "home" %} class="active2" {% endifequal %}><a\n                        href="{% url \'org:org_home\' course_org.id %}">机构首页</a></li>\n                <li {% ifequal current_page "course" %} class="active2" {% endifequal %}><a\n                        href="{% url \'org:org_course\' course_org.id %}">机构课程</a></li>\n                <li {% ifequal current_page "desc" %} class="active2" {% endifequal %}><a\n                        href="{% url \'org:org_desc\' course_org.id %}">机构介绍</a>\n                </li>\n                <li {% ifequal current_page "teacher" %} class="active2" {% endifequal %}><a\n                        href="{% url \'org:org_teacher\' course_org.id %}">机构讲师</a></li>\n            </ul>\n        </div>\n\n        \x3c!-- 右边不一样的 --\x3e\n        {% block right_form %}\n\n        {% endblock %}\n    </div>\n</section>\n\n<section>\n    <ul class="sidebar">\n        <li class="qq">\n            <a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=2023525077&site=qq&menu=yes"></a>\n        </li>\n        <li class="totop"></li>\n    </ul>\n</section>\n\n\x3c!--弹出省省市--\x3e\n<script src="{% static \'js/selectUi.js\' %}" type=\'text/javascript\'><\/script>\n<script type="text/javascript" src="{% static \'js/plugins/laydate/laydate.js\' %}"><\/script>\n<script src="{% static \'js/plugins/layer/layer.js\' %}"><\/script>\n<script src="{% static \'js/plugins/queryCity/js/public.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/unslider.js\' %}" type=\'text/javascript\'><\/script>\n<script src="{% static \'js/plugins/jquery.scrollLoading.js\' %}" type="text/javascript"><\/script>\n<script src="{% static \'js/validateDialog.js\' %}" type=\'text/javascript\'><\/script>\n<script src="{% static \'js/deco-common.js\' %}" type="text/javascript"><\/script>\n<script type="text/javascript" src="{% static \'js/plugins/jquery.raty.js\' %}"><\/script>\n<script type="text/javascript">\n    // 这个js控制那推荐指数的✨ ✨\n    $(function () {\n        var $precision = $(\'.precision\'),\n            score = $precision.attr(\'data-star-scope\'),\n            option = {\n                half: true,\n                path: "{% static \'images/\' %}",\n                precision: true,\n                size: 24,\n                starOff: \'g_star.png\',\n                starOn: \'r_star.png\',\n                starHalf: \'h_star.png\',\n                hints: [\'极差\', \'差\', \'一般\', \'好评\', \'非常满意\'],\n                noRatedMsg: \'暂时还未获得评价！\',\n                readOnly: true,\n                score: score\n            };\n\n        $precision.raty(option);\n\n        $(\'.jsFavBtn\').on(\'click\', function () {\n            var type = $(this).attr(\'data-fav-type\');\n            if (type == \'1\') {\n                favPraise($(this), \'fav\', 1, \'收藏\');\n\n            } else if (type == \'3\') {\n                favPraise($(this), \'fav\', 3);\n\n            } else if (type == \'11\') {\n                favPraise($(this), \'pra\', 1);\n\n            } else if (type == \'4\') {\n                favPraise($(this), \'fav\', 4);\n\n            }\n        });\n    })\n<\/script>\n<script type="text/javascript">\n    $(function () {\n        $(\'.recordbtn1\').click(function () {\n            $(\'.recordbox1\').show();\n        });\n        $(\'.recordbtn2\').click(function () {\n            $(\'.recordbox2\').show();\n        });\n\n        $(\'.imgslide\').unslider({\n            speed: 500,\n            delay: 3000,\n            complete: function () {\n            },\n            keys: true,\n            dots: true,\n            fluid: false\n        });\n        var unslider = $(\'.imgslide\').unslider();\n        $(\'.unslider-arrow\').click(function () {\n            var fn = this.className.split(\' \')[1];\n            unslider.data(\'unslider\')[fn]();\n        });\n    });\n<\/script>\n\n\x3c!-- 处理收藏和取消的ajax --\x3e\n<script>\n\n    let add_fav = function (current_elem, fav_id, fav_type) {\n        $.ajax({\n            cache: false,\n            type: \'POST\',\n            url: "{% url \'org:add_fav\' %}",\n            data: {\'fav_id\': fav_id, \'fav_type\': fav_type}, // 这里没有form表达提交，因此，不需要序列号\n            async: true,\n            dataType: \'json\',\n            beforeSend: function (xhr, settings) {\n                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");\n            },\n            success: function (data) {\n\n                if (data.status == "fail") {\n                    if (data.msg == \'您还未登入，请先登录\') {\n                        window.location.href = \'/login/\';\n                    } else {\n\n                        current_elem.text(data.msg)\n                    }\n                    ;\n                } else {\n                    current_elem.text(data.msg)\n                }\n            },\n            error: function (data) {\n                console.log(\'请求数据失败\');\n\n            },\n        });\n    };\n\n    $(".collectionbtn").on(\'click\', function () {\n        add_fav($(this), {{ course_org.id }}, 2);\n    });\n\n\n<\/script>\n</body>\n</html>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br"),e("span",{staticClass:"line-number"},[s._v("163")]),e("br"),e("span",{staticClass:"line-number"},[s._v("164")]),e("br"),e("span",{staticClass:"line-number"},[s._v("165")]),e("br"),e("span",{staticClass:"line-number"},[s._v("166")]),e("br"),e("span",{staticClass:"line-number"},[s._v("167")]),e("br"),e("span",{staticClass:"line-number"},[s._v("168")]),e("br"),e("span",{staticClass:"line-number"},[s._v("169")]),e("br"),e("span",{staticClass:"line-number"},[s._v("170")]),e("br"),e("span",{staticClass:"line-number"},[s._v("171")]),e("br"),e("span",{staticClass:"line-number"},[s._v("172")]),e("br"),e("span",{staticClass:"line-number"},[s._v("173")]),e("br"),e("span",{staticClass:"line-number"},[s._v("174")]),e("br"),e("span",{staticClass:"line-number"},[s._v("175")]),e("br"),e("span",{staticClass:"line-number"},[s._v("176")]),e("br"),e("span",{staticClass:"line-number"},[s._v("177")]),e("br"),e("span",{staticClass:"line-number"},[s._v("178")]),e("br"),e("span",{staticClass:"line-number"},[s._v("179")]),e("br"),e("span",{staticClass:"line-number"},[s._v("180")]),e("br"),e("span",{staticClass:"line-number"},[s._v("181")]),e("br"),e("span",{staticClass:"line-number"},[s._v("182")]),e("br"),e("span",{staticClass:"line-number"},[s._v("183")]),e("br"),e("span",{staticClass:"line-number"},[s._v("184")]),e("br"),e("span",{staticClass:"line-number"},[s._v("185")]),e("br"),e("span",{staticClass:"line-number"},[s._v("186")]),e("br"),e("span",{staticClass:"line-number"},[s._v("187")]),e("br"),e("span",{staticClass:"line-number"},[s._v("188")]),e("br"),e("span",{staticClass:"line-number"},[s._v("189")]),e("br"),e("span",{staticClass:"line-number"},[s._v("190")]),e("br"),e("span",{staticClass:"line-number"},[s._v("191")]),e("br"),e("span",{staticClass:"line-number"},[s._v("192")]),e("br"),e("span",{staticClass:"line-number"},[s._v("193")]),e("br"),e("span",{staticClass:"line-number"},[s._v("194")]),e("br"),e("span",{staticClass:"line-number"},[s._v("195")]),e("br"),e("span",{staticClass:"line-number"},[s._v("196")]),e("br"),e("span",{staticClass:"line-number"},[s._v("197")]),e("br"),e("span",{staticClass:"line-number"},[s._v("198")]),e("br"),e("span",{staticClass:"line-number"},[s._v("199")]),e("br"),e("span",{staticClass:"line-number"},[s._v("200")]),e("br"),e("span",{staticClass:"line-number"},[s._v("201")]),e("br"),e("span",{staticClass:"line-number"},[s._v("202")]),e("br"),e("span",{staticClass:"line-number"},[s._v("203")]),e("br"),e("span",{staticClass:"line-number"},[s._v("204")]),e("br"),e("span",{staticClass:"line-number"},[s._v("205")]),e("br"),e("span",{staticClass:"line-number"},[s._v("206")]),e("br"),e("span",{staticClass:"line-number"},[s._v("207")]),e("br"),e("span",{staticClass:"line-number"},[s._v("208")]),e("br"),e("span",{staticClass:"line-number"},[s._v("209")]),e("br"),e("span",{staticClass:"line-number"},[s._v("210")]),e("br"),e("span",{staticClass:"line-number"},[s._v("211")]),e("br"),e("span",{staticClass:"line-number"},[s._v("212")]),e("br"),e("span",{staticClass:"line-number"},[s._v("213")]),e("br"),e("span",{staticClass:"line-number"},[s._v("214")]),e("br"),e("span",{staticClass:"line-number"},[s._v("215")]),e("br"),e("span",{staticClass:"line-number"},[s._v("216")]),e("br"),e("span",{staticClass:"line-number"},[s._v("217")]),e("br"),e("span",{staticClass:"line-number"},[s._v("218")]),e("br"),e("span",{staticClass:"line-number"},[s._v("219")]),e("br"),e("span",{staticClass:"line-number"},[s._v("220")]),e("br"),e("span",{staticClass:"line-number"},[s._v("221")]),e("br"),e("span",{staticClass:"line-number"},[s._v("222")]),e("br"),e("span",{staticClass:"line-number"},[s._v("223")]),e("br"),e("span",{staticClass:"line-number"},[s._v("224")]),e("br"),e("span",{staticClass:"line-number"},[s._v("225")]),e("br"),e("span",{staticClass:"line-number"},[s._v("226")]),e("br"),e("span",{staticClass:"line-number"},[s._v("227")]),e("br"),e("span",{staticClass:"line-number"},[s._v("228")]),e("br"),e("span",{staticClass:"line-number"},[s._v("229")]),e("br"),e("span",{staticClass:"line-number"},[s._v("230")]),e("br"),e("span",{staticClass:"line-number"},[s._v("231")]),e("br"),e("span",{staticClass:"line-number"},[s._v("232")]),e("br"),e("span",{staticClass:"line-number"},[s._v("233")]),e("br"),e("span",{staticClass:"line-number"},[s._v("234")]),e("br"),e("span",{staticClass:"line-number"},[s._v("235")]),e("br"),e("span",{staticClass:"line-number"},[s._v("236")]),e("br"),e("span",{staticClass:"line-number"},[s._v("237")]),e("br"),e("span",{staticClass:"line-number"},[s._v("238")]),e("br"),e("span",{staticClass:"line-number"},[s._v("239")]),e("br"),e("span",{staticClass:"line-number"},[s._v("240")]),e("br"),e("span",{staticClass:"line-number"},[s._v("241")]),e("br"),e("span",{staticClass:"line-number"},[s._v("242")]),e("br"),e("span",{staticClass:"line-number"},[s._v("243")]),e("br"),e("span",{staticClass:"line-number"},[s._v("244")]),e("br"),e("span",{staticClass:"line-number"},[s._v("245")]),e("br"),e("span",{staticClass:"line-number"},[s._v("246")]),e("br"),e("span",{staticClass:"line-number"},[s._v("247")]),e("br"),e("span",{staticClass:"line-number"},[s._v("248")]),e("br"),e("span",{staticClass:"line-number"},[s._v("249")]),e("br"),e("span",{staticClass:"line-number"},[s._v("250")]),e("br"),e("span",{staticClass:"line-number"},[s._v("251")]),e("br"),e("span",{staticClass:"line-number"},[s._v("252")]),e("br"),e("span",{staticClass:"line-number"},[s._v("253")]),e("br"),e("span",{staticClass:"line-number"},[s._v("254")]),e("br"),e("span",{staticClass:"line-number"},[s._v("255")]),e("br"),e("span",{staticClass:"line-number"},[s._v("256")]),e("br"),e("span",{staticClass:"line-number"},[s._v("257")]),e("br"),e("span",{staticClass:"line-number"},[s._v("258")]),e("br"),e("span",{staticClass:"line-number"},[s._v("259")]),e("br"),e("span",{staticClass:"line-number"},[s._v("260")]),e("br"),e("span",{staticClass:"line-number"},[s._v("261")]),e("br"),e("span",{staticClass:"line-number"},[s._v("262")]),e("br"),e("span",{staticClass:"line-number"},[s._v("263")]),e("br"),e("span",{staticClass:"line-number"},[s._v("264")]),e("br"),e("span",{staticClass:"line-number"},[s._v("265")]),e("br"),e("span",{staticClass:"line-number"},[s._v("266")]),e("br"),e("span",{staticClass:"line-number"},[s._v("267")]),e("br"),e("span",{staticClass:"line-number"},[s._v("268")]),e("br"),e("span",{staticClass:"line-number"},[s._v("269")]),e("br"),e("span",{staticClass:"line-number"},[s._v("270")]),e("br"),e("span",{staticClass:"line-number"},[s._v("271")]),e("br")])]),e("ul",[e("li",[s._v("完成org-detail-homepage.html页面的继承")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends \'org_base.html\' %}\n{% load staticfiles %}\n{% block title %}\n    机构详情首页\n{% endblock %}\n\n{% block page_path %}\n    机构详情首页\n{% endblock %}\n\n\x3c!-- 替换右边 --\x3e\n{% block right_form %}\n    \x3c!-- 全部课程 --\x3e\n    <div class="right companycenter layout grouping">\n        <div class="head">\n            <h1>全部课程</h1>\n            <a class="green fr more" href="org-detail-course.html">查看更多 ### </a>\n        </div>\n\n\n        <div class="brief group_list">\n            \x3c!--- 开始遍历course --\x3e\n            \x3c!--- 这里是浮动的，因此在这里遍历，课程是横排 --\x3e\n            {% for course in all_courses %}\n                <div class="module1_5 box">\n                    <a href="{% url \'courses:course_detail\' course.id %}"><img width="214" src="{{ MEDIA_URL }}{{ course.image }}"/></a>\n                    <div class="des">\n                        <a href="/group/groupdetail/13/"><h2>{{ course.name }}</h2></a>\n                        <span class="fl">课时：<i class="key">{{ course.learn_times }}</i></span>\n                        <span class="fr">参加人数：{{ course.students }}</span>\n                    </div>\n                    <div class="bottom">\n                        <span class="fl">{{ course.course_org.name }}</span>\n                        <span class="star fr  notlogin\n                            " data-favid="13" data-fav-type="4">\n                            \x3c!-- 收藏数 --\x3e\n                            {{ course.fav_num }}\n                        </span>\n                    </div>\n                </div>\n            {% endfor %}\n\n        </div>\n    </div>\n\n    \x3c!-- 机构教师 --\x3e\n    <div class="right companycenter layout">\n        <div class="head">\n            <h1>机构教师</h1>\n            <a class="green fr more" href="org-detail-teachers.html">查看更多 ### </a>\n        </div>\n\n        <div class="diarys">\n            \x3c!-- 开始遍历老师 --\x3e\n            {% for teach in all_teachers %}\n                <div class="module5 share company-diary-box" style="padding:10px 0;">\n                    <div class="left">\n                        <img class="pic" src="{{ MEDIA_URL }}{{ teach.image }}"/>\n                        <p>昵称：{{ teach.name }}</p>\n                    </div>\n                    <div class="right">\n                        <div class="top">\n                            <div class="fl">\n                                <a href=""><h1>{{ teach.work_position }}</h1></a>\n                                <span>{{ teach.add_time }}</span>\n                            </div>\n                        </div>\n                        <div class="middle" style="border-bottom:0;">自我介绍: &nbsp; {{ teach.desc }} </div>\n                    </div>\n                </div>\n            {% endfor %}\n        </div>\n\n    </div>\n\n    \x3c!-- 机构介绍 --\x3e\n    <div class="right companycenter layout">\n        <div class="head">\n            <h1>机构介绍</h1>\n            <a class="green fr more" href="org-detail-desc.html">查看更多 ### </a>\n        </div>\n        <div class="cont">&nbsp; &nbsp; {{ course_org.desc }}\n            <a href="/company/desc/22/">\n                <span class="green">[查看更多]</span>\n            </a>\n        </div>\n    </div>\n    \n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br")])]),e("ul",[e("li",[s._v("在organization的urls.py文件中，写好路由，当在机构列表页("),e("code",[s._v("org-list.html")]),s._v(")中点击任何一个机构的时候，就跳转到那个机构的详情页("),e("code",[s._v("org-detail-homepage.html")]),s._v(")")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^home/(?P<org_id>\\d+)/', OrgHomeView.as_view(), name='org_home'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("在机构列表页("),e("code",[s._v("org-list.html")]),s._v(")中，修改成这样")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<a href=\"{% url 'org:org_home' course.id %}\">\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("在views.py文件里面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 机构详情页, 机构首页处理逻辑\nclass OrgHomeView(View):\n    # 这里的org_id是点击了的机构的ID，可以通过这个ID找到对应的org记录，来获取与机构相关的课程和老师\n    def get(self,request, org_id):\n        current_page = \'home\'\n        # 拿到这条机构的记录\n        course_org = CourseOrg.objects.get(id=int(org_id))\n        # TODO：这里是Django的一个特点，如果一个 model—A 使用了外键关联另外一个 model-B，那么 model-B 就可以通过这个model的course_set.all() 拿到所有model—A属于model-B的记录\n        all_courses = course_org.course_set.all()  # 取到在org_id机构中的课程\n        all_teachers = course_org.teacher_set.all() # 取到在org_id机构中的老师\n\n        # 每次点击了机构首页的时候，机构点击数加一\n\n        course_org.click_nums += 1\n        course_org.save()\n\n        # 保持收藏在刷新的时候不变化\n        fav_status = False\n        if request.user.is_authenticated(): # 如果用户登录了\n\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(org_id), fav_type=2): # 如果已经被这个用户收藏\n                fav_status = True\n\n        return render(request, \'org-detail-homepage.html\', {\n            "all_courses": all_courses,\n            "all_teachers": all_teachers,\n            "course_org": course_org, # 这里返回的是机构的记录，不是课程的记录\n            "current_page": current_page,\n            "fav_status": fav_status, # 刷新收藏状态不变\n        })\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br")])]),e("ul",[e("li",[s._v("如果xadmin添加数据的时候，有些model访问不了，那么，可能是重载的字段需要删除")]),s._v(" "),e("li",[s._v("修改urls.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li {% ifequal current_page "home" %} class="active2" {% endifequal %}><a href="{% url \'org:org_home\' course_org.id %}">机构首页</a></li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[e("strong",[e("code",[s._v("接下来请看第三部分")])])])])])}),[],!1,null,null,null);n.default=t.exports},518:function(s,n,a){s.exports=a.p+"assets/img/2018-08-194.22.46.10b4778d.png"}}]);