(window.webpackJsonp=window.webpackJsonp||[]).push([[618],{2688:function(e,s,a){"use strict";a.r(s);var t=a(9),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("ul",[a("li",[e._v("时序数据库（1.2版本，1.4版本之后不再有web界面）")])]),e._v(" "),a("h3",{attrs:{id:"一-influxdb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-influxdb"}},[e._v("#")]),e._v(" "),a("code",[e._v("（一）influxdb")])]),e._v(" "),a("ul",[a("li",[a("p",[e._v("一定要保证influxdb服务器本地时间一定要正确，否则时间会有误")])]),e._v(" "),a("li",[a("p",[e._v("配置yum仓库")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[influxdb]\nname = InfluxDB Repository - RHEL $releasever\nbaseurl = https://repos.influxdata.com/rhel/$releasever/$basearch/stable\nenabled = 1\ngpgcheck = 1\ngpgkey = https://repos.influxdata.com/influxdb.key\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])]),a("ul",[a("li",[e._v("查看mydb数据库保留时长策略")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('show retention policies on "mydb" \n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("创建新的策略，并让新策略应用到mydb数据库，设置为默认的策略")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('create retention policy "mydb_retention" on "mydb" duration 3w replication 1 default  \n\nmydb_retention：策略名\nmydb：具体的数据库名\n3w：保存3周，3周之前的数据将被删除，influxdb具有各种事件参数，比如：h（小时），d（天），w（星期）\nreplication 1：副本个数，一般为1就可以了\ndefault：设置为默认策略\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("ul",[a("li",[e._v("修改Retention Policies")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('alter retention policy "mydb_retention" on "mydb" duration 30d default  \n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("删除Retention Policies")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('drop retention policy "mydb_retention" \n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("设置在会话级别的时间戳显示格式")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("precision rfc3339\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"二-influxdb-重要概念介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-influxdb-重要概念介绍"}},[e._v("#")]),e._v(" "),a("code",[e._v("（二）influxdb 重要概念介绍")])]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("influxdb相关名词")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("database：数据库；\nmeasurement：数据库中的表；\npoints：表里面的一行数据\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h3",{attrs:{id:"三-influxdb中独有的一些概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-influxdb中独有的一些概念"}},[e._v("#")]),e._v(" "),a("strong",[a("code",[e._v("（三）influxDB中独有的一些概念")])])]),e._v(" "),a("ul",[a("li",[a("strong",[a("code",[e._v("Point由时间戳（time）、数据（field）和标签（tags）组成")])])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("time：每条数据记录的时间，也是数据库自动生成的主索引\nfields：各种记录的值\n- **例如在下面这个**census**表中，location，scientist就是tags，( Filed与Tag的区别在于 Filed没有规律，而Tags有规律。这里的butterflies、honeybees两个字段是没有规律的，而 location、scientist有规律)，那么butterflies、honeybees为filed，location、scientist为tag**\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("name: census\n————————————\ntime                     butterflies     honeybees     location   scientist\n2015-08-18T00:00:00Z      12                23           1         langstroth\n2015-08-18T00:00:00Z      1                 30           1         perpetua\n2015-08-18T00:06:00Z      11                28           1         langstroth\n2015-08-18T00:06:00Z      3                 28           1         perpetua\n2015-08-18T05:54:00Z      2                 11           2         langstroth\n2015-08-18T06:00:00Z      1                 10           2         langstroth\n2015-08-18T06:06:00Z      8                 23           2         perpetua\n2015-08-18T06:12:00Z      7                 22           2         perpetua")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("- **`还有一个重要的名词：series`**\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("所有在数据库中的数据，都需要通过图表来表示，series表示这个表里面的所有的数据可以在图标上画成几条线（注：线条的个数由tags排列计算出来）, 上面的表中的series是 2 * 2 = 4, 那么在监控图上就可以画出四条线")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("###  **`（四）查询`**\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h1",{attrs:{id:"在grafana上-可以基于某个tag的名称-获取所有的tag值-这样就可以在grafana上展示为多个图了"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在grafana上-可以基于某个tag的名称-获取所有的tag值-这样就可以在grafana上展示为多个图了"}},[e._v("#")]),e._v(" 在grafana上，可以基于某个tag的名称，获取所有的tag值，这样就可以在grafana上展示为多个图了")]),e._v(" "),a("p",[e._v('SHOW TAG VALUES FROM "measurement_name" WITH KEY = "tag_key"')]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("###  **`（五）简单操作`**\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v('#创建数据库\ncreate database "db_name"\n#显示所有的数据库\nshow databases\n#删除数据库\ndrop database "db_name"\n#使用数据库\nuse db_name\n#显示该数据库中所有的表\nshow measurements\n#创建表，直接在插入数据的时候指定表名\ninsert test,host=127.0.0.1,monitor_name=test count=1\n#删除表\ndrop measurement "measurement_name"')]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("- **增删改查**\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h1",{attrs:{id:"通过命令行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行"}},[e._v("#")]),e._v(" 通过命令行")]),e._v(" "),a("p",[e._v("use testDb\ninsert test,host=127.0.0.1,monitor_name=test count=1")]),e._v(" "),a("h1",{attrs:{id:"通过http接口-line-protocol协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过http接口-line-protocol协议"}},[e._v("#")]),e._v(" 通过http接口, Line Protocol协议")]),e._v(" "),a("p",[e._v("curl -i -XPOST 'http://127.0.0.1:8086/write?db=testDb' --data-binary 'test,host=127.0.0.1,monitor_name=test count=1'")]),e._v(" "),a("h1",{attrs:{id:"通过命令行-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行-2"}},[e._v("#")]),e._v(" 通过命令行")]),e._v(" "),a("p",[e._v("select * from test order by time desc")]),e._v(" "),a("h1",{attrs:{id:"通过http接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过http接口"}},[e._v("#")]),e._v(" 通过http接口")]),e._v(" "),a("p",[e._v('curl -G \'http://localhost:8086/query?pretty=true\' --data-urlencode "db=testDb" --data-urlencode "q=select * from test order by time desc"')]),e._v(" "),a("p",[e._v('#创建用户\ncreate user "username" with password \'password\'\n#创建管理员权限用户\ncreate user "username" with password \'password\' with all privileges\n##删除用户\ndrop user "username"\n#显示用户'),a("br"),e._v("\nshow users")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);