(window.webpackJsonp=window.webpackJsonp||[]).push([[610],{2679:function(n,s,a){"use strict";a.r(s);var e=a(9),i=Object(e.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h3",{attrs:{id:"一-nginx并发数调优"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-nginx并发数调优"}},[n._v("#")]),n._v(" 一："),a("code",[n._v("NGINX并发数调优")])]),n._v(" "),a("h3",{attrs:{id:"一-worker连接数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-worker连接数"}},[n._v("#")]),n._v(" (一) worker连接数")]),n._v(" "),a("ul",[a("li",[n._v("在NGINX的主机上，一般请求数比较多，因此一般会把/etc/security/limits.conf文件中的nproc、nofile调整为65535，那是为什么呢")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("由于进程存储的端口号、文件句柄数是 unsigned int类型存储的，这个类型是2个字节，也就是11111111 11111111，转换为十进制就是65535\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("ul",[a("li",[n._v("在/etc/security/limits.conf文件中会配置单个用户可以打开的进程数nproc，也会配置单个进程打开的文件数nofile")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("* soft nproc 65535\n* hard nproc 65535\n* soft nofile 65535\n* hard nofile 65535\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("ul",[a("li",[n._v("如果Linux系统是Ubuntu系统，那么需要指定root用户才能生效")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("* soft nproc 65535\n* hard nproc 65535\n* soft nofile 65535\n* hard nofile 65535\nroot soft nproc 65535\nroot hard nproc 65535\nroot soft nofile 65535\nroot hard nofile 65535\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br")])]),a("ul",[a("li",[n._v("在NGINX主机上，会把worker_processes、worker_connections进行调整")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("# 启动的worker数, 如果是2个CPU单线程\nworker_processes 2;\nevents {\n\t# 单个worker可以处理的请求数\n    worker_connections 65535;\n}\n# 单个worker进程运行打开的文件数，这个参数会覆盖/etc/security/limits.conf配置的nofile参数\nworker_rlimit_nofile 65535;\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br")])]),a("ul",[a("li",[n._v("查看进程的limits数")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("cat /proc/19614/limits\nLimit                     Soft Limit           Hard Limit           Units     \nMax cpu time              unlimited            unlimited            seconds   \nMax file size             unlimited            unlimited            bytes     \nMax data size             unlimited            unlimited            bytes     \nMax stack size            8388608              unlimited            bytes     \nMax core file size        0                    unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax processes             15077                15077                processes \n# 最大文件数\nMax open files            65535                65535                files     \nMax locked memory         65536                65536                bytes     \nMax address space         unlimited            unlimited            bytes     \nMax file locks            unlimited            unlimited            locks     \nMax pending signals       15077                15077                signals   \nMax msgqueue size         819200               819200               bytes     \nMax nice priority         0                    0                    \nMax realtime priority     0                    0                    \nMax realtime timeout      unlimited            unlimited            us\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("h3",{attrs:{id:"二-proc-伪文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-proc-伪文件系统"}},[n._v("#")]),n._v(" 二："),a("code",[n._v("/proc/伪文件系统")])]),n._v(" "),a("ul",[a("li",[n._v("1：/proc目录中包含许多以数字命名的子目录, 这些数字都是一个进程，进入这个进程中可以看到如下信息")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("1: cmdline:启动当前进程的完整命令，但僵尸进程目录中的此文件不包含任何信息\ncat cmdline \nnginx: worker process\n\n2: cwd: 这是一个目录，指向当前进程运行的root目录\nll cwd\nlrwxrwxrwx 1 nginx nginx 0 Mar 22 13:35 cwd -### /\n\n3: environ: 当前进程的环境变量列表，彼此间用空字符（NULL）隔开；变量用大写字母表示，其值用小写字母表示\ncat environ\nocess\n\n4: exe: 指向启动当前进程的可执行文件（完整路径）的符号链接，通过/proc/N/exe可以启动当前进程的一个拷贝\nll exe \nlrwxrwxrwx 1 nginx nginx 0 Mar 22 13:35 exe -### /usr/sbin/nginx\n\n5：fd：这是个目录，包含当前进程打开的每一个文件的文件描述符（file descriptor），这些文件描述符是指向实际文件的一个符号链接, 一个进程中多个线程打开的文件显示一个文件链接\nll fd\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 0 -### /dev/null\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 1 -### /dev/null\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 10 -### socket:[16617852]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 11 -### socket:[16617853]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 12 -### socket:[16617854]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 13 -### socket:[16617855]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 14 -### socket:[16617856]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 15 -### socket:[19142834]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 16 -### socket:[17494537]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 17 -### socket:[19142839]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 18 -### socket:[17494539]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 19 -### socket:[19338667]\nl-wx------ 1 nginx nginx 64 Mar 22 15:33 2 -### /var/log/nginx/error.log\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 20 -### socket:[17494541]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 21 -### socket:[19336514]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 22 -### socket:[17494543]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 23 -### socket:[19339892]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 24 -### socket:[19068360]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 25 -### socket:[19339680]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 26 -### socket:[19265232]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 27 -### socket:[19337342]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 28 -### socket:[19068364]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 29 -### socket:[19337147]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 3 -### socket:[19338965]\nl-wx------ 1 nginx nginx 64 Mar 22 15:33 30 -### /var/log/nginx/error.log\nl-wx------ 1 nginx nginx 64 Mar 22 15:33 31 -### /var/log/nginx/access.log\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 32 -### anon_inode:[eventpoll]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 33 -### anon_inode:[eventfd]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 34 -### anon_inode:[eventfd]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 35 -### socket:[19339767]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 36 -### socket:[19311135]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 37 -### socket:[19265234]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 38 -### socket:[19338785]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 39 -### socket:[19335290]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 4 -### socket:[19142835]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 40 -### socket:[19338669]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 42 -### socket:[19339718]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 43 -### socket:[19337152]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 45 -### socket:[19333177]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 46 -### socket:[19333887]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 47 -### socket:[19340168]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 49 -### socket:[19339976]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 5 -### socket:[19142837]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 52 -### socket:[19335855]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 53 -### socket:[19335787]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 54 -### socket:[19334758]\nlrwx------ 1 nginx nginx 64 Mar 22 15:36 56 -### socket:[19340045]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 6 -### socket:[16617848]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 7 -### socket:[16617849]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 8 -### socket:[16617850]\nlrwx------ 1 nginx nginx 64 Mar 22 15:33 9 -### socket:[16617851]\n\n6: limits: 当前进程所使用的每一个受限资源的软限制、硬限制和管理单元；此文件仅可由实际启动当前进程的UID用户读取\ncat limits \nLimit                     Soft Limit           Hard Limit           Units     \nMax cpu time              unlimited            unlimited            seconds   \nMax file size             unlimited            unlimited            bytes     \nMax data size             unlimited            unlimited            bytes     \nMax stack size            8388608              unlimited            bytes     \nMax core file size        0                    unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax processes             15077                15077                processes \nMax open files            65535                65535                files     \nMax locked memory         65536                65536                bytes     \nMax address space         unlimited            unlimited            bytes     \nMax file locks            unlimited            unlimited            locks     \nMax pending signals       15077                15077                signals   \nMax msgqueue size         819200               819200               bytes     \nMax nice priority         0                    0                    \nMax realtime priority     0                    0                    \nMax realtime timeout      unlimited            unlimited            us \n\n7:maps:当前进程关联到的每个可执行文件和库文件在内存中的映射区域及其访问权限所组成的列表\n\n8:mem: 二级制文件，当前进程所占用的内存空间，由open、read和lseek等系统调用使用，不能被用户读取\n\n9：root：指向当前进程运行根目录的符号链接；在Unix和Linux系统上，通常采用chroot命令使每个进程运行于独立的根目录\nll root\nlrwxrwxrwx 1 nginx nginx 0 Mar 22 15:29 root -### /\n\n10：stat：当前进程的状态信息，包含一系统格式化后的数据列，可读性差，通常由ps命令使用；\ncat stat\n19614 (nginx) S 26916 26916 26916 0 -1 4202816 8092 0 0 0 1266 929 0 0 20 0 1 0 285488994 154923008 8651 18446744073709551615 93963000070144 93963001149356 140733539771216 140733539769432 139692433768003 0 0 1073746048 469854727 18446744071581251950 0 0 17 0 0 0 0 0 0 93963003247208 93963003362624 93963014352896 140733539778448 140733539778464 140733539778464 140733539778536 0\n\n11: statm:当前进程占用内存的状态信息，通常以“页面”（page）表示\ncat statm\n37823 8651 647 264 0 8063 0\n\n12: status: 与stat所提供信息类似，但可读性较好，如下所示，每行表示一个属性信息\ncat status\n\n13: task: 目录文件，包含由当前进程所运行的每一个线程的相关信息，每个线程的相关信息文件均保存在一个由线程号（tid）命名的目录中，这类似于其内容类似于每个进程目录中的内容；\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br"),a("span",{staticClass:"line-number"},[n._v("65")]),a("br"),a("span",{staticClass:"line-number"},[n._v("66")]),a("br"),a("span",{staticClass:"line-number"},[n._v("67")]),a("br"),a("span",{staticClass:"line-number"},[n._v("68")]),a("br"),a("span",{staticClass:"line-number"},[n._v("69")]),a("br"),a("span",{staticClass:"line-number"},[n._v("70")]),a("br"),a("span",{staticClass:"line-number"},[n._v("71")]),a("br"),a("span",{staticClass:"line-number"},[n._v("72")]),a("br"),a("span",{staticClass:"line-number"},[n._v("73")]),a("br"),a("span",{staticClass:"line-number"},[n._v("74")]),a("br"),a("span",{staticClass:"line-number"},[n._v("75")]),a("br"),a("span",{staticClass:"line-number"},[n._v("76")]),a("br"),a("span",{staticClass:"line-number"},[n._v("77")]),a("br"),a("span",{staticClass:"line-number"},[n._v("78")]),a("br"),a("span",{staticClass:"line-number"},[n._v("79")]),a("br"),a("span",{staticClass:"line-number"},[n._v("80")]),a("br"),a("span",{staticClass:"line-number"},[n._v("81")]),a("br"),a("span",{staticClass:"line-number"},[n._v("82")]),a("br"),a("span",{staticClass:"line-number"},[n._v("83")]),a("br"),a("span",{staticClass:"line-number"},[n._v("84")]),a("br"),a("span",{staticClass:"line-number"},[n._v("85")]),a("br"),a("span",{staticClass:"line-number"},[n._v("86")]),a("br"),a("span",{staticClass:"line-number"},[n._v("87")]),a("br"),a("span",{staticClass:"line-number"},[n._v("88")]),a("br"),a("span",{staticClass:"line-number"},[n._v("89")]),a("br"),a("span",{staticClass:"line-number"},[n._v("90")]),a("br"),a("span",{staticClass:"line-number"},[n._v("91")]),a("br"),a("span",{staticClass:"line-number"},[n._v("92")]),a("br"),a("span",{staticClass:"line-number"},[n._v("93")]),a("br"),a("span",{staticClass:"line-number"},[n._v("94")]),a("br"),a("span",{staticClass:"line-number"},[n._v("95")]),a("br"),a("span",{staticClass:"line-number"},[n._v("96")]),a("br"),a("span",{staticClass:"line-number"},[n._v("97")]),a("br"),a("span",{staticClass:"line-number"},[n._v("98")]),a("br"),a("span",{staticClass:"line-number"},[n._v("99")]),a("br"),a("span",{staticClass:"line-number"},[n._v("100")]),a("br"),a("span",{staticClass:"line-number"},[n._v("101")]),a("br"),a("span",{staticClass:"line-number"},[n._v("102")]),a("br"),a("span",{staticClass:"line-number"},[n._v("103")]),a("br"),a("span",{staticClass:"line-number"},[n._v("104")]),a("br"),a("span",{staticClass:"line-number"},[n._v("105")]),a("br"),a("span",{staticClass:"line-number"},[n._v("106")]),a("br"),a("span",{staticClass:"line-number"},[n._v("107")]),a("br"),a("span",{staticClass:"line-number"},[n._v("108")]),a("br"),a("span",{staticClass:"line-number"},[n._v("109")]),a("br"),a("span",{staticClass:"line-number"},[n._v("110")]),a("br")])]),a("ul",[a("li",[n._v("2：/proc的只读其他目录")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("/proc/apm： 高级电源管理（APM）版本信息及电池相关状态信息，通常由apm命令使用；\n/proc/buddyinfo： 用于诊断内存碎片问题的相关信息文件\n/proc/cmdline：在启动时传递至内核的相关参数信息，这些信息通常由lilo或grub等启动管理工具进行传递；\n/proc/cpuinfo：处理器的相关信息的文件\n/proc/crypto：系统上已安装的内核使用的密码算法及每个算法的详细信息列表；\n/proc/devices：系统已经加载的所有块设备和字符设备的信息，包含主设备号和设备组（与主设备号对应的设备类型）名；\n/proc/diskstats：每块磁盘设备的磁盘I/O统计信息列表\n/proc/dma：每个正在使用且注册的ISA DMA通道的信息列表；\n/proc/execdomains：内核当前支持的执行域（每种操作系统独特“个性”）信息列表；\n/proc/fb：帧缓冲设备列表文件，包含帧缓冲设备的设备号和相关驱动信息；\n/proc/filesystems：当前被内核支持的文件系统类型列表文件，被标示为nodev的文件系统表示不需要块设备的支持；通常mount一个设备时，如果没有指定文件系统类型将通过此文件来决定其所需文件系统的类型；\n/proc/interrupts：X86或X86_64体系架构系统上每个IRQ相关的中断号列表；多路处理器平台上每个CPU对于每个I/O设备均有自己的中断号；\n/proc/iomem：每个物理设备上的记忆体（RAM或者ROM）在系统内存中的映射信息；\n/proc/ioports：当前正在使用且已经注册过的与物理设备进行通讯的输入-输出端口范围信息列表；如下面所示，第一列表示注册的I/O端口范围，其后表示相关的设备；\n/proc/kallsyms：模块管理工具用来动态链接或绑定可装载模块的符号定义，由内核输出\n/proc/kcore：系统使用的物理内存，以ELF核心文件（core file）格式存储，其文件大小为已使用的物理内存（RAM）加上4KB；这个文件用来检查内核数据结构的当前状态，因此，通常由GBD通常调试工具使用，但不能使用文件查看命令打开此文件；\n/proc/kmsg：此文件用来保存由内核输出的信息，通常由/sbin/klogd或/bin/dmsg等程序使用，不要试图使用查看命令打开此文件；\n/proc/loadavg：保存关于CPU和磁盘I/O的负载平均值，其前三列分别表示每1秒钟、每5秒钟及每15秒的负载平均值，类似于uptime命令输出的相关信息；第四列是由斜线隔开的两个数值，前者表示当前正由内核调度的实体（进程和线程）的数目，后者表示系统当前存活的内核调度实体的数目；第五列表示此文件被查看前最近一个由内核创建的进程的PID；\n/proc/locks：保存当前由内核锁定的文件的相关信息，包含内核内部的调试数据；每个锁定占据一行，且具有一个惟一的编号；如下输出信息中每行的第二列表示当前锁定使用的锁定类别，POSIX表示目前较新类型的文件锁，由lockf系统调用产生，FLOCK是传统的UNIX文件锁，由flock系统调用产生；第三列也通常由两种类型，ADVISORY表示不允许其他用户锁定此文件，但允许读取，MANDATORY表示此文件锁定期间不允许其他用户任何形式的访问；\n/proc/mdstat：保存RAID相关的多块磁盘的当前状态信息，在没有使用RAID机器上，其显示为如下状态：\n/proc/meminfo:系统中关于当前内存的利用状况等的信息，常由free命令使用；可以使用文件查看命令直接读取此文件，其内容显示为两列，前者为统计属性，后者为对应的值；\n/proc/mounts:在内核2.4.29版本以前，此文件的内容为系统当前挂载的所有文件系统，在2.4.19以后的内核中引进了每个进程使用独立挂载名称空间的方式，此文件则随之变成了指向/proc/self/mounts（每个进程自身挂载名称空间中的所有挂载点列表）文件的符号链接；/proc/self是一个独特的目录，后文中会对此目录进行介绍；\n/proc/modules:当前装入内核的所有模块名称列表，可以由lsmod命令使用，也可以直接查看；如下所示，其中第一列表示模块名，第二列表示此模块占用内存空间大小，第三列表示此模块有多少实例被装入，第四列表示此模块依赖于其它哪些模块，第五列表示此模块的装载状态（Live：已经装入；Loading：正在装入；Unloading：正在卸载），第六列表示此模块在内核内存（kernel memory）中的偏移量；\n/proc/partitions:块设备每个分区的主设备号（major）和次设备号（minor）等信息，同时包括每个分区所包含的块（block）数目（如下面输出中第三列所示）；\n/proc/pci:内核初始化时发现的所有PCI设备及其配置信息列表，其配置信息多为某PCI设备相关IRQ信息，可读性不高，可以用“/sbin/lspci –vb”命令获得较易理解的相关信息；在2.6内核以后，此文件已为/proc/bus/pci目录及其下的文件代替；\n/proc/slabinfo:在内核中频繁使用的对象（如inode、dentry等）都有自己的cache，即slab pool，而/proc/slabinfo文件列出了这些对象相关slap的信息；详情可以参见内核文档中slapinfo的手册页；\n/proc/swaps:当前系统上的交换分区及其空间利用信息，如果有多个交换分区的话，则会每个交换分区的信息分别存储于/proc/swap目录中的单独文件中，而其优先级数字越低，被使用到的可能性越大；下面是作者系统中只有一个交换分区时的输出信息；\n/proc/uptime:系统上次启动以来的运行时间，如下所示，其第一个数字表示系统运行时间，第二个数字表示系统空闲时间，单位是秒；\n/proc/version:当前系统运行的内核版本号，在作者的RHEL5.3上还会显示系统安装的gcc版本，如下所示；\n/proc/vmstat:当前系统虚拟内存的多种统计数据，信息量可能会比较大，这因系统而有所不同，可读性较好；下面为作者机器上输出信息的一个片段；（2.6以后的内核支持此文件）\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br")])]),a("ul",[a("li",[n._v("3：/proc/sys/可写目录")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("管理员可对/proc/sys子目录中的许多文件内容进行修改以更改内核的运行特性，事先可以使用“ls -l”命令查看某文件是否“可写入”。写入操作通常使用类似于“echo  DATA ### /path/to/your/filename”的格式进行。需要注意的是，即使文件可写，其一般也不可以使用编辑器进行编辑\n\n\n例如修改：/proc/sys/net/ipv4/tcp_mem 文件的值\n这些参数都可以在/etc/sysctl.conf 中修改，修改保存后调用 sysctl -p 加载新配置，永久生效\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("h3",{attrs:{id:"三-进程打开的文件数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-进程打开的文件数"}},[n._v("#")]),n._v(" 三："),a("code",[n._v("进程打开的文件数")])]),n._v(" "),a("ul",[a("li",[n._v("lsof显示的进程打开文件数与/proc/PID/fd/目录下的文件句柄数不一样")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("由于lsof显示打开的文件数包括线程打开的文件数\n而/proc/PID/fd/下的文件数是进程的文件数\n\n因此 lsof显示打开的文件数 ### /proc/PID/fd/下的文件数\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("ul",[a("li",[n._v("lsof可以查看打开文件数最多的前10个进程")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("# 第一列是单个进程打开文件数的个数，第二列是进程的pid(pid为13050的进程打开了576个文件)\nlsof | awk '{print $2}' | uniq -c | sort -rnk1 | head\n    576 13050\n    455 8612\n    371 8581\n    267 751\n    132 8381\n    130 380\n    120 19615\n    114 19617\n    107 19614\n    106 19616\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br")])])])}),[],!1,null,null,null);s.default=i.exports}}]);