(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{1833:function(s,n,e){s.exports=e.p+"assets/img/2019-09-1811.21.15.5cb4d082.png"},1834:function(s,n,e){s.exports=e.p+"assets/img/2019-09-191.00.02.6a4f078a.png"},2721:function(s,n,e){"use strict";e.r(n);var a=e(9),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一-k8s-dashboard附件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-k8s-dashboard附件"}},[s._v("#")]),s._v(" 一：K8S Dashboard附件")]),s._v(" "),a("h3",{attrs:{id:"一-创建dashboard-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-创建dashboard-pod"}},[s._v("#")]),s._v(" "),a("code",[s._v("(一)创建Dashboard pod")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 会报错\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n\n\n# 先下载yaml\nwget https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n\n# 修改镜像仓库地址为阿里云地址\nimage: registry.cn-hangzhou.aliyuncs.com/google_containers/kubernetes-dashboard-amd64:v1.10.1\n\n# 创建pod\nkubectl apply -f kubernetes-dashboard.yaml\n\n\n# 查看pod\nkubectl get pods -n kube-system\nNAME                                    READY   STATUS    RESTARTS   AGE\nkubernetes-dashboard-86844cc55f-7gg48   1/1     Running   0          3m1s\n\n# 查看service地址\nkubectl get svc -n kube-system\nNAME                   TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)                  AGE\nkube-dns               ClusterIP   10.1.0.10     <none###        53/UDP,53/TCP,9153/TCP   8d\nkubernetes-dashboard   ClusterIP   10.1.151.26   <none###        443/TCP                  4m18s\n\n# 让这个ClusterIP的service为NodePort\nkubectl patch svc kubernetes-dashboard -p \'{"spec":{"type":"NodePort"}}\' -n kube-system\n\n# 再次查看发现绑定在节点的30738端口\n[root@master dashboard]# kubectl get svc -n kube-system\nNAME                   TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)                  AGE\nkube-dns               ClusterIP   10.1.0.10     <none###        53/UDP,53/TCP,9153/TCP   8d\nkubernetes-dashboard   NodePort    10.1.151.26   <none###        443:30738/TCP            6m53s\n\n# 这里也可以先把阿里云镜像脱下来\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("ul",[a("li",[s._v("访问https://192.168.43.201:30738")])]),s._v(" "),a("p",[a("img",{attrs:{src:e(1833),alt:"Alt text"}})]),s._v(" "),a("ul",[a("li",[s._v("这里因为dashboard是一个pod，所以认证的config必须是一个pod的serviceaccount，那么pod要想访问apiserver, 必须是serviceaccount认证才行")])]),s._v(" "),a("h3",{attrs:{id:"二-做token认证-登录dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-做token认证-登录dashboard"}},[s._v("#")]),s._v(" "),a("code",[s._v("(二)做token认证，登录dashboard")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 1:创建一个serviceaccount\nkubectl create serviceaccount dashboard-admin -n kube-system\n\n# 2:给serviceaccount进行角色绑定, 绑定角色的时候，kube-system:dashboard-admin中kube-system表示名称空间，dashboard-admin表示serviceaccount\nkubectl create clusterrolebinding dashboard-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:dashboard-admin  \n\n# 3:查看dashboard-admin的secret\nkubectl get secret -n kube-system | grep dashboard-admin\ndashboard-admin-token-7xh2j                      kubernetes.io/service-account-token   3      8m29s\n\n# 4:基于dashboard-admin-token-7xh2j这个secret，查看token\nkubectl describe secret dashboard-admin-token-7xh2j  -n kube-system\nName:         dashboard-admin-token-7xh2j\nNamespace:    kube-system\nLabels:       <none>\nAnnotations:  kubernetes.io/service-account.name: dashboard-admin\n              kubernetes.io/service-account.uid: 186ac702-045b-4922-ae05-2dd1b291439e\n\nType:  kubernetes.io/service-account-token\n\nData\n====\ntoken:      eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tN3hoMmoiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMTg2YWM3MDItMDQ1Yi00OTIyLWFlMDUtMmRkMWIyOTE0MzllIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.gEzB9H_aL7A2v_9r4HM6PzBk0wquS2golei2a3SMIsqFyoAzm-j2DpE5n7oyC4B2qdycmdG6dMv5HvhFn7CnFbhOA69gx0M3V72pNg4od1b18AnGe3RM41S6_SNyMNccRwnGlAv2nhwBQnRAe5Ziqbmy3syzGb6YAOv2O9lBsYeD2bOfknEs6ZxNXea6SNR1ZPklbwdF6_hYb6-bK5ONARzDedOdQRM5LduldR6TqgvgPS-nOtcPTtX0_nKsIRwbhASiDh5Kp8_UKWChpJYJKa4s2nEmx3AUQ5v8tC5283ngbiMr7ov7MeA00j72NOpRef3xYiLd9iH6GYFNpTWcDA\nca.crt:     1025 bytes\nnamespace:  11 bytes\n\n# 这个token就是当前这个serviceaccount的token\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[a("img",{attrs:{src:e(526),alt:"Alt text"}})]),s._v(" "),a("h3",{attrs:{id:"三-给token授权较小的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-给token授权较小的权限"}},[s._v("#")]),s._v(" "),a("code",[s._v("(三)给token授权较小的权限")])]),s._v(" "),a("ul",[a("li",[s._v("创建一个权限较小的token认证")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 创建一个serviceaccount，在default名称空间\nkubectl create serviceaccount default-namespace-admin -n default\n\n# 创建一个binding，让default-namespace-admin在default名称空间具有admin权限\nkubectl create rolebinding default-ns-admin --clusterrole=admin --serviceaccount=default:default-namespace-admin\n\n# 查看secret， default-namespace-admin-token-8z4df就是权限较小的secret\nkubectl get secret\nNAME                                  TYPE                                  DATA   AGE\ndefault-namespace-admin-token-8z4df   kubernetes.io/service-account-token   3      3m30s\ndefault-token-h2pql                   kubernetes.io/service-account-token   3      8d\nmysa-token-4b54b                      kubernetes.io/service-account-token   3      8h\nmysql-root-password                   Opaque                                1      12h\ntomcat-ingress-secret                 kubernetes.io/tls                     2      2d23h\n\n# 查看token\nkubectl describe secret default-namespace-admin-token-8z4df\nName:         default-namespace-admin-token-8z4df\nNamespace:    default\nLabels:       <none>\nAnnotations:  kubernetes.io/service-account.name: default-namespace-admin\n              kubernetes.io/service-account.uid: 81b6286b-a695-4b8c-b930-fa433d4fed4d\n\nType:  kubernetes.io/service-account-token\n\nData\n====\nca.crt:     1025 bytes\nnamespace:  7 bytes\ntoken:      eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluLXRva2VuLTh6NGRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiODFiNjI4NmItYTY5NS00YjhjLWI5MzAtZmE0MzNkNGZlZDRkIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6ZGVmYXVsdC1uYW1lc3BhY2UtYWRtaW4ifQ.ilJuJbsDFF25nDxQAuwEUsnNc1JAH9ODXVUn1BjJmTM2YzjamGNXUqyiihtQxJi_X2Ev_OUK9NrdMs8RdgSg3eo-XzLDSMHJqkaw9LpXOp3KjX5KqxW-Jdq7Ws-KJnn4oODfuUFwpBaO_QbVNO2qGwSQjEBEHAdtRndkJKu_7tLniXhOdh6T02A0NjhxLUvwObbBaXEbPil38oiLVtKJjavhqL0zPyM48clkeIjpE-h82Fe50DnYo4vG128cjFtFTi-koodhj1cYg0nbPXN_8xgl74na_H6eU_T4Gz37L9mOmJo3oRoM2p1wsezhe5JiMvtH5T1tkSrF-478rXWCuw\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("ul",[a("li",[s._v("此时这个用户只具备在default名称空间的管理权限")])]),s._v(" "),a("p",[a("img",{attrs:{src:e(526),alt:"Alt text"}})]),s._v(" "),a("h3",{attrs:{id:"四-做kubeconfig认证-登录dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-做kubeconfig认证-登录dashboard"}},[s._v("#")]),s._v(" "),a("code",[s._v("(四)做kubeconfig认证，登录dashboard")])]),s._v(" "),a("ul",[a("li",[s._v("给dashboard创建一个专用的证书")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 创建私有\ncd /etc/kubernetes/pki/\n(umask 077; openssl genrsa -out dashboard.key 2048)\n\n# 创建签署请求，CN一定要与访问dashboard的域名一致\nopenssl req -new -key dashboard.key -out dashboard.csr -subj "/O=hut_group/CN=www.dashboard.com"\n\n# 签署证书\nopenssl x509 -req -in dashboard.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out dashboard.crt -days 365\n\n# 将私钥和证书创建为一个dashboard-cert 的secret\nkubectl create secret generic dashboard-cert -n kube-system --from-file=dashboard.crt=./dashboard.crt --from-file=dashboard.key=./dashboard.key \n\n# 创建config文件, 先创建cluster， 将config文件保存到其他路径下，这样就不会覆盖之前的config认证文件\nkubectl config set-cluster kubernetes --certificate-authority=./ca.crt --server="https://192.168.43.201:6443" --embed-certs=true --kubeconfig=/root/default-ns-admin.conf\n\n# 获取json格式的default-namespace-admin-token-8z4df的token\nkubectl get secret default-namespace-admin-token-8z4df -o jsonpath={.data.token} | base64 -d\neyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluLXRva2VuLTh6NGRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiODFiNjI4NmItYTY5NS00YjhjLWI5MzAtZmE0MzNkNGZlZDRkIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6ZGVmYXVsdC1uYW1lc3BhY2UtYWRtaW4ifQ.ilJuJbsDFF25nDxQAuwEUsnNc1JAH9ODXVUn1BjJmTM2YzjamGNXUqyiihtQxJi_X2Ev_OUK9NrdMs8RdgSg3eo-XzLDSMHJqkaw9LpXOp3KjX5KqxW-Jdq7Ws-KJnn4oODfuUFwpBaO_QbVNO2qGwSQjEBEHAdtRndkJKu_7tLniXhOdh6T02A0NjhxLUvwObbBaXEbPil38oiLVtKJjavhqL0zPyM48clkeIjpE-h82Fe50DnYo4vG128cjFtFTi-koodhj1cYg0nbPXN_8xgl74na_H6eU_T4Gz37L9mOmJo3oRoM2p1wsezhe5JiMvtH5T1tkSrF-478rXWCuw\n\n# 使用token来指定config文件中的user\nkubectl config set-credentials def-ns-admin --token=eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluLXRva2VuLTh6NGRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiODFiNjI4NmItYTY5NS00YjhjLWI5MzAtZmE0MzNkNGZlZDRkIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6ZGVmYXVsdC1uYW1lc3BhY2UtYWRtaW4ifQ.ilJuJbsDFF25nDxQAuwEUsnNc1JAH9ODXVUn1BjJmTM2YzjamGNXUqyiihtQxJi_X2Ev_OUK9NrdMs8RdgSg3eo-XzLDSMHJqkaw9LpXOp3KjX5KqxW-Jdq7Ws-KJnn4oODfuUFwpBaO_QbVNO2qGwSQjEBEHAdtRndkJKu_7tLniXhOdh6T02A0NjhxLUvwObbBaXEbPil38oiLVtKJjavhqL0zPyM48clkeIjpE-h82Fe50DnYo4vG128cjFtFTi-koodhj1cYg0nbPXN_8xgl74na_H6eU_T4Gz37L9mOmJo3oRoM2p1wsezhe5JiMvtH5T1tkSrF-478rXWCuw --kubeconfig=/root/default-ns-admin.conf\n\n# 再次查看config文件, cluster和user的配置已经添加完毕， 当然这里的user也可以使用kubectl创建，不使用token创建\n\n\n# 添加context上下文配置\nkubectl config set-context def-nf-admin@kubernetes  --cluster=kubernetes  --user=def-ns-admin --kubeconfig=/root/default-ns-admin.conf\n\n# 此时已经创建config完毕，那么就可以切换到对应的context中了\nkubectl config use-context "def-nf-admin@kubernetes"  --kubeconfig=/root/default-ns-admin.conf\n\n# 再次查看config文件信息，发现context已经切换\nkubectl config view --kubeconfig=/root/default-ns-admin.conf \napiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: DATA+OMITTED\n    server: https://192.168.43.201:6443\n  name: kubernetes\ncontexts:\n- context:\n    cluster: kubernetes\n    user: def-ns-admin\n  name: def-nf-admin@kubernetes\ncurrent-context: def-nf-admin@kubernetes\nkind: Config\npreferences: {}\nusers:\n- name: def-ns-admin\n  user:\n    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluLXRva2VuLTh6NGRmIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQtbmFtZXNwYWNlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiODFiNjI4NmItYTY5NS00YjhjLWI5MzAtZmE0MzNkNGZlZDRkIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6ZGVmYXVsdC1uYW1lc3BhY2UtYWRtaW4ifQ.ilJuJbsDFF25nDxQAuwEUsnNc1JAH9ODXVUn1BjJmTM2YzjamGNXUqyiihtQxJi_X2Ev_OUK9NrdMs8RdgSg3eo-XzLDSMHJqkaw9LpXOp3KjX5KqxW-Jdq7Ws-KJnn4oODfuUFwpBaO_QbVNO2qGwSQjEBEHAdtRndkJKu_7tLniXhOdh6T02A0NjhxLUvwObbBaXEbPil38oiLVtKJjavhqL0zPyM48clkeIjpE-h82Fe50DnYo4vG128cjFtFTi-koodhj1cYg0nbPXN_8xgl74na_H6eU_T4Gz37L9mOmJo3oRoM2p1wsezhe5JiMvtH5T1tkSrF-478rXWCuw\n\n# 把这个config文件/root/default-ns-admin.conf拷贝到Mac电脑\n\n# 在浏览器加载这个config文件即可\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])]),a("p",[a("img",{attrs:{src:e(1834),alt:"Alt text"}})]),s._v(" "),a("h3",{attrs:{id:"五-小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-小结"}},[s._v("#")]),s._v(" "),a("code",[s._v("(五)小结")])]),s._v(" "),a("ul",[a("li",[s._v("dashboard pod认证")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("认证时候的账号必须是ServiceAccount: 被dashboard pod拿来由kubernetes进行认证\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("kubernetes的集群管理方式（三种方式不用混合使用)")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1: 命令行  kubectl create , kubectl run,  kubectl export,kubectl delete，kubectl edit \n2：命令行 + 配置文件： kubectl create -f FILE, kubectl delete -f FILE, kubectl replace -f FILE\n3：申明式配置文件：kubectl apply -f YAML_FILE, patch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports},526:function(s,n,e){s.exports=e.p+"assets/img/2019-09-1912.08.02.bc87ff17.png"}}]);