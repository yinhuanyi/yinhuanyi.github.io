(window.webpackJsonp=window.webpackJsonp||[]).push([[448],{2367:function(s,e,a){"use strict";a.r(e);var n=a(9),t=Object(n.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一-scrapy的item数据model保存到数据库中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-scrapy的item数据model保存到数据库中"}},[s._v("#")]),s._v(" 一：Scrapy的item数据model保存到数据库中")]),s._v(" "),a("h3",{attrs:{id:"一-在本地搭建-mysql-数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-在本地搭建-mysql-数据库"}},[s._v("#")]),s._v(" （一）：在本地搭建（MySQL）数据库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 创建数据库\ncreate database item_database;\nset global validate_password_length = 1;\nset global validate_password_policy = 0;\ngrant all on item_database.* to 'xkd'@'%' identified by '123456';\nflush privileges;\n\n# 根据item创建数据表\ncreate table item (title varchar(255) not null, image_url varchar(255) not null, date date not null, image_path varchar(255) not null, url varchar(255) not null, url_id char(50) not null primary key);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"二-安装python-mysql驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-安装python-mysql驱动"}},[s._v("#")]),s._v(" （二）：安装Python MySQL驱动")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pip install mysqlclient\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"三-新建pipeline-写入item到mysql中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-新建pipeline-写入item到mysql中"}},[s._v("#")]),s._v(" （三）：新建pipeline，写入item到MySQL中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("class MysqlPipeline:\n    def __init__(self):\n        self.conn = MySQLdb.connect(host='localhost', user='xkd', password='123456', database='item_database', use_unicode=True, charset='utf8')\n        self.cursor = self.conn.cursor()\n\n    def process_item(self, item, spider):\n        sql = 'insert into item(title, image_url, date, image_path, url, url_id)' \\\n              'values (%s, %s, %s, %s, %s, %s)'\n        date = item['date']\n\n        self.cursor.execute(sql, args=(item['title'], item['image_url'], date.strftime('%y-%m-%d'), item['image_path'], item['url'], item['url_id']))\n\n        self.conn.commit()\n        return item\n\n    def spider_closed(self, spider):\n        self.cursor.close()\n        self.conn.close()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h3",{attrs:{id:"四-在settings文件中修改pipeline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-在settings文件中修改pipeline"}},[s._v("#")]),s._v(" （四）：在settings文件中修改pipeline")]),s._v(" "),a("ul",[a("li",[s._v("相关配置")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ITEM_PIPELINES = {\n   # 'XKD_Dribbble_Spider.pipelines.XkdDribbbleSpiderPipeline': 300,\n\n   # 当items.py模块yield之后，默认就是下载image_url的页面\n   'XKD_Dribbble_Spider.pipelines.ImagePipeline': 1,\n   'XKD_Dribbble_Spider.pipelines.MysqlPipeline': 2,\n\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);