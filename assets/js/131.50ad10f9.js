(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{1545:function(s,a,n){s.exports=n.p+"assets/img/spark4782.efa00575.png"},1546:function(s,a,n){s.exports=n.p+"assets/img/2019-08-282.51.23.076c65fe.png"},1547:function(s,a,n){s.exports=n.p+"assets/img/2019-08-283.12.06.dec18fc2.png"},1548:function(s,a,n){s.exports=n.p+"assets/img/2019-08-283.14.32.c1b94d1c.png"},2582:function(s,a,n){"use strict";n.r(a);var t=n(9),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一-standalone模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-standalone模式"}},[s._v("#")]),s._v(" 一：Standalone模式")]),s._v(" "),t("h3",{attrs:{id:"一-概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-概念"}},[s._v("#")]),s._v(" (一)概念")]),s._v(" "),t("p",[t("img",{attrs:{src:n(1545),alt:"Alt text"}})]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Cluster manager是主节点, Worker node是从节点\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"二-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-配置"}},[s._v("#")]),s._v(" (二)配置")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1：配置slave节点, slave节点可以配置到多台主机上\nvi /opt/modules/spark-2.2.0-bin-custom-spark/conf/slaves\nnode3\n\n2: 配置spark-env\nvi /opt/modules/spark-2.2.0-bin-custom-spark/conf/spark-env.sh\nJAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.222.b10-0.el7_6.x86_64\nSCALA_HOME=/opt/modules/scala-2.11.8\nSPARK_CONF_DIR=/opt/modules/spark-2.2.0-bin-custom-spark/conf\nSPARK_MASTER_HOST=node3\nSPARK_MASTER_PORT=7077\nSPARK_MASTER_WEBUI_PORT=8080\nSPARK_WORKER_CORES=1\nSPARK_WORKER_MEMORY=1g\nSPARK_WORKER_PORT=7078\nSPARK_WORKER_WEBUI_PORT=8081\nHADOOP_CONF_DIR=/opt/modules/hadoop-2.5.0-cdh5.3.5/etc/hadoop\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"三-启动standalone模式-内存必须足够大-内存过小则worker无法分配资源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-启动standalone模式-内存必须足够大-内存过小则worker无法分配资源"}},[s._v("#")]),s._v(" "),t("code",[s._v("(三)启动standalone模式")]),s._v("(内存必须足够大， 内存过小则worker无法分配资源)")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('1: 启动服务\ncd /opt/modules/spark-2.2.0-bin-custom-spark/sbin\n./start-all.sh\n\n2: 查看进程\njps\nMaster\nWorker\n\n3: 访问监控页面\nhttp://node3:8080/\n\n4： 使用客户端登录到spark, 每一个客户端连接相当于是一个application\nspark-shell --master spark://node3:7077\n(master = spark://node3:7077, app id = app-20190828010957-0000).\nscala### \nval dataSet = spark.read.textFile("file:///opt/datas/worldcount.txt")\ndataSet.count\n\n5：使用命令行提交任务\nspark-submit --master spark://node3:7077 --deploy-mode cluster /opt/jars/sparktest01.jar file:///opt/datas/worldcount.txt \n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h3",{attrs:{id:"四-在web-ui查看执行结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-在web-ui查看执行结果"}},[s._v("#")]),s._v(" (四)在WEB UI查看执行结果")]),s._v(" "),t("p",[t("img",{attrs:{src:n(1546),alt:"Alt text"}})]),s._v(" "),t("h2",{attrs:{id:"二-yarn模式-官方文档-http-spark-apache-org-docs-2-2-0-running-on-yarn-html"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-yarn模式-官方文档-http-spark-apache-org-docs-2-2-0-running-on-yarn-html"}},[s._v("#")]),s._v(" 二：YARN模式(官方文档：http://spark.apache.org/docs/2.2.0/running-on-yarn.html)")]),s._v(" "),t("h3",{attrs:{id:"一-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-配置"}},[s._v("#")]),s._v(" (一)配置")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1: 配置yarn，让yarn在无资源分配的时候，不会杀掉提交的任务, 3台节点均配置\nvi /opt/modules/hadoop-2.5.0-cdh5.3.5/etc/hadoop/yarn-site.xml \n    <property>\n        <name>yarn.nodemanager.pmem-check-enabled</name>\n        <value>false</value>\n    </property>\n    <property>\n        <name>yarn.nodemanager.vmem-check-enabled</name>\n        <value>false</value>\n    </property>\n\n2: 重启yarn集群\nstop-yarn.sh \nstart-yarn.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"二-进入yarn模式的spark-shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-进入yarn模式的spark-shell"}},[s._v("#")]),s._v(" (二)进入yarn模式的spark-shell")]),s._v(" "),t("ul",[t("li",[s._v("yarn模式需要的内存较大，虚拟机必须是4G左右的内存")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("spark-shell --master yarn --deploy-mode client\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:n(1547),alt:"Alt text"}})]),s._v(" "),t("p",[t("img",{attrs:{src:n(1548),alt:"Alt text"}})]),s._v(" "),t("h3",{attrs:{id:"三-使用yarn模式提交任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-使用yarn模式提交任务"}},[s._v("#")]),s._v(" (三)使用yarn模式提交任务")]),s._v(" "),t("ul",[t("li",[s._v("修改sparktest01.jar程序，将之前的master的name改为yarn-cluster， 在重新打包为sparktest01.jar")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('.master("yarn-cluster")\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("spark-submit --class com.spark.test.Test --master yarn --deploy-mode cluster /opt/jars/sparktest01.jar file:///opt/datas/worldcount.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);