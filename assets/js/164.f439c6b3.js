(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{1660:function(s,a,t){s.exports=t.p+"assets/img/2021-01-027.59.33.71c6e130.png"},1661:function(s,a,t){s.exports=t.p+"assets/img/2021-01-028.06.22.478a0d25.png"},1662:function(s,a,t){s.exports=t.p+"assets/img/2021-02-068.57.35.c6d9d4bc.png"},2627:function(s,a,t){"use strict";t.r(a);var n=t(9),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"一-binlog日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-binlog日志"}},[s._v("#")]),s._v(" 一：binlog日志")]),s._v(" "),n("h3",{attrs:{id:"一-binlog日志介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-binlog日志介绍"}},[s._v("#")]),s._v(" "),n("code",[s._v("(一) binlog日志介绍")])]),s._v(" "),n("ul",[n("li",[s._v("记录SQL语句")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("记录的"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("语句包括："),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DDL")]),s._v("、"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DML")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("语句")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("但是select语句不会记录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("记录SQL执行消耗的时间")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：记录时间戳\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：记录持续时间\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("binlog日志有三中格式")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("# binlog_format "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" row，表示启用row格式的binlog\n# "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PXC")]),s._v("节点必须设置"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ROW")]),s._v("模式，否则无法启动\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：statement"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 同步块，但是有时候会导致数据不一致\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：row：同步安全，但是速度慢\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：mixed：混合模式\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[s._v("两种文件")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("# 一般在mysql配置文件中会有：log_bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql_bin，给二进制取名为mysql_bin\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：日志文件，例如：mysql_bin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("00001")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 文件不能被vim打开，只能在MySQL内部查看\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：索引文件，例如：mysql_bin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("index\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"二-pxc同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二-pxc同步"}},[s._v("#")]),s._v(" 二：PXC同步")]),s._v(" "),n("h3",{attrs:{id:"一-gtid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-gtid"}},[s._v("#")]),s._v(" "),n("code",[s._v("(一) GTID")])]),s._v(" "),n("ul",[n("li",[s._v("在数据库集群中，为了标识不同节点执行的事务，那么就引入了"),n("code",[s._v("GTID")]),s._v("全局事务ID")])]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GTID")]),s._v("分为：\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：server_uuid：数据库节点的"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：transaction_id：事务"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("MySQL的GTID集群只适用于replication复制，不适用与PXC集群， PXC集群的同步原理如下图，能够保证数据的一致性")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(1660),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("Replication集群同步原理如下，无法保证数据的一致性")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(1661),alt:"Alt text"}})]),s._v(" "),n("p",[n("img",{attrs:{src:t(1662),alt:"Alt text"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);