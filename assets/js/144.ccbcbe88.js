(window.webpackJsonp=window.webpackJsonp||[]).push([[144],{2222:function(s,n,e){"use strict";e.r(n);var t=e(9),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://darjun.github.io/2021/07/25/godailylib/gorilla/sessions/",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"一-sessions包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-sessions包"}},[s._v("#")]),s._v(" 一：sessions包")]),s._v(" "),t("h3",{attrs:{id:"一-基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-基本使用"}},[s._v("#")]),s._v(" (一)：基本使用")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("cookie用来验证用户身份有两个问题：一是数据不宜过大，二是不安全容易被篡改。session 是服务器端的存储方案，可以存储大量的数据，而且不需要向客户端传输，从而解决了cookie这两个问题。但是session 需要一个能唯一标识用户的 ID，这个 ID 一般存放在 cookie 中发送到客户端保存，且随每次请求一起发送到服务器。可以认为使用session来验证用户身份也是使用cookie来存储，但是cookie.value存储的不是用户信息(用户角色、用户名称等)，仅仅是一个标识用户的ID")])]),s._v(" "),t("li",[t("p",[s._v("gorilla/sessions包提供了基于 cookie 和本地文件系统的 session验证方案，同时预留扩展接口，用户可以自定义实现session的持久化存储，"),t("code",[s._v("下面例子是将session信息存储到本地文件系统中，然后再从本地文件系统中获取session的数据，sessionId是写入到浏览器的cookie中的")])])])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('// 创建一个基于本地文件系统存储session的store对象，./是session存储路径\nvar (\n\tstore = sessions.NewFilesystemStore("/Users/yinhuanyi/Yinhuanyi_Project/myoauth2/test1", securecookie.GenerateRandomKey(32), securecookie.GenerateRandomKey(32))\n)\n\n\nfunc set(w http.ResponseWriter, r *http.Request) {\n\n\t// 获取名称为user的session对象，如果不存在，会创建一个新的session对象\n\tsession, _ := store.Get(r, "user")\n\n\t// 给session设置数据\n\tsession.Values["name"] = "Robby"\n\tsession.Values["age"] = 29\n\n\t// 将session对象的用户数据保存到对应的存储中，同时在协议头设置set-cookie，将{user: sessionId}写入浏览器的application中\n\terr := sessions.Save(r, w)\n\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), http.StatusInternalServerError)\n\t\treturn\n\t}\n\n\t// 协议请求\n\tfmt.Fprintln(w, "Hello World")\n}\n\n\nfunc get(w http.ResponseWriter, r *http.Request) {\n\n\t// 从请求头的cookie字段获取sessionId值，并且从文件系统中加载sessionId对应的session对象\n\tsession, _ := store.Get(r, "user")\n\t\n\tfmt.Fprintf(w, "name:%s age:%d\\n", session.Values["name"], session.Values["age"])\n\n}\n\n\nfunc main() {\n\n\thttp.HandleFunc("/setsession", set)\n\thttp.HandleFunc("/getsession", get)\n\n\terr := http.ListenAndServe(":9090", nil)\n\tif err != nil {\n\t\tfmt.Printf("http server failed, err:%v\\n", err)\n\t\treturn\n\t}\n\t\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br")])]),t("ul",[t("li",[s._v("此时可以看到本地文件系统生成了一个session文件，"),t("code",[s._v("文件名 session 后面的部分就是 session ID，只不过浏览器的sessionId是被加密了，因此与session文件的sessionId不一样")])])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("session_WKOYKUTU3WNVCOCK2I7R6QEBMR6RSK4MZBWZ7ZAXDUBMCFZ4J2DQ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"二-将session信息存储到redis中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-将session信息存储到redis中"}},[s._v("#")]),s._v(" (二)：将session信息存储到Redis中")]),s._v(" "),t("ul",[t("li",[s._v("下载依赖")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("go get gopkg.in/boj/redistore.v1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("login.tpl模板代码")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport"\n          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <title>Document</title>\n</head>\n<body>\n    <form action="/dologin" method="post">\n      <label>Username:</label>\n      <input name="username"><br>\n      <label>Password:</label>\n      <input name="password" type="password"><br>\n      <button type="submit">登录</button>\n    </form>\n</body>\n</html>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("ul",[t("li",[s._v("home.tpl模板代码")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport"\n          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <title>Document</title>\n</head>\n<body>\n    {{if .}}\n\n\n    <p>Hi, {{ .Username }}</p>\n\n    <br>\n\n    <a href="/secret">Goto secret?</a>\n\n    {{else}}\n\n    <p>Hi, stranger</p><br>\n\n    <a href="/login">Goto login?</a>\n\n    {{end}}\n\n</body>\n</html>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("ul",[t("li",[s._v("secret.tpl模板代码")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<!doctype html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport"\n          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <title>Document</title>\n</head>\n<body>\n    <p>You have visited this page {{.Count}} times.</p>\n</body>\n</html>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("ul",[t("li",[s._v("main.go代码")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('var (\n\tloginTpl *template.Template\n\thomeTpl *template.Template\n\tsecretTpl *template.Template\n\t// 这里的[]byte("random-hash-key")是hashKey，是一个固定值，保证了重启进程，session依然有效\n\tstore, _ = redistore.NewRediStore(10, "tcp", ":6379", "", []byte("random-hash-key"))\n)\n\n// 解析模板\nfunc init() {\n\tloginTpl, _ = template.ParseFiles("/Users/yinhuanyi/Yinhuanyi_Project/myoauth2/test1/login.tpl")\n\t//template.Must(template.New("").ParseGlob("/Users/yinhuanyi/Yinhuanyi_Project/myoauth2/test1/*.tpl"))\n\thomeTpl, _ = template.ParseFiles("/Users/yinhuanyi/Yinhuanyi_Project/myoauth2/test1/home.tpl")\n\tsecretTpl, _ = template.ParseFiles("/Users/yinhuanyi/Yinhuanyi_Project/myoauth2/test1/secret.tpl")\n}\n\ntype User struct {\n\tUsername string\n\tCount int\n}\n\n/*\n\t1:获取用户请求头的user对应的sessionId，基于sessionId从Redis中获取session对象，如果不存在，会创建一个新的session对象\n\t2：从session对象中，获取user字段对应的值\n\t3：如果取值失败，直接返回nil\n\t4：如果取值成功，将session中user字段的值映射到结构体中返回\n*/\nfunc GetSessionUser(r *http.Request) *User {\n\t// 获取用户请求头的user对应的sessionId，基于sessionId从Redis中获取session对象，如果不存在，会创建一个新的session对象\n\tsession, _ := store.Get(r, "user")\n\n\t// 从session对象中，获取user字段对应的值\n\ts, ok := session.Values["user"]\n\n\tif !ok {\n\t\treturn nil\n\t}\n\n\n\tuser := &User{}\n\tjson.Unmarshal([]byte(s.(string)), user)\n\n\treturn user\n}\n\n/*\n\t1：获取用户请求头的user对应的sessionId，基于sessionId从Redis中获取session对象，如果不存在，会创建一个新的session对象\n\t2：对user对象序列化\n\t3：给session对象设置值\n\t4：将session对象的用户数据保存到Redis中，同时在协议头设置set-cookie，将{user: sessionId}写入浏览器的application中\n*/\nfunc SaveSessionUser(w http.ResponseWriter, r *http.Request, user *User) {\n\n\t// 获取用户请求头的user对应的sessionId，基于sessionId从Redis中获取session对象，如果不存在，会创建一个新的session对象\n\tsession, _ := store.Get(r, "user")\n\n\t// 对user对象序列化\n\tdata, _ := json.Marshal(user)\n\n\t// 给session对象设置值\n\tsession.Values["user"] = string(data)\n\n\t// 设置过期时间，这个应该设置到store全局，如果需要重新设置过期时间，可以在这里设置\n\tsessionOption := &sessions.Options{\n\t\tPath: "/",\n\t\tMaxAge: int(time.Minute * 1 / time.Second), // 一分钟后，浏览器的sessionId和Redis中的session对象都会过期\n\t\tSecure: true,\n\t\tHttpOnly: true,\n\t}\n\n\tsession.Options = sessionOption\n\n\t// 将session对象的用户数据保存到Redis中，同时在协议头设置set-cookie，将{user: sessionId}写入浏览器的application中\n\tstore.Save(r, w, session)\n\t//session.Save(r, w)\n\n}\n\n// Login 返回登录页面\nfunc Login(w http.ResponseWriter, r *http.Request) {\n\tdefer func() {\n\t\terr := recover()\n\t\t//如果程序出出现了panic错误,可以通过recover恢复过来\n\t\tif err != nil {\n\t\t\tfmt.Printf("err=%v\\n", err)\n\t\t}\n\t}()\n\t//fmt.Printf("%v\\n", ptTemplate)\n\tloginTpl.Execute(w, nil)\n}\n\n// DoLogin 登录请求\nfunc DoLogin(w http.ResponseWriter, r *http.Request) {\n\n\t// 解析form\n\tr.ParseForm()\n\n\tusername := r.Form.Get("username")\n\tpassword := r.Form.Get("password")\n\n\t// 登录失败直接返回\n\tif username != "Robby" || password != "123456" {\n\t\thttp.Redirect(w, r, "/login", http.StatusFound)\n\t\treturn\n\t}\n\n\t// 用户登录成功，写入session到Redis中\n\tSaveSessionUser(w, r, &User{Username: username})\n\n\t// session写入成功后，302跳转到Home页面\n\thttp.Redirect(w, r, "/", http.StatusFound)\n}\n\nfunc HomeHandler(w http.ResponseWriter, r *http.Request) {\n\n\t// 获取Redis中存储的session，如果存在会解析session的数据到user对象中， user的值可能是nil，也可能是结构体对象\n\tuser := GetSessionUser(r)\n\n\t// user的值可能是nil，也可能是结构体对象\n\thomeTpl.Execute(w, user)\n}\n\nfunc SecretHandler(w http.ResponseWriter, r *http.Request) {\n\t// 获取Redis中存储的session，如果存在会解析session的数据到user对象中， user的值可能是nil，也可能是结构体对象\n\tuser := GetSessionUser(r)\n\n\t// 如果是nil直接让用户跳转到登录页面\n\tif user == nil {\n\t\thttp.Redirect(w, r, "/login", http.StatusFound)\n\t\treturn\n\t}\n\n\t// 如果用户已经登录，让count+1\n\tuser.Count++\n\n\t// 用户登录成功，写入session到Redis中，目的是让count+1\n\tSaveSessionUser(w, r, user)\n\n\t// 返回页面\n\tsecretTpl.Execute(w, user)\n}\n\n\nfunc sayHello(w http.ResponseWriter, r *http.Request) {\n\tfmt.Fprintln(w, "Hello 沙河！")\n}\n\nfunc main() {\n\t//\n\t//http.HandleFunc("/", sayHello)\n\thttp.HandleFunc("/login", Login)\n\thttp.HandleFunc("/dologin", DoLogin)\n\thttp.HandleFunc("/", HomeHandler)\n\thttp.HandleFunc("/secret", SecretHandler)\n\n\n\n\terr := http.ListenAndServe(":9090", nil)\n\n\tif err != nil {\n\t\tfmt.Printf("http server failed, err:%v\\n", err)\n\t\treturn\n\t}\n\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br"),t("span",{staticClass:"line-number"},[s._v("148")]),t("br"),t("span",{staticClass:"line-number"},[s._v("149")]),t("br"),t("span",{staticClass:"line-number"},[s._v("150")]),t("br"),t("span",{staticClass:"line-number"},[s._v("151")]),t("br"),t("span",{staticClass:"line-number"},[s._v("152")]),t("br"),t("span",{staticClass:"line-number"},[s._v("153")]),t("br"),t("span",{staticClass:"line-number"},[s._v("154")]),t("br"),t("span",{staticClass:"line-number"},[s._v("155")]),t("br"),t("span",{staticClass:"line-number"},[s._v("156")]),t("br"),t("span",{staticClass:"line-number"},[s._v("157")]),t("br"),t("span",{staticClass:"line-number"},[s._v("158")]),t("br"),t("span",{staticClass:"line-number"},[s._v("159")]),t("br"),t("span",{staticClass:"line-number"},[s._v("160")]),t("br"),t("span",{staticClass:"line-number"},[s._v("161")]),t("br"),t("span",{staticClass:"line-number"},[s._v("162")]),t("br"),t("span",{staticClass:"line-number"},[s._v("163")]),t("br"),t("span",{staticClass:"line-number"},[s._v("164")]),t("br"),t("span",{staticClass:"line-number"},[s._v("165")]),t("br")])]),t("h3",{attrs:{id:"三-登录效果演示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-登录效果演示"}},[s._v("#")]),s._v(" (三)：登录效果演示")]),s._v(" "),t("ul",[t("li",[s._v("访问"),t("code",[s._v("http://localhost:9090/login")]),s._v("，填写用户名密码")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(744),alt:"Alt text"}})]),s._v(" "),t("ul",[t("li",[s._v("登录成功会302跳转到"),t("code",[s._v("http://localhost:9090/")])])]),s._v(" "),t("p",[t("img",{attrs:{src:e(745),alt:"Alt text"}})]),s._v(" "),t("ul",[t("li",[s._v("访问"),t("code",[s._v("Goto secret?")]),s._v("，进入统计页面，"),t("code",[s._v("由于session的过期时间设置的是1分钟")]),s._v("，1分钟后需要重新登录")])]),s._v(" "),t("p",[t("img",{attrs:{src:e(746),alt:"Alt text"}})]),s._v(" "),t("ul",[t("li",[s._v("此时即使是在多进程的模式下，session的会话保持依然有效")])]),s._v(" "),t("h3",{attrs:{id:"四-cookie的option字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-cookie的option字段"}},[s._v("#")]),s._v(" (四)：cookie的Option字段")]),s._v(" "),t("ul",[t("li",[s._v("Cookie默认有9个字段，它们分别如下")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1：name：cookie名称\n\n2：value：cookie值\n\n3：domain字段：携带cookie的域名\n\n4：path字段：为可以访问此cookie的页面路径。 比如domain是abc.com,path是/test，那么只有/test路径下的页面可以读取此cookie\n\n5：size：cookie的大小\n\n6：httponly：若为true，则只有在http请求头中会带有此cookie的信息，而不能通过JavaScript来访问此cookie\n\n7：expires/Max-Age：设置cookie的过期时间\n\n8：secure：如果为true，只能通过https来访问此cookie\n\n9：sameSite：默认是Lax规则，用于防止csrf攻击\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("ul",[t("li",[s._v("设置Cookie的时候，除了name和value，可以设置的字段有6个")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("type Options struct {\n\tPath   string // 路径\n\tDomain string // 域名\n\tMaxAge   int  // 过期时间\n\tSecure   bool // 是否仅https使用\n\tHttpOnly bool // 是否javascrip访问\n\tSameSite http.SameSite // 是否限制第三方cookie\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])}),[],!1,null,null,null);n.default=a.exports},744:function(s,n,e){s.exports=e.p+"assets/img/2021-11-019.42.41.2b4179f5.png"},745:function(s,n,e){s.exports=e.p+"assets/img/2021-11-019.45.57.6aebc320.png"},746:function(s,n,e){s.exports=e.p+"assets/img/2021-11-019.48.31.b0d4fc74.png"}}]);