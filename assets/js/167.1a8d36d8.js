(window.webpackJsonp=window.webpackJsonp||[]).push([[167],{1788:function(s,a,n){s.exports=n.p+"assets/img/2020-05-2411.18.19.8446f039.png"},1789:function(s,a,n){s.exports=n.p+"assets/img/2020-05-2411.20.21.7aacce44.png"},1790:function(s,a,n){s.exports=n.p+"assets/img/2020-05-2411.22.43.d74e0a95.png"},2698:function(s,a,n){"use strict";n.r(a);var e=n(9),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"一-proxy基本概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-proxy基本概念"}},[s._v("#")]),s._v(" 一：Proxy基本概念")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\tProxy 只有一个proxy的daemon进程，Proxy也有自己的数据库，但他的数据库只会保存一定时间的数据，他与Master通信是一批数据打包后发送到master，master将这些数据merge到master数据库\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("Proxy的优势")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1：Proxy压力小，数据库只存储一定时间的数据\n2：master压力变小，并发负载和IO压力减小\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"二-proxy安装与配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-proxy安装与配置"}},[s._v("#")]),s._v(" 二：Proxy安装与配置")]),s._v(" "),e("ul",[e("li",[s._v("下载")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 安装zabbix-proxy-mysql\nwget https://repo.zabbix.com/zabbix/5.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_5.0-1+bionic_all.deb\ndpkg -i zabbix-release_5.0-1+bionic_all.deb\napt update\napt install zabbix-proxy-mysql\n\n\n# 配置proxy的数据库\n# mysql -uroot -p\npassword\nmysql> create database zabbix character set utf8 collate utf8_bin;\nmysql> create user zabbix@localhost identified by 'password';\nmysql> grant all privileges on zabbix.* to zabbix@localhost;\nmysql> quit;\n\n\n# 初始化数据表\nzcat /usr/share/doc/zabbix-proxy-mysql/schema.sql.gz | mysql -uzabbix -p zabbix\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("ul",[e("li",[s._v("修改配置文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 这个是服务器端的Zabbix-Server的地址\nServer=10.102.0.4\nServerPort=10051\nListenPort=10051\n# 这个名称是代理的名称\nHostname=Zabbix proxy\nLogFile=/var/log/zabbix/zabbix_proxy.log\nLogFileSize=0\nPidFile=/var/run/zabbix/zabbix_proxy.pid\nSocketDir=/var/run/zabbix\nDBName=zabbix\nDBUser=zabbix\nDBPassword=zHAs3erVUnD0DkJz\nSNMPTrapperFile=/var/log/snmptrap/snmptrap.log\nTimeout=4\nExternalScripts=/usr/lib/zabbix/externalscripts\nFpingLocation=/usr/bin/fping\nFping6Location=/usr/bin/fping6\nLogSlowQueries=3000\nStatsAllowedIP=127.0.0.1\n# 60秒拉取一次配置\nConfigFrequency=60\n# 1秒发送一次数据到zabbix-server\nDataSenderFrequency=1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br")])]),e("ul",[e("li",[s._v("在web页面配置agent代理程序")])]),s._v(" "),e("p",[e("img",{attrs:{src:n(1788),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("创建一个agent代理(代理名称必须与配置文件一样，地址是proxy的IP地址)")])]),s._v(" "),e("p",[e("img",{attrs:{src:n(1789),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("那么在创建主机的时候，需要选择由agent代理监控")])]),s._v(" "),e("p",[e("img",{attrs:{src:n(1790),alt:"Alt text"}})]),s._v(" "),e("h2",{attrs:{id:"三-agent配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-agent配置文件"}},[s._v("#")]),s._v(" 三：agent配置文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("PidFile=/var/run/zabbix/zabbix_agentd.pid\nLogFile=/var/log/zabbix/zabbix_agentd.log\nLogFileSize=0\nDenyKey=system.run[*]\n# 指定proxy的IP地址\nServerActive=10.102.0.1\nHostname=west-yw1-1\nInclude=/etc/zabbix/zabbix_agentd.d/*.conf\n# 主动模式\nStartAgents=0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);