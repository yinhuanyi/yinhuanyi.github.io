(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{2322:function(s,e,a){"use strict";a.r(e);var r=a(9),n=Object(r.a)({},(function(){var s=this,e=s.$createElement,r=s._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[r("h2",{attrs:{id:"一-django-rest-framework介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一-django-rest-framework介绍"}},[s._v("#")]),s._v(" 一：Django REST Framework介绍")]),s._v(" "),r("h3",{attrs:{id:"一-django-rest-framework框架介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一-django-rest-framework框架介绍"}},[s._v("#")]),s._v(" （一）：Django REST framework框架介绍")]),s._v(" "),r("ul",[r("li",[s._v("概念")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("1： Django Rest Framework: 官方网站 https://www.django-rest-framework.org/，简称DRF框架，截止到目前，GitHub上的star为13399个\n\n2：Django Rest Framework 是Django依赖扩展Restful Api的框架，与Django的使用风格类似，\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br")])]),r("h3",{attrs:{id:"二-django如何完成api的设计"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二-django如何完成api的设计"}},[s._v("#")]),s._v(" （二）：Django如何完成API的设计")]),s._v(" "),r("ul",[r("li",[r("p",[r("strong",[s._v("需求：在schools APP中，设计一个API接口，前端请求的时候，返回数据库中所有学校的详细信息")])])]),s._v(" "),r("li",[r("p",[s._v("编辑根urls.py文件，添加路由")])])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("url(r'^school/', include('schools.urls', namespace='schools'))\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br")])]),r("ul",[r("li",[s._v("编辑schools APP中，urls.py文件(记得执行makemigration 和 migrate操作)")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("url(r'^all/$', AllSchoolsView.as_view(), name='all')\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br")])]),r("ul",[r("li",[s._v("编辑schools APP中，models.py文件")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("from django.db import models\nfrom datetime import datetime\n\nclass School(models.Model):\n    name = models.CharField(max_length=50, verbose_name='学校名称')\n    desc = models.CharField(max_length=100, verbose_name='学校描述')\n    location = models.CharField(max_length=100, verbose_name='学校位置')\n    create_time = models.DateTimeField(default=datetime.now, verbose_name='添加时间')\n    course_numbers = models.IntegerField(default=0, verbose_name=\"课程数\")\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br")])]),r("ul",[r("li",[s._v("编辑schools APP中，views.py文件")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("from django.views.generic.base import View\nimport json\nfrom django.core.serializers import serialize\nfrom django.http import HttpResponse, JsonResponse\nfrom .models import School\n\nclass AllSchoolsView(View):\n    def get(self, request):\n        schools = School.objects.all()\n        # 直接将数据库中的QuerySet对象转换为json数据格式\n        goods_json = serialize('json', schools)\n        print(type(goods_json))\n        print('serialize: --------{}'.format(goods_json))\n        return HttpResponse(content=goods_json, content_type='application/json')\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br")])]),r("ul",[r("li",[s._v("创建数据库中schools_school的数据")])]),s._v(" "),r("p",[r("img",{attrs:{src:a(904),alt:"Alt text"}})]),s._v(" "),r("ul",[r("li",[s._v("前端请求的url："),r("strong",[s._v("http://127.0.0.1:12345/school/all/")])])]),s._v(" "),r("p",[r("img",{attrs:{src:a(905),alt:"Alt text"}})]),s._v(" "),r("h3",{attrs:{id:"三-使用django-rest-framework定制restful-api"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#三-使用django-rest-framework定制restful-api"}},[s._v("#")]),s._v(" （三）：使用Django REST framework定制Restful API")]),s._v(" "),r("ul",[r("li",[s._v("安装Django REST Framework")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("pip install djangorestframework\npip install markdown       # Markdown support for the browsable API.\npip install django-filter  # Filtering support\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br")])]),r("ul",[r("li",[s._v("将rest_framework添加到settings文件的INSTALLED_APPS")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("INSTALLED_APPS = (\n    'rest_framework',\n)\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br")])]),r("ul",[r("li",[s._v("支持浏览器访问api认证")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("# 支持浏览器访问api认证\nurl(r'^api-auth/', include('rest_framework.urls'))\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br")])]),r("ul",[r("li",[s._v("创建Django的管理员")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("manage.py@XKD_New_Project > createsuperuser\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br")])]),r("ul",[r("li",[r("p",[s._v("将之前的Django API 修改为 Django REST Framework API")])]),s._v(" "),r("li",[r("p",[s._v("在schools APP中，创建serializer.py文件")])])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("from rest_framework import serializers\n\nclass SchoolSerializer(serializers.Serializer):\n    name = serializers.CharField()\n    course_numbers = serializers.IntegerField()\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("ul",[r("li",[s._v("编辑schools APP中，views.py文件")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("from .models import School\nfrom rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom .serializer import SchoolSerializer\n\nclass AllSchoolsView(APIView):\n    def get(self, request):\n        schools = School.objects.all()\n        # many表示返回一个list， 如果不设置，则返回一个\n        schools_serializer = SchoolSerializer(schools, many=True)\n        return Response(schools_serializer.data)\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br")])]),r("ul",[r("li",[s._v("前端请求 "),r("strong",[s._v("http://127.0.0.1:12345/school/all/")])])]),s._v(" "),r("p",[r("img",{attrs:{src:a(906),alt:"Alt text"}})])])}),[],!1,null,null,null);e.default=n.exports},904:function(s,e,a){s.exports=a.p+"assets/img/2019-03-224.19.15.566f4fcb.png"},905:function(s,e,a){s.exports=a.p+"assets/img/2019-03-224.20.39.612ef03a.png"},906:function(s,e,a){s.exports=a.p+"assets/img/2019-03-224.59.22.c5922989.png"}}]);