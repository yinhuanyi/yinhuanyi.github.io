(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1550:function(s,n,a){s.exports=a.p+"assets/img/fullpic.39320e1a.jpg"},1551:function(s,n,a){s.exports=a.p+"assets/img/flum.80dfc231.png"},1552:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.38.15.4093592d.png"},1553:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.41.01.9866c67d.png"},1554:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.41.18.6950db82.png"},1555:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.41.46.3d07a335.png"},1556:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.42.24.346561dd.png"},1557:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.43.07.1529e5f2.png"},1558:function(s,n,a){s.exports=a.p+"assets/img/2019-08-214.43.12.641b6036.png"},2584:function(s,n,a){"use strict";a.r(n);var e=a(9),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"一-flume采集原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-flume采集原理"}},[s._v("#")]),s._v(" 一：Flume采集原理")]),s._v(" "),e("h3",{attrs:{id:"一-采集原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-采集原理"}},[s._v("#")]),s._v(" (一)采集原理")]),s._v(" "),e("p",[e("img",{attrs:{src:a(1550),alt:"Alt text"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(1551),alt:"Alt text"}})]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1： 前面两个节点负责日志采集为node2和node3，后面的那个节点node1负责日志合并，合并之后，进行预处理\n2：node1的flume需要对sink进行二次开发，因为在sink到hbase的时候，需要创建表和列名称操作，因此需要二次开发\n3：node1的resource是node2和node3，channel也是两个，一个channel是kafka，一个channel是hbase，sink也是两个，一个是sink kafka，一个是sink hbase\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"二-flume配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-flume配置"}},[s._v("#")]),s._v(" 二：Flume配置")]),s._v(" "),e("h3",{attrs:{id:"一-flume配置http-flume-apache-org-releases-content-1-9-0-flumeuserguide-html-flume-sources"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-flume配置http-flume-apache-org-releases-content-1-9-0-flumeuserguide-html-flume-sources"}},[s._v("#")]),s._v(" (一)Flume配置http://flume.apache.org/releases/content/1.9.0/FlumeUserGuide.html#flume-sources")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1: 配置环境变量\nvi /etc/profile.d/flume.sh\nexport PATH=/opt/modules/apache-flume-1.7.0-bin/bin:$PATH\n. /etc/profile.d/flume.sh\n\n2: 将flume拷贝到node2和node3\n\n3: 在node2和node3创建一个文件，模拟日志写入\ntouch /opt/datas/weblogs.log\n\n4: node1、node2和node3\nvi flume-env.sh\nexport JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.222.b10-0.el7_6.x86_64\n\n\n\n\n\n\n4：在node1上：vi flume-conf.properties \n####################################### flume的sources、channel、sink ####################################\n\n# 给flume3个线程重命名, 这里的agent就是a1，只是配置文件中取了一个别名而已\nagent1.sources = r1\n# 这里是两个channel\nagent1.channels = kafkaC hbaseC\n# 这里是两个sink\nagent1.sinks = kafkaSink hbaseSink\n\n########################################## resource配置  #################################################\n\n# 指定数据来源于node2和node3的sink\nagent1.sources.r1.type = avro\n# 将数据管道到hbase中\nagent1.sources.r1.channels = kafkaC hbaseC\n# 第一台机器的域名\nagent1.sources.r1.bind = node1\n# 监听的端口\nagent1.sources.r1.port = 4545\n# 指定最大线程数\nagent1.sources.r1.threads = 5\n########################################## flume + hbase #################################################\n# 配置flume的channel\nagent1.channels.hbaseC.type = memory\nagent1.channels.hbaseC.capacity = 10000\nagent1.channels.hbaseC.transactionCapacity = 10000\nagent1.channels.hbaseC.keep-alive = 10\n# 这里sink的时候指定为hbase\nagent1.sinks.hbaseSink.type = asynchbase\nagent1.sinks.hbaseSink.table = weblogs\nagent1.sinks.hbaseSink.columnFamily = info\n# 二次开发的序列化类\nagent1.sinks.hbaseSink.serializer = org.apache.flume.sink.hbase.KfkAsyncHbaseEventSerializer\nagent1.sinks.hbaseSink.channel = hbaseC\n# 这里是配置hbaes的字段名称\nagent1.sinks.hbaseSink.serializer.payloadColumn = datatime,userid,searchname,retorder,cliorder,cliurl\n\n########################################## flume + kafka ##################################################\n\n# 配置kafka的channel\nagent1.channels.kafkaC.type = memory\nagent1.channels.kafkaC.capacity = 10000\nagent1.channels.kafkaC.transactionCapacity = 10000\nagent1.channels.kafkaC.keep-alive = 10\n# 配置kafka的sink\n# agent1.sinks.kafkaSink.channel = c1\nagent1.sinks.kafkaSink.channel = kafkaC\nagent1.sinks.kafkaSink.type = org.apache.flume.sink.kafka.KafkaSink\nagent1.sinks.kafkaSink.brokerList = node1:9092,node2:9092,node3:9092\nagent1.sinks.kafkaSink.topic = weblogs\nagent1.sinks.kafkaSink.zookeeperConnect = node1:2181,node2:2181,node3:2181\nagent1.sinks.kafkaSink.requiredAcks = 1\n# 下面2项为优化部分\nagent1.sinks.kafkaSink.batchSize = 1\nagent1.sinks.kafkaSink.serializer.class = kafka.serializer.StringEncoder\n\n\n5：在node2上：vi flume-conf.properties \n# 指定数据源\n# 给flume3个线程重命名, 这里的agent就是a1，只是配置文件中取了一个别名而已\nagent2.sources = r1\nagent2.channels = c1\nagent2.sinks = s1\n# 指定数据来源于/opt/datas/weblogs.log日志文件，这里也可以是一个目录 \nagent2.sources.r1.type = exec\nagent2.sources.r1.command = tail -F /opt/datas/weblogs.log\nagent2.sources.r1.channels = c1\n# 配置flume的channel\nagent2.channels.c1.type = memory\nagent2.channels.c1.capacity = 10000\nagent2.channels.c1.transactionCapacity = 10000\nagent2.channels.c1.keep-alive = 5\n# 这里sink的时候，直接sink到下一个flume节点，不是hdfs或者hive等，意思是不落地, 直接使用avro类型即可\nagent2.sinks.s1.type = avro\nagent2.sinks.s1.channel = c1\n# node2,node3采集信息，node1汇聚信息\nagent2.sinks.s1.hostname = node1\nagent2.sinks.s1.port = 4545\n\n\n6：在node3上：vi flume-conf.properties \n# 给flume3个线程重命名, 这里的agent就是a1，只是配置文件中取了一个别名而已\nagent3.sources = r1\nagent3.channels = c1\nagent3.sinks = s1\n# 指定数据来源于/opt/datas/weblogs.log日志文件，这里也可以是一个目录 \nagent3.sources.r1.type = exec\nagent3.sources.r1.command = tail -F /opt/datas/weblogs.log\nagent3.sources.r1.channels = c1\n# 配置flume的channel\nagent3.channels.c1.type = memory\nagent3.channels.c1.capacity = 10000\nagent3.channels.c1.transactionCapacity = 10000\nagent3.channels.c1.keep-alive = 5\n# 这里sink的时候，直接sink到下一个flume节点，不是hdfs或者hive等，意思是不落地, 直接使用avro类型即可\nagent3.sinks.s1.type = avro\nagent3.sinks.s1.channel = c1\n# node2,node3采集信息，node1汇聚信息\nagent3.sinks.s1.hostname = node1\nagent3.sinks.s1.port = 4545\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br")])]),e("h2",{attrs:{id:"三-flume对simpleasynchbaseeventserializer类进行二次开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-flume对simpleasynchbaseeventserializer类进行二次开发"}},[s._v("#")]),s._v(" 三：Flume对SimpleAsyncHbaseEventSerializer类进行二次开发")]),s._v(" "),e("h3",{attrs:{id:"一-下载apache-flume-1-7-0-src源码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-下载apache-flume-1-7-0-src源码"}},[s._v("#")]),s._v(" (一)下载apache-flume-1.7.0-src源码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("官网下载即可\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"二-将源码加载到idea"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-将源码加载到idea"}},[s._v("#")]),s._v(" (二)将源码加载到IDEA")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1: 加载apache-flume-1.7.0-src/flume-ng-sinks/flume-ng-hbase-sink这个子模块\n\n2：对SimpleAsyncHbaseEventSerializer类进行修改\n\n3：新建一个类KfkAsyncHbaseEventSerializer进行二次开发\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"四-对日志数据进行格式处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-对日志数据进行格式处理"}},[s._v("#")]),s._v(" 四：对日志数据进行格式处理")]),s._v(" "),e("h3",{attrs:{id:"一-格式化日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-格式化日志"}},[s._v("#")]),s._v(" (一)格式化日志")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1：将空格改为逗号\nsed -ir 's/\\t\\+/,/g'    user.log\nsed -ir 's/ /,/g'    user.log  \n\n2：将user.log拷贝到node2和node3节点\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"五-将二次开发的hbasesink进行重新打成jar包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-将二次开发的hbasesink进行重新打成jar包"}},[s._v("#")]),s._v(" 五：将二次开发的hbaseSink进行重新打成jar包")]),s._v(" "),e("h3",{attrs:{id:"一-maven项目打包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-maven项目打包"}},[s._v("#")]),s._v(" (一)Maven项目打包")]),s._v(" "),e("ul",[e("li",[s._v("选择File -### Project Structure")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1552),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("选择Artifacts")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1553),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("选择Jar -### From modules with dependencies")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1554),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("点击OK")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1555),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("将工程的依赖全部去掉，只留下flume-gn-hbase-sink即可")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1556),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("选择Build -### Build Artifacts")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1557),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("直接选择Build")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1558),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("此时项目的out目录下，会生产一个"),e("code",[s._v("flume-ng-hbase-sink.jar")]),s._v("包")])]),s._v(" "),e("li",[e("p",[s._v("将这个jar包替换node1的/opt/modules/apache-flume-1.7.0-bin/lib下的jar包即可")])])]),s._v(" "),e("h2",{attrs:{id:"六-flume与kafka的集成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六-flume与kafka的集成"}},[s._v("#")]),s._v(" 六：Flume与Kafka的集成")]),s._v(" "),e("h3",{attrs:{id:"一-配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-配置"}},[s._v("#")]),s._v(" (一)配置")]),s._v(" "),e("ul",[e("li",[s._v("添加Flume与Kafka的集成的相关配置")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1: vi flume-conf.properties 添加Flume与Kafka的集成的相关配置\n# 配置kafka的channel\nagent1.channels.kafkaC.type = memory\nagent1.channels.kafkaC.capacity = 10000\nagent1.channels.kafkaC.transactionCapacity = 10000\nagent1.channels.kafkaC.keep-alive = 10\n# 配置kafka的sink\nagent1.sinks.kafkaSink.channel = c1\nagent1.sinks.kafkaSink.type = org.apache.flume.sink.kafka.KafkaSink\nagent1.sinks.kafkaSink.brokerList = node1:9092,node2:9092,node3:9092\nagent1.sinks.kafkaSink.topic = test\nagent1.sinks.kafkaSink.zookeeperConnect = node1:2181,node2:2181,node3:2181\nagent1.sinks.kafkaSink.requiredAcks = 1\nagent1.sinks.kafkaSink.batchSize = 1\nagent1.sinks.kafkaSink.serializer.class = kafka.serializer.StringEncoder\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("ul",[e("li",[s._v("最终node1的flume-conf.properties文件内容如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("####################################### flume的sources、channel、sink ####################################\n\n# 给flume3个线程重命名, 这里的agent就是a1，只是配置文件中取了一个别名而已\nagent1.sources = r1\n# 这里是两个channel\nagent1.channels = kafkaC hbaseC\n# 这里是两个sink\nagent1.sinks = kafkaSink hbaseSink\n\n########################################## flume + hbase #################################################\n\n# 指定数据来源于node2和node3的sink\nagent1.sources.r1.type = avro\n# 将数据管道到hbase中\nagent1.sources.r1.channels = hbaseC\n# 第一台机器的域名\nagent1.sources.r1.bind = node1\n# 监听的端口\nagent1.sources.r1.port = 4545\n# 指定最大线程数\nagent1.sources.r1.threads = 5\n# 配置flume的channel\nagent1.channels.hbaseC.type = memory\nagent1.channels.hbaseC.capacity = 10000\nagent1.channels.hbaseC.transactionCapacity = 10000\nagent1.channels.hbaseC.keep-alive = 10\n# 这里sink的时候指定为hbase\nagent1.sinks.hbaseSink.type = asynchbase\nagent1.sinks.hbaseSink.table =weblogs\nagent1.sinks.hbaseSink.columnFamily = info\n# 二次开发的序列化类\nagent1.sinks.hbaseSink.serializer = org.apache.flume.sink.hbase.KfkAsyncHbaseEventSerializer\nagent1.sinks.hbaseSink.channel = hbaseC\n# 这里是配置hbaes的字段名称\nagent1.sinks.hbaseSink.serializer.payloadColumn = datatime,userid,searchname,retorder,cliorder,cliurl\n\n########################################## flume + kafka ##################################################\n\n# 配置kafka的channel\nagent1.channels.kafkaC.type = memory\nagent1.channels.kafkaC.capacity = 10000\nagent1.channels.kafkaC.transactionCapacity = 10000\nagent1.channels.kafkaC.keep-alive = 10\n# 配置kafka的sink\nagent1.sinks.kafkaSink.channel = c1\nagent1.sinks.kafkaSink.type = org.apache.flume.sink.kafka.KafkaSink\nagent1.sinks.kafkaSink.brokerList = node1:9092,node2:9092,node3:9092\nagent1.sinks.kafkaSink.topic = test\nagent1.sinks.kafkaSink.zookeeperConnect = node1:2181,node2:2181,node3:2181\nagent1.sinks.kafkaSink.requiredAcks = 1\n# 下面2项为优化部分\nagent1.sinks.kafkaSink.batchSize = 1\nagent1.sinks.kafkaSink.serializer.class = kafka.serializer.StringEncoder\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);