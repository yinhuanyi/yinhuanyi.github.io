(window.webpackJsonp=window.webpackJsonp||[]).push([[210],{1573:function(s,a,n){s.exports=n.p+"assets/img/3B59ADD50E4440C01F00FCBEACA63C4E.dab9485b.png"},1574:function(s,a,n){s.exports=n.p+"assets/img/090C805EEC4D50A58C13AFFEC9DF0721.f1453303.png"},2594:function(s,a,n){"use strict";n.r(a);var e=n(9),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"一-streaming介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-streaming介绍"}},[s._v("#")]),s._v(" 一：Streaming介绍")]),s._v(" "),e("h3",{attrs:{id:"一-概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-概念"}},[s._v("#")]),s._v(" (一)概念")]),s._v(" "),e("p",[e("img",{attrs:{src:n(1573),alt:"Alt text"}})]),s._v(" "),e("p",[e("img",{attrs:{src:n(1574),alt:"Alt text"}})]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Spark的Streaming实际上就是流时的RDD,\n在Spark执行器中，有receivers线程，接收外部数据\n被receivers接收的数据就会被batches处理，每一个batch就是一个RDD\n每一个RDD会连续的被spark engine处理\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"二-基于netcat作为spark-streaming的input数据流"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-基于netcat作为spark-streaming的input数据流"}},[s._v("#")]),s._v(" 二：基于NetCat作为spark streaming的input数据流")]),s._v(" "),e("h3",{attrs:{id:"一-概念-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-概念-2"}},[s._v("#")]),s._v(" (一)概念")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("0：将spark的log4g日志的INFO级别改为WARN级别\nvi log4j.properties\n\n1: 安装nc\nyum  install -y nc\n\n2: 监听任意IP的9999端口\nnc -lk 9999\n\n3：运行spark自带的词频统计的任务\nrun-example streaming.NetworkWordCount localhost  9999\n(ewrt,1)\n(wert,3)\n(sdfg,5)\n(dfgsdfgsd,1)\n(fghj,4)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h2",{attrs:{id:"三-spark-streaming的代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-spark-streaming的代码"}},[s._v("#")]),s._v(" 三：Spark streaming的代码")]),s._v(" "),e("h3",{attrs:{id:"一-将代码在idea中运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-将代码在idea中运行"}},[s._v("#")]),s._v(" (一)将代码在IDEA中运行")]),s._v(" "),e("ul",[e("li",[s._v("启动nc且在IDEA代码运行")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import org.apache.spark.sql.SparkSession\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\n\nobject Test {\n    def main(args: Array[String]): Unit = {\n\n        val spark = SparkSession\n            .builder()\n            .master("local[2]")\n            .appName("HDFS")\n            .getOrCreate()\n        val ssc = new StreamingContext(spark.sparkContext, Seconds(5))\n        val lines = ssc.socketTextStream("node3", 9999)\n        val wordCouts = lines\n            .flatMap(_.split(" "))\n            .map(word =### (word, 1))\n            .reduceByKey(_+_)\n        wordCouts.print()\n        ssc.start()\n        ssc.awaitTermination()\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("ul",[e("li",[s._v("打印结果")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("-------------------------------------------\nTime: 1567340160000 ms\n-------------------------------------------\n(d,1)\n(as,4)\n(asdf,1)\n(,6)\n(f,2)\n(fasdf,1)\n(sa,2)\n(df,4)\n(sdf,1)\n(a,2)\n...\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("h2",{attrs:{id:"四-spark-streaming的结果写入mysql数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-spark-streaming的结果写入mysql数据库"}},[s._v("#")]),s._v(" 四：Spark streaming的结果写入MySQL数据库")]),s._v(" "),e("h3",{attrs:{id:"一-示例代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-示例代码"}},[s._v("#")]),s._v(" (一)示例代码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('import java.sql.DriverManager\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\n\nobject Test {\n    def main(args: Array[String]): Unit = {\n\n        val spark = SparkSession\n            .builder()\n            .master("local[2]")\n            .appName("HDFS")\n            .getOrCreate()\n        val ssc = new StreamingContext(spark.sparkContext, Seconds(5))\n        val lines = ssc.socketTextStream("node3", 9999)\n        val wordCouts = lines\n            .flatMap(_.split(" "))\n            .map(word =### (word, 1))\n            .reduceByKey(_+_)\n\n        // 先获取RDD，在RDD里面变量所有分区,这里lines是5秒的数据\n        wordCouts.foreachRDD(rdd =### rdd.foreachPartition(lines => {\n            // 工程项目中这里需要通过建立连接池\n            Class.forName("com.mysql.jdbc.Driver")\n            val conn = DriverManager.getConnection("jdbc:mysql://node1:3306/test","root", "yhy3426356")\n            try{\n                for (line <- lines){\n                    // 拼接SQL\n                    val sql = "insert into webcount(titleName, count) values(\'"+line._1+"\', \'"+line._2+"\')"\n                    conn.prepareStatement(sql).executeUpdate()\n                }\n            }finally {\n                conn.close()\n            }\n        }))\n\n        ssc.start()\n        ssc.awaitTermination()\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br")])]),e("h2",{attrs:{id:"五-基于kafka作为数据源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-基于kafka作为数据源"}},[s._v("#")]),s._v(" 五：基于Kafka作为数据源")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("由于kafka使用的版本是2.1.1，当spark获取kafka数据时候，会抛出异常，因此改为使用0.9和1.0版本的kafka \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"一-配置spark-streaming-kafka-0-8-启动0-9版本的kafka"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-配置spark-streaming-kafka-0-8-启动0-9版本的kafka"}},[s._v("#")]),s._v(" (一)配置spark-streaming-kafka-0-8, 启动0.9版本的kafka")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('1: 在pom.xml添加kafka依赖\n    \x3c!-- kafka-0-0.8 --\x3e\n    <dependency>\n      <groupId>org.apache.spark</groupId>\n      <artifactId>spark-streaming-kafka-0-8_2.11</artifactId>\n      <version>${spark.version}</version>\n    </dependency>\n\n2: 使用kafka自带生产者向kafka写入数据，消费者接收数据\n生产：kafka-console-producer.sh --broker-list node1:9092,node2:9092,node3:9092 --topic weblogs\n消费：kafka-console-consumer.sh --zookeeper node1:2181,node2:2181,node3:2181 --bootstrap-server node1:9092,node2:9092,node3:9092 --topic weblogs --from-beginning\n\n3：代码为：\nimport kafka.serializer.StringDecoder\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.streaming.kafka.KafkaUtils\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\n\nobject Test {\n    def main(args: Array[String]): Unit = {\n\n        val spark = SparkSession\n            .builder()\n            .master("local[2]")\n            .appName("HDFS")\n            .getOrCreate()\n\n        // 获取spark streaming context\n        val ssc = new StreamingContext(spark.sparkContext, Seconds(5))\n        // 指定kafka的topic\n        val topics = "weblogs"\n        val topicsSet = topics.split(",").toSet\n        // 配置参数\n        val kafkaParams = Map[String, String]("metadata.broker.list" -### "node1:9092,node2:9092,node3:9092")\n\n        // 从kafka读取信息，\n        val messages = KafkaUtils.createDirectStream[String, String, StringDecoder, StringDecoder](\n            ssc, kafkaParams, topicsSet)\n\n        // 基于spark RDD操作数据\n        // 获取value值\n        val lines = messages.map(_._2)\n        val words = lines.flatMap(_.split(" "))\n        val wordCounts = words.map(x =### (x, 1L)).reduceByKey(_+_)\n        wordCounts.print()\n\n        // 启动spark\n        ssc.start()\n        ssc.awaitTermination()\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br")])]),e("h3",{attrs:{id:"二-配置spark-streaming-kafka-0-10-启动0-10版本的kafka"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-配置spark-streaming-kafka-0-10-启动0-10版本的kafka"}},[s._v("#")]),s._v(" (二)配置spark-streaming-kafka-0-10, 启动0.10版本的kafka")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('1: 在pom.xml添加kafka依赖\n    <dependency>\n      <groupId>org.apache.spark</groupId>\n      <artifactId>spark-streaming-kafka-0-10_${scala.binary.version}</artifactId>\n      <version>${spark.version}</version>\n    </dependency>\n\n2: 使用kafka自带生产者向kafka写入数据，消费者接收数据\n生产：kafka-console-producer.sh --broker-list node1:9092,node2:9092,node3:9092 --topic weblogs\n消费：kafka-console-consumer.sh --zookeeper node1:2181,node2:2181,node3:2181 --bootstrap-server node1:9092,node2:9092,node3:9092 --topic weblogs --from-beginning\n\n3：代码为：\nimport org.apache.kafka.common.serialization.StringDeserializer\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\nimport org.apache.spark.streaming.kafka010._\nimport org.apache.spark.streaming.kafka010.LocationStrategies.PreferConsistent\nimport org.apache.spark.streaming.kafka010.ConsumerStrategies.Subscribe\n\n\nobject StreamingKafka10 {\n    def main(args: Array[String]): Unit = {\n        val spark = SparkSession\n            .builder()\n            .master("local[2]")\n            .appName("HDFS")\n            .getOrCreate()\n\n        // 获取spark streaming context\n        val ssc = new StreamingContext(spark.sparkContext, Seconds(5))\n\n        val kafkaParams = Map[String, Object](\n            "bootstrap.servers" -### "node1:9092,node2:9092,node3:9092",\n            "key.deserializer" -### classOf[StringDeserializer],\n            "value.deserializer" -### classOf[StringDeserializer],\n            "group.id" -### "use_a_separate_group_id_for_each_stream",\n            "auto.offset.reset" -### "latest",\n            "enable.auto.commit" -### (false: java.lang.Boolean)\n        )\n\n        val topics = Array("weblogs")\n        val stream = KafkaUtils.createDirectStream[String, String](\n            ssc,\n            PreferConsistent,\n            Subscribe[String, String](topics, kafkaParams)\n        )\n        val lines = stream.map(record =### (record.value))\n        val words = lines.flatMap(_.split(" "))\n        val wordCounts = words.map(x =### (x, 1L)).reduceByKey(_+_)\n        wordCounts.print()\n\n        // 启动spark\n        ssc.start()\n        ssc.awaitTermination()\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br")])]),e("ul",[e("li",[s._v("输出结果")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("-------------------------------------------\nTime: 1567358570000 ms\n-------------------------------------------\n(python,2)\n(java,1)\n(nihao,1)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"三-最后检查发现-使用spark-streaming-kafka-0-10-kafka的2-1-1版本也可以被spark连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-最后检查发现-使用spark-streaming-kafka-0-10-kafka的2-1-1版本也可以被spark连接"}},[s._v("#")]),s._v(" (三)最后检查发现，使用spark-streaming-kafka-0-10，kafka的2.1.1版本也可以被spark连接")]),s._v(" "),e("ul",[e("li",[s._v("0-10的连接方式可以，0-8不行, 应该是被弃用了")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    <dependency>\n      <groupId>org.apache.spark</groupId>\n      <artifactId>spark-streaming-kafka-0-10_2.11</artifactId>\n      <version>2.1.1</version>\n    </dependency>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);