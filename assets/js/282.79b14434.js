(window.webpackJsonp=window.webpackJsonp||[]).push([[282],{1384:function(a,s,n){a.exports=n.p+"assets/img/2020-03-121.50.58.f3557651.png"},2469:function(a,s,n){"use strict";n.r(s);var e=n(9),t=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"一-tornado介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-tornado介绍"}},[a._v("#")]),a._v(" 一：Tornado介绍")]),a._v(" "),e("h3",{attrs:{id:"一-介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-介绍"}},[a._v("#")]),a._v(" "),e("code",[a._v("(一) 介绍")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("Tornado介绍：它是一个网络框架和高性能的网络库，支持异步非阻塞IO，基于epoll事件循环机制，协程提高了代码的可读性，使用于大量的连接请求，Websocket应用。企业一般使用Tornado做微服务的框架，tornado本身是基于协程的解决方案，而Flask或Django是同步框架\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"二-flask、django、tornado的区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-flask、django、tornado的区别"}},[a._v("#")]),a._v(" "),e("code",[a._v("(二) Flask、Django、Tornado的区别")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("1. tornado、gevent、asyncio、aiohttp：底层使用的是事件循环+协程\n\n2. django和flask： 传统的模型，阻塞io模型\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br")])]),e("h3",{attrs:{id:"三-web框架、wsgi、uwsgi、uwsgi、nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-web框架、wsgi、uwsgi、uwsgi、nginx"}},[a._v("#")]),a._v(" "),e("code",[a._v("(三) web框架、WSGI、uwsgi、uWSGI、nginx")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("1：WSGI：全称是Web Server Gateway Interface，WSGI不是服务器，python模块，框架，API或者任何软件，只是一种规范，描述web server如何与web application通信的规范。要实现WSGI协议，必须同时实现web server和web application，当前运行在WSGI协议之上的web框架有Bottle, Flask, Django\n\n2：uwsgi：与WSGI一样是一种通信协议，是uWSGI服务器的独占协议，用于定义传输信息的类型(type of information)\n\n3：uWSGI：是一个web服务器，实现了WSGI协议、uwsgi协议、http协议等\n\n4：WSGI协议主要包括server和application两部分\n\n5：WSGI server负责从客户端接收请求，将request转发给application，将application返回的response返回给客户端\n\n6：WSGI application接收由server转发的request，处理请求，并将处理结果返回给server。application中可以包括多个栈式的中间件(middlewares)，这些中间件需要同时实现server与application，因此可以在WSGI服务器与WSGI应用之间起调节作用：对服务器来说，中间件扮演应用程序，对应用程序来说，中间件扮演服务器\n\n7：WSGI协议其实是定义了一种server与application解耦的规范，即可以有多个实现WSGI server的服务器，也可以有多个实现WSGI application的框架，那么就可以选择任意的server和application组合实现自己的web应用。例如uWSGI和Gunicorn都是实现了WSGI server协议的服务器，Django，Flask是实现了WSGI application协议的web框架，可以根据项目实际情况搭配使用。\n\n8：wsgi 除了解析 http 协议以及 http 端口监听外，还负责了流量转发以及 wsgi application 进程管理的功能。一般 wsgi 框架内置的 wsgi server 都是一个单进程，一次只能处理一个请求。而目的通用的 wsgi server(gunicorn, uwsgi)都至少支持 pre fork 模型(pre fork是一个多进程+多线程模型)，这种模型会起一个 master 来侦听请求，并启动多个 slave(每个 slave 是一个 wsgi application)， master 负责把请求转发到空闲的 slave 上。除了这种传统的基于进程的 pre fork 同步模型，不同的 wsgi server 也会支持一些其它模型，有基于线程的同步模型，也有基于 asyncio 的异步模型\n\n9: 使用NGINX的目的\n\t1：负载均衡\n\t2：安全、流控\n\t3：提升Web服务器的IO性能:一个HTTP请求的数据，从客户端传输给服务器，是需要时间的，例如N秒，如果直接传给Web服务器，Web服务器就需要让一个进程阻塞N秒，来接收IO，这样会降低Web服务器的性能。如果使用反向代理服务器，先让反向代理服务器接收完整个HTTP请求，再把请求发给Web服务器，就能提升Web服务器的性能\n\t4：代理静态文件\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br")])]),e("h3",{attrs:{id:"四-django和flask如何编写异步代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-django和flask如何编写异步代码"}},[a._v("#")]),a._v(" "),e("code",[a._v("(四) Django和Flask如何编写异步代码")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("1. 直接用传统的异步编程(进程，线程，协程)\n\n2. 使用分布式异步编程，使用类似 celery 的方式，将需要异步处理的东西发送到 worker 去处理。\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br")])]),e("h3",{attrs:{id:"五-asyncio-vs-tornado"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-asyncio-vs-tornado"}},[a._v("#")]),a._v(" "),e("code",[a._v("(五)asyncio VS tornado")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("asyncio作为python的原始协程库，也是python最具野心和将来会重点打造的模块，asyncio提供了更多的基础功能，tornado是web服务器和web框架，两者原理是一样的\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"六-twisted框架"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六-twisted框架"}},[a._v("#")]),a._v(" "),e("code",[a._v("(六) twisted框架")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("这种模型和上面的传统模型处于一个时期，这种模型和 nodejs 差不多，都是基于回调的模型，适用于高 IO 低 CPU 的场景。这种模型自己实现了一个基于回调 http server(event loop)，每一个请求都被注册成一个异步函数来处理，然后主循环来不断的循环这些函数。这样就和 pre fork 模型有了区别， pre fork 模型中每一个 slave 都是一个 wsgi application ，一个 wsgi application 都只能处理一个请求，而回调模型只有一个线程，不仅极大的减少了内存的分配还减小了进城以及线程间的切换开销，从而可以支持高 IO 并发。但是这种模型也有很明显的缺点，就是一旦应用程序有大量的 CPU 计算，就会让这个线程堵住，所有的请求都会收到影响，如果应用在处理一个请求时崩溃，所有的请求也都会收到影响。\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"七-asyncio、tornado、gevent-这种模型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#七-asyncio、tornado、gevent-这种模型"}},[a._v("#")]),a._v(" "),e("code",[a._v("(七) asyncio、tornado、gevent 这种模型")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("因为回调的写法不易读也容易出错，于是将回调的写法改成了同步的写法。这种模型和 koa2 和 go net/http 查不多， asyncio 提供了类似 go coroutine 的功能和写法，而 aiohttp 则提供了类似 go 中的 net/http 的 http 处理库。\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"二-tornado编码介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-tornado编码介绍"}},[a._v("#")]),a._v(" 二：Tornado编码介绍")]),a._v(" "),e("h3",{attrs:{id:"一-tornado代码基本结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-tornado代码基本结构"}},[a._v("#")]),a._v(" "),e("code",[a._v("(一) Tornado代码基本结构")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('import tornado.ioloop\nimport tornado.web\n\n# 处理请求\nclass MainHandler(tornado.web.RequestHandler):\n    def get(self):\n        self.write("Hello, world")\n\nclass LoginHandler(tornado.web.RequestHandler):\n    def get(self):\n        self.write("Login To System!")\n\n# 处理路由\ndef make_app():\n    return tornado.web.Application([\n        (r"/", MainHandler),\n        (r"/login", LoginHandler),\n    ])\n\n\n\n\nif __name__ == "__main__":\n    # 创建httpserver\n    app = make_app()\n    app.listen(8888)\n    tornado.ioloop.IOLoop.current().start()\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br"),e("span",{staticClass:"line-number"},[a._v("25")]),e("br"),e("span",{staticClass:"line-number"},[a._v("26")]),e("br"),e("span",{staticClass:"line-number"},[a._v("27")]),e("br")])]),e("h2",{attrs:{id:"三-tornado-web框架的主要模块和同步请求代码结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-tornado-web框架的主要模块和同步请求代码结构"}},[a._v("#")]),a._v(" 三：Tornado Web框架的主要模块和同步请求代码结构")]),a._v(" "),e("h3",{attrs:{id:"一-tornado-web-主要模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-tornado-web-主要模块"}},[a._v("#")]),a._v(" "),e("code",[a._v("(一) Tornado web 主要模块")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("tornado.web下 Application 和 RequestHandler类用于处理HTTP路由和请求\n\ntornado.template 模板渲染\n\ntornado.routing 处理路由\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("h3",{attrs:{id:"二-同步请求的代码结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-同步请求的代码结构"}},[a._v("#")]),a._v(" "),e("code",[a._v("(二) 同步请求的代码结构")])]),a._v(" "),e("p",[e("img",{attrs:{src:n(1384),alt:"Alt text"}})]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('import tornado.ioloop\nimport tornado.web\nimport os\n\n\nclass MainHandler(tornado.web.RequestHandler):\n    def get(self):\n        self.render(\'base.html\')\n\n\nclass LoginHandler(tornado.web.RequestHandler):\n    def get(self):\n        # msg是给模板传递的变量\n        self.render("index.html", msg="这里是首页")\n\n\ndef make_app():\n    # 第一个参数是handler， 第二个参数是template路径，第三个是debug\n    return tornado.web.Application([(r"/", MainHandler),\n        (r"/login", LoginHandler), ],\n        template_path=os.path.join(os.path.dirname(__file__), "template"),\n        debug=True)\n\n\nif __name__ == "__main__":\n    app = make_app()\n    app.listen(8888)\n    tornado.ioloop.IOLoop.current().start()\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br"),e("span",{staticClass:"line-number"},[a._v("25")]),e("br"),e("span",{staticClass:"line-number"},[a._v("26")]),e("br"),e("span",{staticClass:"line-number"},[a._v("27")]),e("br"),e("span",{staticClass:"line-number"},[a._v("28")]),e("br")])]),e("h2",{attrs:{id:"四-tornado-web-异步请求代码结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四-tornado-web-异步请求代码结构"}},[a._v("#")]),a._v(" 四：Tornado Web 异步请求代码结构")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('import tornado.ioloop\nimport tornado.web\nimport datetime\n\n\nclass MainHandler(tornado.web.RequestHandler):\n    # 加入携程方法\n    @tornado.gen.coroutine\n    def get(self):\n        yield tornado.gen.sleep(5)\n        self.write(str(datetime.datetime.now()))\n\n\ndef make_app():\n    return tornado.web.Application([(r"/", MainHandler)])\n\n\nif __name__ == "__main__":\n    app = make_app()\n    app.listen(9999)\n    tornado.ioloop.IOLoop.current().start()\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br")])]),e("h2",{attrs:{id:"五-tornado-ioloop-时间循环、tornado-iostream-非阻塞socket封装、tornado-tcpserver-、tornador-tcpclient"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-tornado-ioloop-时间循环、tornado-iostream-非阻塞socket封装、tornado-tcpserver-、tornador-tcpclient"}},[a._v("#")]),a._v(" 五：tornado.ioloop 时间循环、tornado.iostream 非阻塞socket封装、tornado.tcpserver 、tornador.tcpclient")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("这里需要补充\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);