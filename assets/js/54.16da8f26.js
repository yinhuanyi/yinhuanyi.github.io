(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{1585:function(s,a,e){s.exports=e.p+"assets/img/2019-08-215.53.38.df02d0f4.png"},1586:function(s,a,e){s.exports=e.p+"assets/img/2019-08-215.54.46.2511ed2d.png"},1587:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.18.00.ff293f48.png"},1588:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.19.32.0c04eb8a.png"},1589:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.33.04.d64f9054.png"},1590:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.34.18.d22ec4c2.png"},1591:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.37.35.a1a438e3.png"},1592:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.37.30.914f23ce.png"},1593:function(s,a,e){s.exports=e.p+"assets/img/2019-08-216.40.31.84dfa332.png"},2599:function(s,a,e){"use strict";e.r(a);var n=e(9),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"一-编写一个读取文件内容再写入的jar包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-编写一个读取文件内容再写入的jar包"}},[s._v("#")]),s._v(" 一：编写一个读取文件内容再写入的jar包")]),s._v(" "),n("h3",{attrs:{id:"一-工程创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-工程创建"}},[s._v("#")]),s._v(" (一)工程创建")]),s._v(" "),n("ul",[n("li",[s._v("New -### Project")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1585),alt:"Alt text"}})]),s._v(" "),n("p",[n("img",{attrs:{src:e(1586),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("File -### Project Structure, 选择module，在src目录下创建一个main目录, 在main目录下创建java目录和一个resource目录，把java 目录标记为Sources， 把resource目录标记为Resources")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1587),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("在java目录下就可以创建类，resource为配置文件目录")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1588),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("代码如下：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import java.io.*;\n/**\n * Description:\n * Author:         Robby\n * CreateDate:     2019-08-21 18:19\n * Version:        1.0.0\n */\n\npublic class LogReadWrite {\n    static String readFileName;\n    static String writeFileName;\n\n    public static void main(String args[]){\n        // 第一个参数\n        readFileName = args[0];\n        // 第二个参数\n        writeFileName = args[1];\n        try {\n            readFileByLines(readFileName);\n        }catch(Exception e){\n\n        }\n    }\n\n    // 从文件中读取\n    public static void readFileByLines(String fileName) {\n        FileInputStream fis = null;\n        InputStreamReader isr = null;\n        BufferedReader br = null;\n        String tempString = null;\n\n        try {\n            System.out.println("以行为单位读取文件内容，一次读一整行：");\n            fis = new FileInputStream(fileName);// FileInputStream\n            // 从文件系统中的某个文件中获取字节\n            isr = new InputStreamReader(fis,"GBK");\n            br = new BufferedReader(isr);\n            int count=0;\n            while ((tempString = br.readLine()) != null) {\n                count++;\n                // 显示行号\n                Thread.sleep(300);\n                String str = new String(tempString.getBytes("UTF8"),"GBK");\n                System.out.println("row:"+count+">>>>>>>>"+tempString);\n                method1(writeFileName,tempString);\n                //appendMethodA(writeFileName,tempString);\n            }\n            isr.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } finally {\n            if (isr != null) {\n                try {\n                    isr.close();\n                } catch (IOException e1) {\n                }\n            }\n        }\n    }\n    // 写入到文件\n    public static void method1(String file, String conent) {\n        BufferedWriter out = null;\n        try {\n            out = new BufferedWriter(new OutputStreamWriter(\n                    new FileOutputStream(file, true)));\n            out.write("\\n");\n            out.write(conent);\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                out.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br")])]),n("h3",{attrs:{id:"二-项目打包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二-项目打包"}},[s._v("#")]),s._v(" (二)项目打包")]),s._v(" "),n("ul",[n("li",[s._v("选择Project Structure")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1589),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("选择工程的main方法，点击OK")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1590),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("开始构建工程")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1591),alt:"Alt text"}})]),s._v(" "),n("p",[n("img",{attrs:{src:e(1592),alt:"Alt text"}})]),s._v(" "),n("ul",[n("li",[s._v("获得构建好的jar包")])]),s._v(" "),n("p",[n("img",{attrs:{src:e(1593),alt:"Alt text"}})]),s._v(" "),n("h3",{attrs:{id:"三-jar包上传-且运行flume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三-jar包上传-且运行flume"}},[s._v("#")]),s._v(" (三)jar包上传, 且运行flume")]),s._v(" "),n("ul",[n("li",[s._v("1：上传jar包到/opt/jars, 编写weblog-shell.sh脚本")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#!/bin/bash\necho "start log..."\n\njava -jar /opt/jars/data-transform.jar /opt/datas/user.log /opt/datas/weblogs.log\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[s._v("2：在3台节点上，在apache-flume-1.7.0-bin目录下创建flume启动脚本flume-agent-start.sh")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#!/bin/bash\n\necho "flume-2 start ...."\n# conf为配置文件所在目录，agent2为进程别名，INFO,console为日志级别\nflume-ng agent --conf conf -f conf/flume-conf.properties -n agent2 -Dflume.root.logger=INFO,console\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[s._v("3: 在3台节点上创建一个/opt/modules/apache-flume-1.7.0-bin/logs目录，用于存放flume自己的日志, 且修改配置文件log4j.properties, 指定flume.log.dir=/opt/modules/apache-flume-1.7.0-bin/logs")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mkdir /opt/modules/apache-flume-1.7.0-bin/logs\n\nvi log4j.properties\nflume.log.dir=/opt/modules/apache-flume-1.7.0-bin/logs\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"二-kafka运行脚本的编写"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二-kafka运行脚本的编写"}},[s._v("#")]),s._v(" 二：Kafka运行脚本的编写")]),s._v(" "),n("h3",{attrs:{id:"一-消费者端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-消费者端"}},[s._v("#")]),s._v(" (一)消费者端")]),s._v(" "),n("ul",[n("li",[s._v("3台节点上，vi kfk-test-comsumer.sh 脚本")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#!/bin/bash\necho "kafka-comsumer start..."\n\nkafka-console-consumer.sh --zookeeper node1:2181,node2:2181,node3:2181 --from-beginning --topic test\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"三-启动服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三-启动服务"}},[s._v("#")]),s._v(" 三：启动服务")]),s._v(" "),n("h3",{attrs:{id:"一-启动zookeeper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一-启动zookeeper"}},[s._v("#")]),s._v(" (一)启动zookeeper")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("zkServer.sh start\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"二-将hadoop的配置文件-切换为ha的配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二-将hadoop的配置文件-切换为ha的配置"}},[s._v("#")]),s._v(" (二)将hadoop的配置文件，切换为HA的配置")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cd /opt/modules/hadoop-2.5.0-cdh5.3.5/etc\nmv hadoop hadoop-dist\nmv hadoop_ha hadoop\ncd /opt/modules/hadoop-2.5.0-cdh5.3.5/data\nmv tmp tmp-dist\nmv tmp_ha tmp\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"三-启动hdfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三-启动hdfs"}},[s._v("#")]),s._v(" (三)启动hdfs")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("start-dfs.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("此时node1和node2的namenode都是standby\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("如果发现namenode启动不了，可能是因为tmp目录不一致的问题，那么在生产环境中，一般都是进行同步: hdfs zkfc –formatZK, 不能直接格式化namenode，数据不能丢\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"四-启动zkfc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四-启动zkfc"}},[s._v("#")]),s._v(" (四)启动zkfc")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("hadoop-daemon.sh start zkfc\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node1的namenode为active状态\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"五-启动hbase"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五-启动hbase"}},[s._v("#")]),s._v(" (五)启动Hbase")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("start-hbase.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("这里发现有问题：Call From node1/192.168.43.201 to node1:9000 failed on connection exception\n因为hbase的数据需要存放到hdfs上，配置高可用时，namenode监听的端口为8020，而hbase的口为9000, 所以需要修改一下hdfs-site.xml中dfs.namenode.rpc-address.mycluster.nn2配置项的端口，改为9000即可，三台节点都要改\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("解决办法")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1: 把所有的服务全部停止\n\n2: 如果再启动服务依然有问题，用zookeeper客户端连接到服务端，将hadoop-ha和hbase的节点删除掉\n\t先启动3台节点的zookeeper服务：zkServer.sh start\n\t使用客户端连接到服务端：zkCli.sh\n\t\tls /\n\t\trmr /hadoop-ha\n\t\trmr /hbase\n\t\tls /\n\t初始化zkfc\n\t\thdfs zkfc -formatZK\n\n3：启动hdfs、zkfc\nstart-dfs.sh\nhadoop-daemon.sh start zkfc\n\n4: 再启动hbase\nstart-hbase.sh\n\n5：由于hbase的master只在node1上有，那么必须保证node1的namenode是active状态，这样才能启动hbase\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h3",{attrs:{id:"六-启动kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六-启动kafka"}},[s._v("#")]),s._v(" (六)启动Kafka")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cd /opt/modules/kafka_2.11-2.1.1\nkafka-server-start.sh -daemon  config/server.properties\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("出现的问题(kafka内存分配不足)")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("OpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000c0000000, 1073741824, 0) failed; error='Cannot allocate memory' (errno=12)\n\n\nvi kafka-server-start.sh 修改\nexport KAFKA_HEAP_OPTS=\"-Xmx256M -Xms128M\"\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ul",[n("li",[s._v("可以从zookeeper里面查看到broker创建的topic，也可以直接删除")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("zkCli.sh\nls /brokers/topics\n# 删除topic\nrmr /brokers/topics/test_topic\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("新建topic(topic会直接写入到zookeeper文件树中)")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 这里的replication-factor副本数为3，那么表示每一台kafka都可以对外提供服务，在kafka的数据目录中，就会存在一个topic的目录，当其中一台kafka宕机，zookeeper会从集群中选择出另外一台作为leader\nkafka-topics.sh --create --zookeeper node1:2181,node2:2181,node3:2181 --replication-factor 3 --partitions 1 --topic weblogs\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"七-在hbase里创建数据表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#七-在hbase里创建数据表"}},[s._v("#")]),s._v(" (七)在hbase里创建数据表")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1：hbase shell\n\n# weblogs为表名，info为列簇名\n2：create 'weblogs','info'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"八-在node2、node3让日志写入程序跑起来"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#八-在node2、node3让日志写入程序跑起来"}},[s._v("#")]),s._v(" (八)在node2、node3让日志写入程序跑起来")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("bash weblog-shell.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"九-3台节点启动flume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#九-3台节点启动flume"}},[s._v("#")]),s._v(" (九)3台节点启动flume")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("bash flume-agent-start.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"十-启动kafka消费者查看数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#十-启动kafka消费者查看数据"}},[s._v("#")]),s._v(" (十)启动kafka消费者查看数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server node1:9092,node2:9092,node3:9092 --topic weblogs --from-beginning \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("效果如下")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("00:00:19,024698169835737416,[哄抢救灾物资],4,5,news.vnet.cn/photo/292_6.html\n00:00:19,8630914116365915,[珠海健康中心],4,10,74.53.27.4/~xx4ucom/bbs/simple/index.php?t66868.html\n00:00:19,25310394112221795,[何鸿燊+生平],1,1,www.myxingming.com/mingrendetails/???\\xa8\\xa6?????\n00:00:19,34694947229053685,[谷歌地球卫星地图],2,1,www.hzlive.com.cn/post/174.html\n00:00:20,9994672352241558,[高级妓女],5,215,ks.cn.yahoo.com/question/?source=ycont_ncp_ks&qid=1307081303571\n00:00:20,668148843145828,[哄抢救灾物资],2,1,pic.news.mop.com/gs/2008/0528/12985.shtml\n00:00:20,4174350124550614,[科比81分视频],3,5,www.bbboo.com/Video/NBAstar/Kobe/20060128105058_277.shtml\n00:00:20,4115160967130532,[家庭大夫],1,1,www.powercrm.net/fuchanke/fuchanke26387.html\n00:00:20,6833855966518663,[三国之见龙卸甲影片],8,1,www.29192.com/zhanzhengpian/sanguozhijianlongxiejiazaixianbofang.html\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"十一-查看hbase数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#十一-查看hbase数据"}},[s._v("#")]),s._v(" (十一)查看hbase数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("hbase shell \nhbase(main):001:0### count 'weblogs'\n=### 1231\nhbase(main):001:0### scan 'weblogs'\n 4130712590473535-00:00:10-1566407116855              column=info:cliorder, timestamp=1566407117060, value=1                                                                                                       \n 4130712590473535-00:00:10-1566407116855              column=info:cliurl, timestamp=1566407117062, value=www.whfoxconn.cn/                                                                                         \n 4130712590473535-00:00:10-1566407116855              column=info:datatime, timestamp=1566407117050, value=00:00:10                                                                                                \n 4130712590473535-00:00:10-1566407116855              column=info:retorder, timestamp=1566407117082, value=1 \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);