(window.webpackJsonp=window.webpackJsonp||[]).push([[564],{2580:function(n,a,s){"use strict";s.r(a);var e=s(9),t=Object(e.a)({},(function(){var n=this,a=n.$createElement,s=n._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h3",{attrs:{id:"一-标量函数-scalarfunction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一-标量函数-scalarfunction"}},[n._v("#")]),n._v(" 一：标量函数（ScalarFunction）")]),n._v(" "),s("ul",[s("li",[n._v("PyFlink支持在Python Table API程序中使用Python标量函数。 如果要定义Python标量函数， 可以继承pyflink.table.udf中的基类ScalarFunction，并实现eval方法。 Python标量函数的行为由名为eval的方法定义，eval方法支持可变长参数，例如eval(* args)。")])]),n._v(" "),s("p",[n._v("以下示例显示了如何定义自己的Python哈希函数、如何在TableEnvironment中注册它以及如何在作业中使用它。")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('class HashCode(ScalarFunction):\n  def __init__(self):\n    self.factor = 12\n\n  def eval(self, s):\n    return hash(s) * self.factor\n\ntable_env = BatchTableEnvironment.create(env)\n\n# Python worker进程默认使用off-heap内存，配置当前taskmanager的off-heap内存大小\ntable_env.get_config().get_configuration().set_string("taskmanager.memory.task.off-heap.size", \'80m\')\n\n# 注册Python自定义函数\ntable_env.register_function("hash_code", udf(HashCode(), DataTypes.BIGINT(), DataTypes.BIGINT()))\n\n# 在Python Table API中使用Python自定义函数\nmy_table.select("string, bigint, bigint.hash_code(), hash_code(bigint)")\n\n# 在SQL API中使用Python自定义函数\ntable_env.sql_query("SELECT string, bigint, hash_code(bigint) FROM MyTable")\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);