(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{1036:function(s,n,a){s.exports=a.p+"assets/img/2018-08-178.56.17.d5d3dc93.png"},1037:function(s,n,a){s.exports=a.p+"assets/img/2018-08-1710.47.29.cff42e44.png"},1038:function(s,n,a){s.exports=a.p+"assets/img/2018-08-172.00.02.56cceb20.png"},1039:function(s,n,a){s.exports=a.p+"assets/img/2018-08-174.55.53.6edfd800.png"},1040:function(s,n,a){s.exports=a.p+"assets/img/2018-08-189.08.10.374529b6.png"},2407:function(s,n,a){"use strict";a.r(n);var e=a(9),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"十六-机构课程页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十六-机构课程页面的开发"}},[s._v("#")]),s._v(" （十六）"),e("strong",[e("code",[s._v("机构课程页面的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1036),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("首先将org-detail-course.html页面拷贝到templates中，让其继承org_base.html页面。因为只是右边不一样，所以只要找到右边不一样的部分，拷贝到{% block right_form %}即可")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends \'org_base.html\' %}\n{% load staticfiles %}\n{% block title %}\n    机构课程\n{% endblock %}\n\n{% block page_path %}\n    机构课程\n{% endblock %}\n\n\x3c!-- 替换右边 --\x3e\n{% block right_form %}\n    <div class="right companycenter layout">\n\n        <div class="head">\n            <h1>机构课程</h1>\n        </div>\n\n        <div class="brief group_list">\n            \x3c!-- 开始遍历课程 --\x3e\n            {% for course in all_courses %}\n            <div class="module1_5 box">\n                <a class="comp-img-box" href="/group/groupdetail/13/">\n\n                    <img width="214" height="195" src="{{ MEDIA_URL }}{{ course.image }}"/>\n                </a>\n                <div class="des">\n                    <a href="/group/groupdetail/13/"><h2>{{ course.name }}</h2></a>\n                    <span class="fl">课时：<i class="key">{{ course.learn_times }}</i></span>\n                    <span class="fr">学习人数：{{ course.students }}</span>\n                </div>\n                <div class="bottom">\n                    <span class="fl">{{ course.course_org }}</span>\n                    <span class="star fr  notlogin\n                            " data-favid="13" data-fav-type="4">\n                            {{ course.fav_num }}\n                        </span>\n                </div>\n            </div>\n            {% endfor %}\n\n        </div>\n\n        <div class="pageturn">\n            <ul class="pagelist">\n                <li class="active"><a href="?page=1">1</a></li>\n            </ul>\n        </div>\n\n    </div>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br")])]),e("ul",[e("li",[s._v("编写views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 机构课程处理逻辑\nclass OrgCourseView(View):\n    def get(self,request, org_id):\n\t    # 让左边的tab栏可以显示被选中\n        current_page = \'course\'\n        # 拿到这条机构的记录\n        course_org = CourseOrg.objects.get(id=int(org_id))\n        # TODO：这里是Django的一个特点，如果一个 model—A 使用了外键关联另外一个 model-B，那么model-B 就可以通过这个model的course_set.all() 拿到所有model—A的记录\n        all_courses = course_org.course_set.all()  # 取到在org_id机构中的课程记录\n\n        # 保持收藏在刷新的时候不变化\n        fav_status = False\n        if request.user.is_authenticated():  # 如果用户登录了\n            print(\'用户登录\')\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(org_id), fav_type=2):  # 如果已经被这个用户收藏\n                fav_status = True\n        return render(request, \'org-detail-course.html\', {\n            "all_courses": all_courses,\n            "course_org": course_org,\n            "current_page": current_page,\n            "fav_status": fav_status,\n        })\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("ul",[e("li",[s._v("修改urls.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^course/(?P<org_id>\\d+)/', OrgCourseView.as_view(), name='org_course'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("修改org_base.py文件的跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li {% ifequal current_page "course" %} class="active2" {% endifequal %}><a href="{% url \'org:org_course\' course_org.id %}">机构课程</a></li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"十七-机构介绍页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十七-机构介绍页面的开发"}},[s._v("#")]),s._v(" （十七）"),e("strong",[e("code",[s._v("机构介绍页面的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1037),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("将org-detail-desc.html拷贝到templates目录下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends \'org_base.html\' %}\n{% load staticfiles %}\n{% block title %}\n    机构介绍\n{% endblock %}\n\n{% block page_path %}\n    机构介绍\n{% endblock %}\n\n\x3c!-- 替换右边 --\x3e\n{% block right_form %}\n    <div class="right companycenter layout">\n        <div class="head">\n            <h1>机构介绍</h1>\n        </div>\n        <div class="des">\n            <p>&nbsp; &nbsp; {{ course_org.name }}</p>\n            <p>&nbsp; &nbsp;{{ course_org.desc }}</p>\n            <p><br/></p>\n        </div>\n    </div>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("ul",[e("li",[s._v("编写views.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 机构介绍处理逻辑\nclass OrgDescView(View):\n    def get(self,request, org_id):\n        current_page = 'desc'\n        # 拿到这条机构的记录\n        course_org = CourseOrg.objects.get(id=int(org_id))\n\n        # 保持收藏在刷新的时候不变化\n        fav_status = False\n        if request.user.is_authenticated():  # 如果用户登录了\n            print('用户登录')\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(org_id), fav_type=2):  # 如果已经被这个用户收藏\n                fav_status = True\n\n        return render(request, 'org-detail-desc.html', {\n            \"course_org\": course_org,\n            \"current_page\": current_page,\n            \"fav_status\": fav_status,\n        })\n\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("ul",[e("li",[s._v("编写urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^desc/(?P<org_id>\\d+)/', OrgDescView.as_view(), name='org_desc'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("修改org_base.py文件的跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li {% ifequal current_page "desc" %} class="active2" {% endifequal %}><a href="{% url \'org:org_desc\' course_org.id %}">机构介绍</a### </li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"十八-机构讲师页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十八-机构讲师页面的开发"}},[s._v("#")]),s._v(" （十八）"),e("strong",[e("code",[s._v("机构讲师页面的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("将org-detail-techers.html拷贝到templates目录中")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends \'org_base.html\' %}\n{% load staticfiles %}\n{% block title %}\n    机构讲师\n{% endblock %}\n\n{% block page_path %}\n    机构讲师\n{% endblock %}\n\n\x3c!-- 替换右边 --\x3e\n{% block right_form %}\n    <div class="right companycenter layout">\n        <div class="head">\n            <h1>讲师介绍</h1>\n        </div>\n        {% for teacher in all_teachers %}\n\n            <div class="messagelist">\n                <div class=" butler_list butler-fav-box">\n                    <dl class="des users">\n                        <dt>\n                            <a href="">\n                                <img width="100" height="100" class="scrollLoading"\n                                     data-url="{{ MEDIA_URL }}{{ teacher.image }}"\n                                     src="{{ MEDIA_URL }}{{ teacher.image }}"/>\n                            </a>\n                        </dt>\n                        <dd>\n                            <h1>\n                                <a href="">\n                                    {{ teacher.name }}<span class="key">已认证</span>\n                                </a>\n                            </h1>\n                            <ul class="cont clearfix">\n                                <li class="time">工作年限：<span>{{ teacher.work_years }}年</span></li>\n                                <li class="c7">课程数：<span>{{ teacher.class_num }}</span></li>\n                            </ul>\n                        </dd>\n                    </dl>\n                </div>\n            </div>\n        {% endfor %}\n\n    </div>\n{% endblock %}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br")])]),e("ul",[e("li",[s._v("编写views.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 机构讲师处理逻辑\nclass OrgTeacherView(View):\n    def get(self,request, org_id):\n        current_page = \'teacher\'\n        # 拿到这条机构的记录\n        course_org = CourseOrg.objects.get(id=int(org_id))\n        all_teachers = course_org.teacher_set.all()  # 取到在org_id机构中的老师\n\n        # 保持收藏在刷新的时候不变化\n        fav_status = False\n        if request.user.is_authenticated():  # 如果用户登录了\n            print(\'用户登录\')\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(org_id), fav_type=2):  # 如果已经被这个用户收藏\n                fav_status = True\n\n        return render(request, \'org-detail-teachers.html\', {\n            "all_teachers": all_teachers,\n            "course_org": course_org,\n            "current_page": current_page,\n            "fav_status": fav_status,\n        })\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("ul",[e("li",[s._v("编写urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^teacher/(?P<org_id>\\d+)/', OrgTeacherView.as_view(), name='org_teacher'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("修改org_base.html")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li {% ifequal current_page "teacher" %} class="active2" {% endifequal %}><a href="{% url \'org:org_teacher\' course_org.id %}">机构讲师</a></li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"十九-对用户收藏按钮的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十九-对用户收藏按钮的开发"}},[s._v("#")]),s._v(" （十九）"),e("strong",[e("code",[s._v("对用户收藏按钮的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1038),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("对应用户收藏的业务逻辑是这样的：收藏按钮使用的是ajax方式提交，当用户点击了收藏按钮之后，对后台发送ajax请求，后台首先应该对用户判断是否登录，如果没有登录，那么直接跳转到登录页面。如果用户登录了，那么直接带字段查询数据库，如果记录以及存在，那么删除，表示用户取消收藏。如果记录不存在，那么直接添加即可。最后后台需要在机构首页、机构课程、机构介绍、结构讲师四个页面中都返回用户是否收藏的值，前端页面需要显示")]),s._v(" "),e("li",[s._v("首先编写views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 收藏与取消收藏处理逻辑, ajax异步提交\nclass AddFavView(View):\n    # 用户收藏\n    def post(self, request):\n\n        # 获取喜欢的类型和id值，注意request中的值都是字符串\n        fav_id = request.POST.get('fav_id', 0)\n        fav_type = request.POST.get('fav_type', 0)\n\n        # 判断用户是否已经登入\n        if not request.user.is_authenticated():\n            error = {'status': 'fail', 'msg': '您还未登入，请先登录'}\n            # 这里将用户跳转到登录页面是在ajax中处理的，我们这只返回json对象, 如果状态是fail的，那么ajax将会跳转到导入页面\n            return HttpResponse(json.dumps(error), content_type=\"application/json\")\n        else:\n            exist_records = UserFavorite.objects.filter(user=request.user, fav_id=int(fav_id), fav_type=int(fav_type))\n            if exist_records:\n                exist_records.delete()# 如果收藏的记录已经存在，可以认为用户想取消收藏，因此删除记录即可\n\n                 # 如果删除了对应类型的收藏，直接在对应的收藏数上减一\n                if int(fav_type) == 1:\n                    course = Course.objects.get(id=int(fav_id))\n                    course.fav_num -= 1\n                    course.save()\n\n                elif int(fav_type) == 2:\n                    org = CourseOrg.objects.get(id=int(fav_id))\n                    org.fav_nums -= 1\n                    org.save()\n\n                elif int(fav_type) == 3:\n                    teacher = Teacher.objects.get(id=int(fav_id))\n                    teacher.fav_nums -= 1\n                    teacher.save()\n\n                error = {'status': 'fail', 'msg': '收藏'}\n                # 这里将用户跳转到登录页面是在ajax中处理的，我们这只返回json对象, 如果状态是fail的，那么ajax将会跳转到导入页面\n                return HttpResponse(json.dumps(error), content_type=\"application/json\")\n\n            else:\n                user_fav = UserFavorite()\n                if int(fav_id) ### 0 and int(fav_type) >0:\n                    user_fav.user = request.user\n                    user_fav.fav_id = int(fav_id)\n                    user_fav.fav_type = int(fav_type)\n                    user_fav.save()\n\n                    # 如果添加了记录，那么就在收藏数上加一\n                    if int(fav_type) == 1:\n                        course = Course.objects.get(id=int(fav_id))\n                        course.fav_num += 1\n                        course.save()\n\n                    elif int(fav_type) == 2:\n                        org = CourseOrg.objects.get(id=int(fav_id))\n                        org.fav_nums += 1\n                        org.save()\n\n                    elif int(fav_type) == 3:\n                        teacher = Teacher.objects.get(id=int(fav_id))\n                        teacher.fav_nums += 1\n                        teacher.save()\n\n                    success = {'status': 'success', 'msg': '已收藏'}\n                    return HttpResponse(json.dumps(success), content_type=\"application/json\")\n                else:\n                    error = {'status': 'fail', 'msg': '收藏失败'}\n                    # 这里将用户跳转到登录页面是在ajax中处理的，我们这只返回json对象, 如果状态是fail的，那么ajax将会跳转到导入页面\n                    return HttpResponse(json.dumps(error), content_type=\"application/json\")\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br")])]),e("ul",[e("li",[s._v("编写urls.py路由")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^add_fav/', AddFavView.as_view(), name='add_fav'),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("在org_base.html页面中编写ajax函数")])]),s._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 被调用的ajax请求函数")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("add_fav")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("current_elem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fav_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fav_type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ajax")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            cache"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'POST'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            url"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{% url 'org:add_fav' %}\"")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            data"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fav_id'")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" fav_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fav_type'")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" fav_type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            async"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            dataType"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("beforeSend")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("xhr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" settings")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                xhr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("setRequestHeader")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"X-CSRFToken"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ csrf_token }}"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 其实在这里，如果按钮使用的form标签包裹起来的话，也可以在form中使用csrf_token即可")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("success")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fail"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msg "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'您还未登入，请先登录'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("href "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/login/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n                        current_elem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("text")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    current_elem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("text")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("error")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'请求数据失败'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 监听收藏按钮的点击事件")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('".collectionbtn"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'click'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add_fav")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" course_org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 由于这里是开发的授课机构，所以fav_type为2，收藏的是授课结构")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br")])]),e("h3",{attrs:{id:"二十-公开课页面列表页的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十-公开课页面列表页的开发"}},[s._v("#")]),s._v(" （二十）"),e("strong",[e("code",[s._v("公开课页面列表页的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1039),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("将course-list.html拷贝到templates目录下")]),s._v(" "),e("li",[s._v("编辑settings的urls.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("url(r'^course/', include('courses.urls',namespace=\"courses\")),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("在course这个APP下面创建urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("from django.conf.urls import url\nfrom .views import CourseListView\n\n\nurlpatterns = [\n    url(r'^list/', CourseListView.as_view(), name=\"course_list\"),\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('from django.shortcuts import render\nfrom django.views.generic import View\nfrom .models import Course, Video\nfrom django.db.models import Q\nfrom pure_pagination import Paginator, EmptyPage, PageNotAnInteger\n\n\nclass CourseListView(View):\n    def get(self, request):\n        all_courses = Course.objects.all()  # 在数据库获取所有的课程记录\n        hot_courses = Course.objects.all().order_by("-click_nums")[:4]\n        # todo：实现课程基于关键字搜索的功能（需求掌握ES的搜索）\n        search_keywords = request.GET.get("keywords", "")\n        if search_keywords:\n            all_courses = all_courses.filter(Q(name__icontains=search_keywords)|Q(desc__icontains=search_keywords)|Q(detail__icontains=search_keywords))\n        # 对最新和参与人数 排序的查询请求处理\n        sort = request.GET.get(\'sort\', "new")\n        if sort == \'hot\':\n            all_courses = all_courses.order_by("-click_nums")\n        elif sort == \'students\':\n            all_courses = all_courses.order_by("-students")\n        else:\n            all_courses = all_courses.order_by("-add_time")\n        # 对课程机构进行分页\n        try:  # 默认是第一页，如果有page参数，那么page就是传递进来的参数\n            page = request.GET.get(\'page\', 1)\n        except PageNotAnInteger:\n            page = 1\n        p = Paginator(all_courses, per_page=6, request=request)  # 通过所有机构的记录创建分页器\n        courses = p.page(page)  # 翻页器默认从第一页显示\n        return render(request, \'course-list.html\', {\n            "all_courses": courses,\n            "sort": sort,\n            "hot_courses": hot_courses,\n        })\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br")])]),e("ul",[e("li",[s._v("编辑course-list.html")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\x3c!--  --\x3e\n{% extends "base.html" %}\n{% load staticfiles %}\n{% block title %} 公开课 {% endblock %}\n\n\x3c!-- 面包屑部分 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <ul class="crumbs">\n                <li><a href="/">首页</a>></li>\n                <li>公开课</li>\n            </ul>\n        </div>\n    </section>\n{% endblock %}\n\n{% block content %}\n    <section>\n        <div class="wp">\n            <div class="list" style="margin-top:0;">\n                \x3c!-- 左边是公开课列表 --\x3e\n                <div class="left layout">\n                    \x3c!-- 头部 --\x3e\n                    <div class="head">\n                        <ul class="tab_header">\n                            <li {% if sort == "new" %}  class="active" {% endif %}><a href="?sort=new">最新 </a></li>\n                            <li {% if sort == "hot" %}  class="active" {% endif %}><a href="?sort=hot">最热门</a></li>\n                            <li {% if sort == "students" %}  class="active" {% endif %}><a\n                                    href="?sort=students">参与人数</a></li>\n                        </ul>\n                    </div>\n                    \x3c!-- 课程列表 --\x3e\n                    <div id="inWindow">\n                        <div class="tab_cont " id="content">\n                            <div class="group_list">\n                                {% for course in all_courses.object_list %}\n                                    <div class="box">\n                                        <a href="">\n                                            <img width="280" height="350" class="scrollLoading"\n                                                 data-url="{{ MEDIA_URL }}{{ course.image }}"\n                                                 src="{% static \'images/pixel.gif\' %}"/>\n                                        </a>\n                                        <div class="des">\n                                            <a href="">\n                                                <h2>{{ course.name }}</h2>\n                                            </a>\n                                            <span class="fl">时长：<i class="key">{{ course.learn_times }}</i></span>\n                                            <span class="fr">学习人数：{{ course.students }}&nbsp;&nbsp;</span>\n                                        </div>\n                                        <div class="bottom">\n                                            <a href="org-detail-homepage.html"><span\n                                                    class="fl">{{ course.course_org }}</span></a>\n                                            <span class="star fr  notlogin\n                                        " data-favid="15">\n                                        {{ course.fav_num }}\n                                    </span>\n                                        </div>\n                                    </div>\n                                {% endfor %}\n                            </div>\n\n                            \x3c!-- 底部分页需要看看官方文档： https://pypi.python.org/pypi/django-pure-pagination --\x3e\n                            <div class="pageturn">\n\n                                \x3c!-- 显示前一页 --\x3e\n                                {% if all_courses.has_previous %}\n\n                                    <li class="long" style="list-style: none">\n                                        <a href="?{{ all_courses.previous_page_number.querystring }}">上一页</a>\n                                    </li>\n                                {% endif %}\n\n                                \x3c!-- 显示中间的页面 --\x3e\n                                {% for page in all_courses.pages %}\n                                    {% if page %}\n                                        {% ifequal page all_courses.number %}\n                                            <li class="active" style="list-style: none">\n                                                <a>{{ page }}</a>\n                                            </li>\n                                        {% else %}\n                                            <li class="page" style="list-style: none">\n                                                <a href="?{{ page.querystring }}">{{ page }}</a>\n                                            </li>\n                                        {% endifequal %}\n                                    {% else %}\n                                        <li class="none" style="list-style: none">\n                                            <a href="">...</a>\n                                        </li>\n                                    {% endif %}\n                                {% endfor %}\n\n                                \x3c!-- 显示末尾页面 --\x3e\n                                {% if all_courses.has_next %}\n                                    <li class="long" style="list-style: none">\n                                        <a href="?{{ all_courses.next_page_number.querystring }}">下一页</a>\n                                    </li>\n\n                                {% endif %}\n\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- 右边是热门课程推荐列表 --\x3e\n                <div class="right layout">\n                    <div class="head">热门课程推荐</div>\n\n                    <div class="group_recommend">\n\n                        \x3c!-- 开始遍历热门课程 --\x3e\n                        {% for course in hot_courses %}\n                            <dl>\n                                <dt>\n                                    <a target="_blank" href="{{ ecmall_ad.url }}">\n                                        <img width="240" height="220" class="scrollLoading"\n                                             data-url="{{ MEDIA_URL }}{{ course.image }}"\n                                             src="{{ MEDIA_URL }}{{ course.image }}"/>\n                                    </a>\n                                </dt>\n                                <dd>\n                                    <a target="_blank" href="{{ ecmall_ad.url }}"><h2>{{ course.name }}</h2></a>\n                                    \x3c!-- 注意这里的get_degree_display可以显示choice字段的显示名称，而不是数据库中取出的数据名称 --\x3e\n                                    <span class="fl">课程难度：<i class="key">{{ course.get_degree_display }}</i></span>\n                                </dd>\n                            </dl>\n                        {% endfor %}\n\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </section>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br")])]),e("h3",{attrs:{id:"二十一-点击某个课程之后-课程详情页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十一-点击某个课程之后-课程详情页面的开发"}},[s._v("#")]),s._v(" （二十一）"),e("strong",[e("code",[s._v("点击某个课程之后，课程详情页面的开发")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1040),alt:"Alt text"}})]),s._v(" "),e("ul",[e("li",[s._v("将course-detail.html拷贝到templates目录中， 继承与base.html页面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends "base.html" %}\n{% load staticfiles %}\n{% block title %} 公开课 {% endblock %}\n\n{% block custom_css %}\n    <style>\n        .begin_to_learn{\n            width: 100%;\n            height: 100%;\n            display: block;\n        }\n    </style>\n{% endblock %}\n\x3c!-- 面包屑部分 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <div class="crumbs">\n                <ul>\n                    <li><a href="/">首页</a>></li>\n                    <li><a href="{% url \'courses:course_list\' %}">公开课</a>></li>\n                    <li><a href="{% url \'courses:course_detail\' course.id %}"></a>课程详情</li>\n                </ul>\n            </div>\n        </div>\n    </section>\n{% endblock %}\n\n\n{% block content %}\n    <section>\n        <div class="wp">\n            <div class="groupPurchase_detail detail">\n                <div class="toppro">\n                    <div class="left">\n                        <div class="picbox">\n                            <div class="tb-booth tb-pic">\n                                <img width="440" height="335" src="{{ MEDIA_URL }}{{ course.image }}"\n                                     rel="{{ MEDIA_URL }}{{ course.image }}" class="jqzoom"/>\n                            </div>\n\n                        </div>\n                        <div class="des">\n                            <h1 title="django 从入门到精通体验开始了">{{ course.name }}</h1>\n                            <span class="key">{{ course.desc }}</span>\n                            <div class="prize">\n                                <span class="fl">价格：<i class="key">免费</i></span>\n                                <span class="fr">学习人数：{{ course.students }}</span>\n                            </div>\n                            <ul class="parameter">\n                                <li><span\n                                        class="pram word3">时&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;长：</span><span>{{ course.learn_times }}</span>\n                                </li>\n                                \x3c!-- 这里是course实例调用一个函数get_lesson_num， 返回章节数 --\x3e\n                                <li><span\n                                        class="pram word3">章&nbsp;节&nbsp;数：</span><span>{{ course.get_lesson_num }}</span>\n                                </li>\n                                <li><span class="pram word3">课程类别：</span><span>{{ course.learn_times }}</span></li>\n                                <li><span class="pram word3">课程难度：</span><span>{{ course.get_degree_display }}</span>\n                                </li>\n                                <li><span class="pram word3">课程类别：</span><span\n                                        title=""### {{ course.get_course_category_display }} </span></li>\n                                <li class="piclist"><span class="pram word4">学习用户：</span>\n                                    {% for user_course in course.get_learn_users %}\n                                        <span class="pic"><img width="40" height="40" src="\n                                                {{ MEDIA_URL }}{{ user_course.user.image }}"/></span>\n                                    {% endfor %}\n                                </li>\n                            </ul>\n                            <div class="btns">\n                                <div class="btn colectgroupbtn  notlogin\n                                      " data-favid="15" id="jsLeftBtn">\n                                    {% if has_fav_course %}已收藏{% else %}收藏{% endif %}\n                                </div>\n                                \n                                <div class="buy btn">\n                                    <a class="begin_to_learn" style="color: white" href="{% url \'courses:course_info\' course.id %}">开始学习</a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n\n                    \x3c!-- 开发过内容系统 --\x3e\n                    <div class="right">\n                        <div class="head">\n                            <h1 style="text-align: center;">授课机构</h1>\n                            <p style="text-align: center;">中国IT教育机构，课程权威</p>\n                        </div>\n                        <div class="pic">\n                            <a href="/company/14/">\n                                <img width="150" height="80" src="{{ MEDIA_URL }}{{ course.course_org.image }}"/>\n                            </a>\n                        </div>\n                        <a href="/company/14/">\n                            <h2 class="center" title="">{{ course.course_org.name }}</h2>\n                        </a>\n                        <p class="center tell">地址：{{ course.course_org.address }}</p>\n                        \x3c!-- ajax提交 --\x3e\n                        <div class="btn  notlogin" data-favid="14" id="jsRightBtn">\n                            {% if has_fav_org %}已收藏{% else %}收藏{% endif %}\n                        </div>\n                        <div class="clear">\n                            <ul>\n                                <li>\n                                    <span>课 &nbsp;程&nbsp; 数：&nbsp;&nbsp;{{ course.course_org.course_numbers }}</span>\n                                </li>\n                                <li>\n                                    <span>教 &nbsp;师&nbsp; 数：&nbsp;&nbsp;{{ course.course_org.get_teacher_num }}</span>\n                                </li>\n\n                                <li>所在地区：&nbsp;&nbsp;{{ course.course_org.address }}</li>\n                                <li>认&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;证&nbsp;:\n                                    &nbsp;&nbsp;\n                                    <img title="金牌机构" , src="{% static \'images/gold.png\' %}"/>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </section>\n\n    <section>\n        <div class="wp">\n            <div class="list groupPurchase_detail_pro">\n                <div class="left layout">\n                    <div class="head">\n                        <ul class="tab_header">\n                            <li class="active">产品详细</li>\n                        </ul>\n                    </div>\n                    <div class="tab_cont tab_cont1">\n                        \x3c!-- 显示富文本的时候关闭特殊符号转义的功能 ---\x3e\n                        {% autoescape off %}\n                        {{ course.detail }}\n                        {% endautoescape %}\n                    </div>\n                    <div class="tab_cont tab_cont2">\n                        <div class="comment">\n                            <div class="comenlist">\n\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- 相关推荐 --\x3e\n                <div class="right layout">\n                    <div class="head">相关课程推荐</div>\n                    <div class="group_recommend">\n                        {% for course in  relate_course %}\n                            <dl>\n                            <dt>\n                                <a target="_blank" href="">\n                                    <img width="240" height="220" class="scrollLoading"\n                                         src="{{ MEDIA_URL }}{{ course.image }}"/>\n                                </a>\n                            </dt>\n                            <dd>\n                                <a target="_blank" href=""><h2>{{ course.name }}</h2></a>\n                                <span class="fl">学习时长：<i class="key">{{ course.learn_times }}</i></span>\n                            </dd>\n                        </dl>\n                        {% endfor %}\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    </section>\n{% endblock %}\n\n\n{% block custom_js %}\n\x3c!-- 处理收藏和取消的ajax --\x3e\n<script>\n\n    let add_fav = function (current_elem, fav_id, fav_type) {\n        $.ajax({\n            cache: false,\n            type: \'POST\',\n            url: "{% url \'org:add_fav\' %}",\n            data: {\'fav_id\': fav_id, \'fav_type\': fav_type}, // 这里没有form表达提交，因此，不需要序列号\n            async: true,\n            dataType: \'json\',\n            beforeSend: function (xhr, settings) {\n                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");\n            },\n            success: function (data) {\n\n                if (data.status == "fail") {\n                    if (data.msg == \'您还未登入，请先登录\') {\n                        window.location.href = \'/login/\';\n                    } else {\n\n                        current_elem.text(data.msg)\n                    };\n\n                } else {\n                    current_elem.text(data.msg)\n                }\n            },\n            error: function (data) {\n                console.log(\'请求数据失败\');\n\n            },\n        });\n    };\n\n    \x3c!-- 右边的收藏按钮：收藏课程 --\x3e\n    $("#jsLeftBtn").on(\'click\', function () {\n        add_fav($(this), {{ course.id }}, 1);\n    });\n\n    \x3c!-- 左边的收藏按钮：收藏机构 --\x3e\n    $("#jsRightBtn").on(\'click\', function () {\n        add_fav($(this), {{ course.course_org.id }}, 2);\n    });\n\n\n<\/script>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br"),e("span",{staticClass:"line-number"},[s._v("163")]),e("br"),e("span",{staticClass:"line-number"},[s._v("164")]),e("br"),e("span",{staticClass:"line-number"},[s._v("165")]),e("br"),e("span",{staticClass:"line-number"},[s._v("166")]),e("br"),e("span",{staticClass:"line-number"},[s._v("167")]),e("br"),e("span",{staticClass:"line-number"},[s._v("168")]),e("br"),e("span",{staticClass:"line-number"},[s._v("169")]),e("br"),e("span",{staticClass:"line-number"},[s._v("170")]),e("br"),e("span",{staticClass:"line-number"},[s._v("171")]),e("br"),e("span",{staticClass:"line-number"},[s._v("172")]),e("br"),e("span",{staticClass:"line-number"},[s._v("173")]),e("br"),e("span",{staticClass:"line-number"},[s._v("174")]),e("br"),e("span",{staticClass:"line-number"},[s._v("175")]),e("br"),e("span",{staticClass:"line-number"},[s._v("176")]),e("br"),e("span",{staticClass:"line-number"},[s._v("177")]),e("br"),e("span",{staticClass:"line-number"},[s._v("178")]),e("br"),e("span",{staticClass:"line-number"},[s._v("179")]),e("br"),e("span",{staticClass:"line-number"},[s._v("180")]),e("br"),e("span",{staticClass:"line-number"},[s._v("181")]),e("br"),e("span",{staticClass:"line-number"},[s._v("182")]),e("br"),e("span",{staticClass:"line-number"},[s._v("183")]),e("br"),e("span",{staticClass:"line-number"},[s._v("184")]),e("br"),e("span",{staticClass:"line-number"},[s._v("185")]),e("br"),e("span",{staticClass:"line-number"},[s._v("186")]),e("br"),e("span",{staticClass:"line-number"},[s._v("187")]),e("br"),e("span",{staticClass:"line-number"},[s._v("188")]),e("br"),e("span",{staticClass:"line-number"},[s._v("189")]),e("br"),e("span",{staticClass:"line-number"},[s._v("190")]),e("br"),e("span",{staticClass:"line-number"},[s._v("191")]),e("br"),e("span",{staticClass:"line-number"},[s._v("192")]),e("br"),e("span",{staticClass:"line-number"},[s._v("193")]),e("br"),e("span",{staticClass:"line-number"},[s._v("194")]),e("br"),e("span",{staticClass:"line-number"},[s._v("195")]),e("br"),e("span",{staticClass:"line-number"},[s._v("196")]),e("br"),e("span",{staticClass:"line-number"},[s._v("197")]),e("br"),e("span",{staticClass:"line-number"},[s._v("198")]),e("br"),e("span",{staticClass:"line-number"},[s._v("199")]),e("br"),e("span",{staticClass:"line-number"},[s._v("200")]),e("br"),e("span",{staticClass:"line-number"},[s._v("201")]),e("br"),e("span",{staticClass:"line-number"},[s._v("202")]),e("br"),e("span",{staticClass:"line-number"},[s._v("203")]),e("br"),e("span",{staticClass:"line-number"},[s._v("204")]),e("br"),e("span",{staticClass:"line-number"},[s._v("205")]),e("br"),e("span",{staticClass:"line-number"},[s._v("206")]),e("br"),e("span",{staticClass:"line-number"},[s._v("207")]),e("br"),e("span",{staticClass:"line-number"},[s._v("208")]),e("br"),e("span",{staticClass:"line-number"},[s._v("209")]),e("br"),e("span",{staticClass:"line-number"},[s._v("210")]),e("br"),e("span",{staticClass:"line-number"},[s._v("211")]),e("br"),e("span",{staticClass:"line-number"},[s._v("212")]),e("br"),e("span",{staticClass:"line-number"},[s._v("213")]),e("br"),e("span",{staticClass:"line-number"},[s._v("214")]),e("br"),e("span",{staticClass:"line-number"},[s._v("215")]),e("br"),e("span",{staticClass:"line-number"},[s._v("216")]),e("br"),e("span",{staticClass:"line-number"},[s._v("217")]),e("br"),e("span",{staticClass:"line-number"},[s._v("218")]),e("br"),e("span",{staticClass:"line-number"},[s._v("219")]),e("br"),e("span",{staticClass:"line-number"},[s._v("220")]),e("br"),e("span",{staticClass:"line-number"},[s._v("221")]),e("br"),e("span",{staticClass:"line-number"},[s._v("222")]),e("br"),e("span",{staticClass:"line-number"},[s._v("223")]),e("br")])]),e("ul",[e("li",[s._v("编写urls.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 课程的详情页，这里的course_id要与get()方法的关键字参数名称一一对应\nurl(r'^detail/(?P<course_id>\\d+)/', CourseDetailView.as_view(), name=\"course_detail\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("编写views.py")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 课程详情页的处理逻辑\nclass CourseDetailView(View):\n    def get(self, request, course_id):\n        course = Course.objects.get(id = int(course_id))\n\n        # 每次用户点击进入这个课程开始学习的时候，需要将课程的点击数加一\n        course.click_nums += 1\n        course.save()\n\n\n        # 做推荐系统，tag可以直接通过记录实例获取值\n        tag = course.tag\n        if tag: # 如果这个课程有tag值，那么\n            relate_course = Course.objects.filter(tag=tag)[:1] # 这里取出来是一个集合，需要使用for循环变量\n        else:\n            relate_course = None\n\n        # 查询数据库，是否已经收藏了课程和机构\n        has_fav_course = False\n        has_fav_org = False\n\n        if request.user.is_authenticated():  # 如果用户登录了\n\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(course_id), fav_type=1):  # 如果已经被这个用户收藏\n                has_fav_course = True\n\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(course.course_org.id), fav_type=2):  # 如果已经被这个用户收藏\n                has_fav_org = True\n\n\n        return  render(request, \'course-detail.html\', {\n            "course": course,\n            "relate_course": relate_course,\n            "has_fav_course": has_fav_course,\n            "has_fav_org": has_fav_org,\n\n        })\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br")])]),e("ul",[e("li",[s._v("在course-list.html页面中设置跳转到课程详情页的入口")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<a href="{% url \'courses:course_detail\' course.id %}">\n    <img width="280" height="350" class="scrollLoading" data-url="{{ MEDIA_URL }}{{ course.image }}" src="{% static \'images/pixel.gif\' %}"/>\n</a>\n\n\n<a href="{% url \'courses:course_detail\' course.id %}">\n    <h2>{{ course.name }}</h2>\n</a>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("说明下：在model中重载"),e("code",[s._v("__str__")]),s._v("方法的意义")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('前面在设计表的model的时候，都会重载一个__str__方法，那这个方法具体有什么意义？\n    def __str__(self):\n        return self.name\n\n1：在xadmin后台，可以显示表的中文名称\n\n2：当这个model是另外一个model的外键的时候，此时如果需要显示这个model的名称，就需要重载这个model的__str__方法\n举个例子， 下面的course有一个外键是course_org，那么在前端页面需要显示课程的机构名称，所以直接{{ course.course_org }}显示出来，如果没有重载__str__方法，那么就会显示Course_org Object。因此每个model重载__str__方法是非常有必要的\n\n<a href="org-detail-homepage.html"><span class="fl">{{ course.course_org }}</span></a>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("ul",[e("li",[s._v("在课程的详情页中，如何获取课程的章节数呢？")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('之前在设计model的时候，Lession这个model有一个外键指向Course这个model的，那么就可以在Course这个model里面写个函数来反向获取到课程的章节数\n\ndef get_lession_number(self):\n\treturn self.lesson_set.all().count()\n\n那么在前端页面中就可以这样获取章节数了\n<span class="pram word3">章&nbsp;节&nbsp;数：</span><span>{{ course.get_lession_number }}</span>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("在课程的详情页中，如何获取学习用户呢？")])]),s._v(" "),e("li",[e("p",[s._v("在operation 这个APP中有个model叫UserCourse，这个model就保存了课程与用户直接的关系")])]),s._v(" "),e("li",[e("p",[s._v("那么在Course这个model里面写个函数来获取与这个课程相关的记录，在记录中就保存了用户信息")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    def get_learn_users(self):\n        return self.usercourse_set.all()[:5]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("那么在前端页面中就这么获取用户即可")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<li class="piclist"><span class="pram word4">学习用户：</span>\n    {% for user_course in course.get_learn_users %}\n\t    # user是UserCourse的一个外键，可以直接获取到用户实例，从而获取到用户的图片\n        <span class="pic"><img width="40" height="40" src="{{ MEDIA_URL }}{{ user_course.user.image }}"/></span>\n    {% endfor %}\n</li>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"二十二-课程详情页面中授课结构的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十二-课程详情页面中授课结构的开发"}},[s._v("#")]),s._v(" （二十二）"),e("strong",[e("code",[s._v("课程详情页面中授课结构的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("在这里需要注意的有2点")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("1：由于views.py中返回的是course实例，由于课程属于机构，course是course_org的一个外键，因此，获取一个课程所对应的机构logo可以：course.course_org.image， 这样获取到值\n\n2：由于在CourseOrg这个model里面有一个course_numbers字段，这个字段是后台手动填写的，并不是真实的课程数量。因此，如果要获取真实的课程数量，那么需要在CourseOrg这个model写一个函数\n\ndef get_course_number(self):\n\treturn self.course_set.all().count()\n\t\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"二十三-课程详情页面中授课相关推荐的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十三-课程详情页面中授课相关推荐的开发"}},[s._v("#")]),s._v(" （二十三）"),e("strong",[e("code",[s._v("课程详情页面中授课相关推荐的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("在Course这个model里面，有一个字段tag，这个tag字段就是用来做相关推荐的")]),s._v(" "),e("li",[s._v("编辑views.py文件， 在CourseDetailView这个view中添加")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('tag = course.tag\n        if tag: # 如果这个课程有tag值\n            # 先在数据库中找出有这个tag值的所有的课程再排除自己，推荐的是除去自己以外的其他课程, 在其他课程里面返回一个点击数最多的课程\n            relate_course = Course.objects.filter(tag=tag).exclude(name=course.name).order_by("-click_nums")[:1]\n        else:\n            relate_course = None\n\n\n# 最后将relate_course返回\nreturn  render(request, \'course-detail.html\', {\n            "course": course,\n            "relate_course": relate_course,\n            "has_fav_course": has_fav_course,\n            "has_fav_org": has_fav_org,\n\n        })\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h3",{attrs:{id:"二十三-课程详情页面中两个收藏按钮的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十三-课程详情页面中两个收藏按钮的开发"}},[s._v("#")]),s._v(" （二十三）"),e("strong",[e("code",[s._v("课程详情页面中两个收藏按钮的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("之前在结构的详情页也有收藏，那是收藏机构，这里同样也是收藏，左边的收藏是收藏课程，右边的收藏是收藏机构。后台的逻辑接口，还是organization下的AddFavView这个View")]),s._v(" "),e("li",[s._v("js代码如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("<script>\n\n    let add_fav = function (current_elem, fav_id, fav_type) {\n        $.ajax({\n            cache: false,\n            type: 'POST',\n            url: \"{% url 'org:add_fav' %}\",\n            data: {'fav_id': fav_id, 'fav_type': fav_type}, // 这里没有form表达提交，因此，不需要序列号\n            async: true,\n            dataType: 'json',\n            beforeSend: function (xhr, settings) {\n                xhr.setRequestHeader(\"X-CSRFToken\", \"{{ csrf_token }}\");\n            },\n            success: function (data) {\n\n                if (data.status == \"fail\") {\n                    if (data.msg == '您还未登入，请先登录') {\n                        window.location.href = '/login/';\n                    } else {\n\n                        current_elem.text(data.msg)\n                    };\n\n                } else {\n                    current_elem.text(data.msg)\n                }\n            },\n            error: function (data) {\n                console.log('请求数据失败');\n\n            },\n        });\n    };\n\n    \x3c!-- 右边的收藏按钮：收藏课程 --\x3e\n    $(\"#jsLeftBtn\").on('click', function () {\n        add_fav($(this), {{ course.id }}, 1);\n    });\n\n    \x3c!-- 左边的收藏按钮：收藏机构 --\x3e\n    $(\"#jsRightBtn\").on('click', function () {\n        add_fav($(this), {{ course.course_org.id }}, 2);\n    });\n<\/script>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br")])]),e("ul",[e("li",[s._v("那么在views.py里面，显示前端页面就需要判断，是否用户已经收藏")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 查询数据库，是否已经收藏了课程和机构\n        has_fav_course = False\n        has_fav_org = False\n\n        if request.user.is_authenticated():  # 如果用户登录了\n\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(course_id), fav_type=1):  # 如果已经被这个用户收藏\n                has_fav_course = True\n\n            if UserFavorite.objects.filter(user=request.user, fav_id=int(course.course_org.id), fav_type=2):  # 如果已经被这个用户收藏\n                has_fav_org = True\n\n\n# 并且将has_fav_course，has_fav_org的值返回到前端\nreturn  render(request, \'course-detail.html\', {\n            "course": course,\n            "relate_course": relate_course,\n            "has_fav_course": has_fav_course,\n            "has_fav_org": has_fav_org,\n})\n\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("h3",{attrs:{id:"二十四-章节详情页的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十四-章节详情页的开发"}},[s._v("#")]),s._v(" （二十四）"),e("strong",[e("code",[s._v("章节详情页的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("当用户在课程详情页中点击"),e("code",[s._v("开始学习按钮")]),s._v("的时候，就会跳转到章节详情页面")]),s._v(" "),e("li",[s._v("将"),e("code",[s._v("course-video.html")]),s._v("和"),e("code",[s._v("course-comment.html")]),s._v("拷贝到templates目录中， 继承于base.html页面， 首先编辑course-video.html")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends "base.html" %}\n{% load staticfiles %}\n{% block title %} 公开课视频 {% endblock %}\n\n\x3c!-- 面包屑部分 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <div class="crumbs">\n                <ul>\n                    <li><a href="/">首页</a>></li>\n                    <li><a href="{% url \'courses:course_list\' %}">公开课</a>></li>\n                    <li>\n                        <a href="{% url \'courses:course_detail\' course_id %}">\n                            >课程详情\n                        </a>\n                    </li>\n                    <li>\n                        <a href="{% url \'courses:course_info\' course_id %}">\n                            >章节信息\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </section>\n{% endblock %}\n\n\n{% block custom_css %}\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/base.css\' %}"/>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/common-less.css\' %}"/>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/course/learn-less.css\' %}"/>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/course/common-less.css\' %}">\n\n{% endblock %}\n\n\n\n{% block content %}\n\n    <div id="main">\n    <div class="course-infos">\n        <div class="w pr">\n            <div style="height: 15px" class="path">\n            </div>\n            <div class="hd">\n                <h2 class="l">{{ course.name }}</h2>\n            </div>\n            <div class="statics clearfix">\n                <div class="static-item ">\n                    <span class="meta-value"><strong>{{ course.get_degree_display }}</strong></span>\n                    <span class="meta">难度</span>\n                    <em></em>\n                </div>\n                <div class="static-item static-time">\n                    <span class="meta-value"><strong### {{ course.learn_times }}</strong>小时<strong> 0</strong>分</span>\n                    <span class="meta">时长</span>\n                    <em></em>\n                </div>\n                <div class="static-item">\n                    <span class="meta-value"><strong>{{ course.students }}</strong></span>\n                    <span class="meta">学习人数</span>\n                    <em></em>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="course-info-main clearfix w has-progress">\n\n        <div class="info-bar clearfix">\n        <div class="content-wrap clearfix">\n            <div class="content">\n                <div class="mod-tab-menu">\n                    <ul class="course-menu clearfix">\n                        <li><a class="ui-tabs-active active" id="learnOn"><span>章节</span></a></li>\n                        <li>\n                            <a id="commentOn" class="" href="{% url \'courses:course_comment\' course.id %}">\n                                <span>评论</span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div id="notice" class="clearfix">\n                    <div class="l"### <strong>课程公告:</strong> <a  href="javascript:void(0)">Spring的文档以及相关的jar文件已上传</a> </div>\n                </div>\n\n                <div class="mod-chapters">\n                    {% for lession in lessions %}\n                        <div class="chapter chapter-active" >\n                        <h3>\n                            <span class="aui-iconfont aui-icon-move"></span>\n                            <strong><i class="state-expand"></i>{{ lession.name }}</strong>\n                        </h3>\n                        <ul class="video">\n                            {% for video in lession.get_lession_video %}\n                            <li>\n                                <a target="_blank" href="{% url \'courses:video_play\' video.id %}" class="J-media-item studyvideo">{{ video.name }} ({{ video.learn_times }}:56)\n                                    <i class="study-state"></i>\n                                </a>\n                            </li>\n                            {% endfor %}\n\n                        </ul>\n                    </div>\n                    {% endfor %}\n                </div>\n\n            </div>\n            <div class="aside r">\n                <div class="bd">\n\n                    <div class="box mb40">\n                        <h4>资料下载</h4>\n                        <ul class="downlist">\n                            {% for resource in all_resourses %}\n                            <li>\n                                <span ><i class="aui-iconfont aui-icon-file"></i>&nbsp;&nbsp;{{ resource.name }}</span>\n                                <a href="{{ MEDIA_URL }}{{ resource.download }}" class="downcode" target="_blank" download="" data-id="274" title="">下载</a>\n                            </li>\n                            {% endfor %}\n                        </ul>\n                    </div>\n                    <div class="box mb40">\n                        <h4>讲师提示</h4>\n                        <div class="teacher-info">\n                            <a href="/u/315464/courses?sort=publish" target="_blank">\n                                <img src="{{ MEDIA_URL }}{{ course.teacher.image }}" width=\'80\' height=\'80\' />\n                            </a>\n        <span class="tit">\n          <a href="/u/315464/courses?sort=publish" target="_blank">{{ course.teacher.name }}</a>\n        </span>\n                            <span class="job">{{ course.teacher.work_position }}</span>\n                        </div>\n                        <div class="course-info-tip">\n                            <dl class="first">\n                                <dt>课程须知</dt>\n                                <dd class="autowrap">{{ course.what_you_need_know }}</dd>\n                            </dl>\n                            <dl>\n                                <dt>老师告诉你能学到什么？</dt>\n                                <dd class="autowrap">{{ course.what_you_can_learn }}</dd>\n                            </dl>\n                        </div>\n                    </div>\n\n\n                    <div class="cp-other-learned  js-comp-tabs">\n                        <div class="cp-header clearfix">\n                            <h2 class="cp-tit l">学习过该课程的同学还学过：</h2>\n                        </div>\n                        <div class="cp-body">\n                            <div class="cp-tab-pannel js-comp-tab-pannel" data-pannel="course" style="display: block">\n                                \x3c!-- img 200 x 112 --\x3e\n                                <ul class="other-list">\n\n                                    {% for relate_course in relate_courses %}\n                                    <li class="curr">\n                                        <a href="{% url \'courses:course_detail\' relate_course.id %}" target="_blank">\n                                            <img src="{{ MEDIA_URL }}{{ relate_course.image }}" alt="Java入门第一季">\n                                            <span class="name autowrap">{{ relate_course.name }}</span>\n                                        </a>\n                                    </li>\n                                    {% endfor %}\n\n\n                                </ul>\n                            </div>\n                            <div class="cp-tab-pannel js-comp-tab-pannel" data-pannel="plan">\n                                <ul class="other-list">\n                                    <li class="curr">\n                                        <a href="/course/programdetail/pid/31?src=sug" target="_blank">\n                                            <img src="http://img.mukewang.com/56551e6700018b0c09600720-240-135.jpg" alt="Java工程师">\n                                            <span class="name autowrap">Java工程师</span>\n                                        </a>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n\n                </div###    </div>\n        </div>\n        <div class="clear"></div>\n\n    </div>\n\n</div>\n    </div>\n{% endblock %}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br"),e("span",{staticClass:"line-number"},[s._v("163")]),e("br"),e("span",{staticClass:"line-number"},[s._v("164")]),e("br"),e("span",{staticClass:"line-number"},[s._v("165")]),e("br"),e("span",{staticClass:"line-number"},[s._v("166")]),e("br"),e("span",{staticClass:"line-number"},[s._v("167")]),e("br"),e("span",{staticClass:"line-number"},[s._v("168")]),e("br"),e("span",{staticClass:"line-number"},[s._v("169")]),e("br"),e("span",{staticClass:"line-number"},[s._v("170")]),e("br"),e("span",{staticClass:"line-number"},[s._v("171")]),e("br"),e("span",{staticClass:"line-number"},[s._v("172")]),e("br"),e("span",{staticClass:"line-number"},[s._v("173")]),e("br"),e("span",{staticClass:"line-number"},[s._v("174")]),e("br"),e("span",{staticClass:"line-number"},[s._v("175")]),e("br"),e("span",{staticClass:"line-number"},[s._v("176")]),e("br"),e("span",{staticClass:"line-number"},[s._v("177")]),e("br"),e("span",{staticClass:"line-number"},[s._v("178")]),e("br"),e("span",{staticClass:"line-number"},[s._v("179")]),e("br"),e("span",{staticClass:"line-number"},[s._v("180")]),e("br"),e("span",{staticClass:"line-number"},[s._v("181")]),e("br"),e("span",{staticClass:"line-number"},[s._v("182")]),e("br"),e("span",{staticClass:"line-number"},[s._v("183")]),e("br"),e("span",{staticClass:"line-number"},[s._v("184")]),e("br"),e("span",{staticClass:"line-number"},[s._v("185")]),e("br"),e("span",{staticClass:"line-number"},[s._v("186")]),e("br"),e("span",{staticClass:"line-number"},[s._v("187")]),e("br"),e("span",{staticClass:"line-number"},[s._v("188")]),e("br"),e("span",{staticClass:"line-number"},[s._v("189")]),e("br"),e("span",{staticClass:"line-number"},[s._v("190")]),e("br")])]),e("ul",[e("li",[s._v("编辑urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 课程详情页中点击开始学习按钮的url处理\nurl(r'^info/(?P<course_id>\\d+)/', CourseInfoView.as_view(), name=\"course_info\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py文件， LoginRequiredMixin可以先不要")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 处理开始学习按钮的逻辑，也就是课程info\nclass CourseInfoView(LoginRequiredMixin,View):\n    def get(self, request, course_id):\n        course = Course.objects.get(id=int(course_id))\n        \'\'\'\n        小总结：这里获取 章节和资源 都有两种方式\n        第一种：因为章节的外键指向课程，因此，可以在课程里面通过Django提供的方法名lesson_set来获取\n        第二种：因为章节的外键指向课程，可以通过Lession过滤出课程，例如: Lession.objects.filter(course=course_id)\n        \'\'\'\n        lessions = course.get_course_lession()\n        all_resourses = course.get_course_resource()\n        # 用户点击之后课程之后，直接将学生加一\n        course.students += 1\n        course.save()\n        # 每次用户点击了这个课程开始学习的时候，让UserCourse这个model保存用户和课程\n        # 首先看看是否在UserCourse里面已经将用户和课程关联起来了，如果关联起来，就不要继续保存了\n        user_course = UserCourse.objects.filter(user=request.user, course=course)\n        if not user_course:\n            user_course = UserCourse()\n            user_course.user = request.user\n            user_course.course = course\n            user_course.save()\n        # 处理"学过这些课程的同学还学习过哪些课程",\n        user_courses = UserCourse.objects.filter(course=course) # 取出这个课程相关的所有的记录\n        user_ids = [user_course.user.id for user_course in user_courses] # 获取学个这个课程的所有用户的id\n        all_user_courses = UserCourse.objects.filter(user_id__in=user_ids) # 通过所有学过这么课程的用户的id，来获取不同的用户学习过的不同的课程记录\n        course_ids = [user_course.course.id for user_course in all_user_courses] # 获取用户学到其他课程的所有的课程ID\n        relate_courses = Course.objects.filter(id__in=course_ids).exclude(name=course.name).order_by(\'-click_nums\')[:3] # 通过课程ID找出相关的课程， 且排除当前课程\n        return  render(request, \'course-video.html\', {\n            "course_id": course_id,\n            "lessions": lessions,\n            "all_resourses": all_resourses,\n            "course": course,\n            "relate_courses":relate_courses,\n        })\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br")])]),e("ul",[e("li",[s._v("在course-detail.html页面给course-video.html页面一个跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<a class="begin_to_learn" style="color: white" href="{% url \'courses:course_info\' course.id %}">开始学习</a>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("简要说说在HTML中提供下载功能")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('这里的课程资源是提供了下载的功能，其实下载功能就是一个a标签, 指向了下载的文件的路径\n<a href="{{ MEDIA_URL }}{{ resource.download }}" class="downcode" target="_blank" download="" data-id="274" title="">下载</a>\n\n后台的download字段是一个FileField类型，可以提供保存路径，前端直接使用一个a标签就能够下载了\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("这个页面中，如果拿到了章节lession实例，可以在Lession这个model写个函数，获取到所有的video实例，因为video有一个外键是lession")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("def get_lession_video(self):\n\treturn self.video_set.all()\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"二十五-在课程详情中-评论页面的开发评论页面的开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二十五-在课程详情中-评论页面的开发评论页面的开发"}},[s._v("#")]),s._v(" （二十五）"),e("strong",[e("code",[s._v("在课程详情中，评论页面的开发评论页面的开发")])])]),s._v(" "),e("ul",[e("li",[s._v("首先编辑course-comment.html页面")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{% extends "base.html" %}\n{% load staticfiles %}\n{% block title %} 课程评论 {% endblock %}\n\n\x3c!-- 面包屑部分 --\x3e\n{% block custom_bread %}\n    <section>\n        <div class="wp">\n            <div class="crumbs">\n                <ul>\n                    <li><a href="/">首页</a>></li>\n                    <li><a href="{% url \'courses:course_list\' %}">公开课</a>></li>\n                    <li><a href="{% url \'courses:course_detail\' course_id %}">课程详情</a></li>\n                    <li><a href="{% url \'courses:course_info\' course_id %}">>课程评论</a></li>\n                </ul>\n            </div>\n        </div>\n    </section>\n{% endblock %}\n\n\n{% block custom_css %}\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/course/learn-less.css\' %}"/>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/course/course-comment.css\' %}"/>\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/base.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/common-less.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/muke/course/common-less.css\' %}">\n    <link rel="stylesheet" type="text/css" href="{% static \'css/mooc.css\' %}"/>\n{% endblock %}\n\n\n\n{% block content %}\n    <div id="main">\n        <div class="course-infos">\n            <div class="w pr">\n                <div style="height: 15px" class="path">\n                </div>\n                <div class="hd">\n                    <h2 class="l">{{ course.name }}</h2>\n                </div>\n                <div class="statics clearfix">\n                    <div class="static-item ">\n                        <span class="meta-value"><strong>{{ course.get_degree_display }}</strong></span>\n                        <span class="meta">难度</span>\n                        <em></em>\n                    </div>\n                    <div class="static-item static-time">\n                        <span class="meta-value">{{ course.learn_times }}分钟</span>\n                        <span class="meta">时长</span>\n                        <em></em>\n                    </div>\n                    <div class="static-item">\n                        <span class="meta-value"><strong>{{ course.students }}</strong></span>\n                        <span class="meta">学习人数</span>\n                        <em></em>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="course-info-main clearfix w has-progress">\n\n            <div class="info-bar clearfix">\n                <div class="content-wrap clearfix">\n                    <div class="content">\n                        <div class="mod-tab-menu">\n                            <ul class="course-menu clearfix">\n                                <li>\n                                    <a class="ui-tabs-active " id="learnOn" href="{% url \'courses:course_info\' course_id %}">\n                                        <span>章节</span>\n                                    </a>\n                                </li>\n                                <li><a id="commentOn" class="active"><span>评论</span></a></li>\n                            </ul>\n                        </div>\n\n                        \x3c!--发布评论--\x3e\n                        <div id="js-pub-container" class="issques clearfix js-form">\n                            <div class="wgt-ipt-wrap pub-editor-wrap " id="js-pl-input-fake">\n                                <textarea id="js-pl-textarea" class="" placeholder="扯淡、吐槽、表扬、鼓励……想说啥就说啥！"></textarea>\n                            </div>\n                            <input type="button" id="js-pl-submit" class="pub-btn" data-cid="452" value="发表评论">\n                            <p class="global-errortip js-global-error"></p>\n                        </div>\n                        <div id="course_note">\n                            <ul class="mod-post" id="comment-list">\n                                {% for comment in all_comments %}\n                                <li class="post-row">\n                                    <div class="media">\n                                        <span target="_blank"><img src="{{ MEDIA_URL }}{{ comment.user.image }}"\n                                                                   width=\'40\' height=\'40\'/></span>\n                                    </div>\n                                    <div class="bd">\n                                        <div class="tit">\n                                            <span style="color: #cccccc" target="_blank">{{ comment.user.username }}</span>\n                                        </div>\n                                        <p class="cnt"### {{ comment.comments }} </p>\n                                        <div class="footer clearfix">\n                                            <span title="创建时间" class="l timeago">时间：{{ comment.add_time }}</span>\n                                        </div>\n                                    </div>\n                                </li>\n                                {% endfor %}\n\n                            </ul>\n                        </div>\n\n                    </div>\n                    <div class="aside r">\n                        <div class="bd">\n\n                            <div class="box mb40">\n                                <h4>资料下载</h4>\n                                <ul class="downlist">\n                                    {% for resource in all_resourses %}\n                                        <li>\n                                            <span><i\n                                                    class="aui-iconfont aui-icon-file"></i>&nbsp;&nbsp;{{ resource.name }}</span>\n                                            <a href="{{ MEDIA_URL }}{{ resource.download }}" class="downcode"\n                                               target="_blank" download="" data-id="274" title="">下载</a>\n                                        </li>\n                                    {% endfor %}\n\n                                </ul>\n                            </div>\n                            <div class="box mb40">\n                                <h4>讲师提示</h4>\n                                <div class="teacher-info">\n                                    <a href="/u/315464/courses?sort=publish" target="_blank">\n                                        <img src="{{ MEDIA_URL }}{{ course.teacher.image }}" width=\'80\' height=\'80\'/>\n                                    </a>\n                                    <span class="tit">\n          <a href="/u/315464/courses?sort=publish" target="_blank">{{ course.teacher.name }}</a>\n        </span>\n                                    <span class="job">{{ course.teacher.work_position }}</span>\n                                </div>\n                                <div class="course-info-tip">\n                                    <dl class="first">\n                                        <dt>课程须知</dt>\n                                        <dd class="autowrap">{{ course.what_you_need_know }}</dd>\n                                    </dl>\n                                    <dl>\n                                        <dt>老师告诉你能学到什么？</dt>\n                                        <dd class="autowrap">{{ course.what_you_can_learn }}</dd>\n                                    </dl>\n                                </div>\n                            </div>\n\n\n                            <div class="cp-other-learned  js-comp-tabs">\n                                <div class="cp-header clearfix">\n                                    <h2 class="cp-tit l">该课的同学还学过</h2>\n                                </div>\n                                <div class="cp-body">\n                                    <div class="cp-tab-pannel js-comp-tab-pannel" data-pannel="course"\n                                         style="display: block">\n                                        \x3c!-- img 200 x 112 --\x3e\n                                        <ul class="other-list">\n                                            {% for relate_course in relate_courses %}\n                                                <li class="curr">\n                                                    <a href="{% url \'courses:course_detail\' relate_course.id %}" target="_blank">\n                                                        <img src="{{ MEDIA_URL }}{{ relate_course.image }}" alt="Python入门">\n                                                        <span class="name autowrap">{{ relate_course.name }}</span>\n                                                    </a>\n                                                </li>\n                                        {% endfor %}\n                                        </ul>\n                                    </div>\n                                    <div class="cp-tab-pannel js-comp-tab-pannel" data-pannel="plan">\n                                        <ul class="other-list">\n                                            <li class="curr">\n                                                <a href="/course/programdetail/pid/31?src=sug" target="_blank">\n                                                    <img src="http://img.mukewang.com/56551e6700018b0c09600720-240-135.jpg"\n                                                         alt="Java工程师">\n                                                    <span class="name autowrap">Java工程师</span>\n                                                </a>\n                                            </li>\n                                        </ul>\n                                    </div>\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n                <div class="clear"></div>\n\n            </div>\n\n        </div>\n    </div>\n{% endblock %}\n\n\n{% block custom_js %}\n    <script>\n\n    let commit = function (url, course_id, comment) {\n        $.ajax({\n            cache: false,\n            type: \'POST\',\n            url: url,\n            data: {\'course_id\': course_id, \'comment\': comment},\n            async: true,\n            dataType: \'json\',\n            beforeSend: function (xhr, settings) {\n                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");\n            },\n            success: function (data) {\n\n                if (data.status == "fail") {\n                    if (data.msg == \'您还未登入，请先登录\') {\n                        window.location.href = \'/login/\';\n                    } else {\n\n                        alert(data.msg);\n                    }\n\n                } else if (data.status == "success") {\n                    // 重新刷新页面\n                    window.location.reload();\n                }\n            },\n            error: function (data) {\n                console.log(\'请求数据失败\');\n            },\n        });\n    };\n\n\n\n    // 触发提交\n    $("#js-pl-submit").on(\'click\', function () {\n        // 获取评论\n        let comment = $("#js-pl-textarea").val();\n\n\n        if(comment == ""){\n            alert("评论不能为空");\n            return\n        }\n        // 发送ajax请求\n        commit("{% url \'courses:add_comment\' %}", {{ course_id }}, comment)\n    });\n\n\n<\/script>\n{% endblock %}\n\n\n\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br"),e("span",{staticClass:"line-number"},[s._v("154")]),e("br"),e("span",{staticClass:"line-number"},[s._v("155")]),e("br"),e("span",{staticClass:"line-number"},[s._v("156")]),e("br"),e("span",{staticClass:"line-number"},[s._v("157")]),e("br"),e("span",{staticClass:"line-number"},[s._v("158")]),e("br"),e("span",{staticClass:"line-number"},[s._v("159")]),e("br"),e("span",{staticClass:"line-number"},[s._v("160")]),e("br"),e("span",{staticClass:"line-number"},[s._v("161")]),e("br"),e("span",{staticClass:"line-number"},[s._v("162")]),e("br"),e("span",{staticClass:"line-number"},[s._v("163")]),e("br"),e("span",{staticClass:"line-number"},[s._v("164")]),e("br"),e("span",{staticClass:"line-number"},[s._v("165")]),e("br"),e("span",{staticClass:"line-number"},[s._v("166")]),e("br"),e("span",{staticClass:"line-number"},[s._v("167")]),e("br"),e("span",{staticClass:"line-number"},[s._v("168")]),e("br"),e("span",{staticClass:"line-number"},[s._v("169")]),e("br"),e("span",{staticClass:"line-number"},[s._v("170")]),e("br"),e("span",{staticClass:"line-number"},[s._v("171")]),e("br"),e("span",{staticClass:"line-number"},[s._v("172")]),e("br"),e("span",{staticClass:"line-number"},[s._v("173")]),e("br"),e("span",{staticClass:"line-number"},[s._v("174")]),e("br"),e("span",{staticClass:"line-number"},[s._v("175")]),e("br"),e("span",{staticClass:"line-number"},[s._v("176")]),e("br"),e("span",{staticClass:"line-number"},[s._v("177")]),e("br"),e("span",{staticClass:"line-number"},[s._v("178")]),e("br"),e("span",{staticClass:"line-number"},[s._v("179")]),e("br"),e("span",{staticClass:"line-number"},[s._v("180")]),e("br"),e("span",{staticClass:"line-number"},[s._v("181")]),e("br"),e("span",{staticClass:"line-number"},[s._v("182")]),e("br"),e("span",{staticClass:"line-number"},[s._v("183")]),e("br"),e("span",{staticClass:"line-number"},[s._v("184")]),e("br"),e("span",{staticClass:"line-number"},[s._v("185")]),e("br"),e("span",{staticClass:"line-number"},[s._v("186")]),e("br"),e("span",{staticClass:"line-number"},[s._v("187")]),e("br"),e("span",{staticClass:"line-number"},[s._v("188")]),e("br"),e("span",{staticClass:"line-number"},[s._v("189")]),e("br"),e("span",{staticClass:"line-number"},[s._v("190")]),e("br"),e("span",{staticClass:"line-number"},[s._v("191")]),e("br"),e("span",{staticClass:"line-number"},[s._v("192")]),e("br"),e("span",{staticClass:"line-number"},[s._v("193")]),e("br"),e("span",{staticClass:"line-number"},[s._v("194")]),e("br"),e("span",{staticClass:"line-number"},[s._v("195")]),e("br"),e("span",{staticClass:"line-number"},[s._v("196")]),e("br"),e("span",{staticClass:"line-number"},[s._v("197")]),e("br"),e("span",{staticClass:"line-number"},[s._v("198")]),e("br"),e("span",{staticClass:"line-number"},[s._v("199")]),e("br"),e("span",{staticClass:"line-number"},[s._v("200")]),e("br"),e("span",{staticClass:"line-number"},[s._v("201")]),e("br"),e("span",{staticClass:"line-number"},[s._v("202")]),e("br"),e("span",{staticClass:"line-number"},[s._v("203")]),e("br"),e("span",{staticClass:"line-number"},[s._v("204")]),e("br"),e("span",{staticClass:"line-number"},[s._v("205")]),e("br"),e("span",{staticClass:"line-number"},[s._v("206")]),e("br"),e("span",{staticClass:"line-number"},[s._v("207")]),e("br"),e("span",{staticClass:"line-number"},[s._v("208")]),e("br"),e("span",{staticClass:"line-number"},[s._v("209")]),e("br"),e("span",{staticClass:"line-number"},[s._v("210")]),e("br"),e("span",{staticClass:"line-number"},[s._v("211")]),e("br"),e("span",{staticClass:"line-number"},[s._v("212")]),e("br"),e("span",{staticClass:"line-number"},[s._v("213")]),e("br"),e("span",{staticClass:"line-number"},[s._v("214")]),e("br"),e("span",{staticClass:"line-number"},[s._v("215")]),e("br"),e("span",{staticClass:"line-number"},[s._v("216")]),e("br"),e("span",{staticClass:"line-number"},[s._v("217")]),e("br"),e("span",{staticClass:"line-number"},[s._v("218")]),e("br"),e("span",{staticClass:"line-number"},[s._v("219")]),e("br"),e("span",{staticClass:"line-number"},[s._v("220")]),e("br"),e("span",{staticClass:"line-number"},[s._v("221")]),e("br"),e("span",{staticClass:"line-number"},[s._v("222")]),e("br"),e("span",{staticClass:"line-number"},[s._v("223")]),e("br"),e("span",{staticClass:"line-number"},[s._v("224")]),e("br"),e("span",{staticClass:"line-number"},[s._v("225")]),e("br"),e("span",{staticClass:"line-number"},[s._v("226")]),e("br"),e("span",{staticClass:"line-number"},[s._v("227")]),e("br"),e("span",{staticClass:"line-number"},[s._v("228")]),e("br"),e("span",{staticClass:"line-number"},[s._v("229")]),e("br"),e("span",{staticClass:"line-number"},[s._v("230")]),e("br"),e("span",{staticClass:"line-number"},[s._v("231")]),e("br"),e("span",{staticClass:"line-number"},[s._v("232")]),e("br"),e("span",{staticClass:"line-number"},[s._v("233")]),e("br"),e("span",{staticClass:"line-number"},[s._v("234")]),e("br"),e("span",{staticClass:"line-number"},[s._v("235")]),e("br"),e("span",{staticClass:"line-number"},[s._v("236")]),e("br"),e("span",{staticClass:"line-number"},[s._v("237")]),e("br"),e("span",{staticClass:"line-number"},[s._v("238")]),e("br"),e("span",{staticClass:"line-number"},[s._v("239")]),e("br"),e("span",{staticClass:"line-number"},[s._v("240")]),e("br"),e("span",{staticClass:"line-number"},[s._v("241")]),e("br"),e("span",{staticClass:"line-number"},[s._v("242")]),e("br"),e("span",{staticClass:"line-number"},[s._v("243")]),e("br"),e("span",{staticClass:"line-number"},[s._v("244")]),e("br"),e("span",{staticClass:"line-number"},[s._v("245")]),e("br"),e("span",{staticClass:"line-number"},[s._v("246")]),e("br"),e("span",{staticClass:"line-number"},[s._v("247")]),e("br"),e("span",{staticClass:"line-number"},[s._v("248")]),e("br"),e("span",{staticClass:"line-number"},[s._v("249")]),e("br"),e("span",{staticClass:"line-number"},[s._v("250")]),e("br"),e("span",{staticClass:"line-number"},[s._v("251")]),e("br"),e("span",{staticClass:"line-number"},[s._v("252")]),e("br")])]),e("ul",[e("li",[s._v("再编辑urls.py文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 课程详情页中的课程评论\nurl(r'^comment/(?P<course_id>\\d+)/', CourseCommentView.as_view(), name=\"course_comment\"),\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("编辑views.py,  LoginRequiredMixin可以先不要， 但是需要登录，如果bu'd'lu")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('# 处理课程评论的逻辑\nclass CourseCommentView(LoginRequiredMixin,View):\n    def get(self, request, course_id):\n\n        course = Course.objects.get(id=int(course_id))\n        all_resourses = course.get_course_resource()\n        all_comments = CourseConments.objects.filter(course=course)\n\n        # 处理"学过这些课程的同学还学习过哪些课程",\n        user_courses = UserCourse.objects.filter(course=course)  # 取出这个课程相关的所有的记录\n        user_ids = [user_course.user.id for user_course in user_courses]  # 获取学个这个课程的所有用户的id\n        all_user_courses = UserCourse.objects.filter(user_id__in=user_ids)  # 通过所有学过这么课程的用户的id，来获取不同的用户学习过的不同的课程记录\n        course_ids = [user_course.course.id for user_course in all_user_courses]  # 获取用户学到其他课程的所有的课程ID\n        relate_courses = Course.objects.filter(id__in=course_ids).exclude(name=course.name).order_by(\'-click_nums\')[:3]  # 通过课程ID找出相关的课程， 且排除当前课程\n\n        return render(request, \'course-comment.html\', {\n            "course_id": course_id,\n            "course": course,\n            "all_comments": all_comments,\n            "all_resourses": all_resourses,\n            "relate_courses": relate_courses,\n        })\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("ul",[e("li",[s._v("在course-video.html页面给course-comment.html页面一个跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<a id="commentOn" class="" href="{% url \'courses:course_comment\' course.id %}">\n\t<span>评论</span>\n</a>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("在course-comment.html页面给course-video.html页面一个跳转链接")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<a class="ui-tabs-active " id="learnOn" href="{% url \'courses:course_info\' course_id %}">\n\t<span>章节</span>\n</a>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[e("strong",[e("code",[s._v("在第四部分中开始开发评论的Ajax提交请求")])])])])])}),[],!1,null,null,null);n.default=t.exports}}]);