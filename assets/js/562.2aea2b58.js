(window.webpackJsonp=window.webpackJsonp||[]).push([[562],{2579:function(a,n,s){"use strict";s.r(n);var t=s(9),e=Object(t.a)({},(function(){var a=this,n=a.$createElement,s=a._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h3",{attrs:{id:"一-将pandas-dataframe转换为pyflink表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一-将pandas-dataframe转换为pyflink表"}},[a._v("#")]),a._v(" 一：将Pandas DataFrame转换为PyFlink表")]),a._v(" "),s("ul",[s("li",[a._v("PyFlink支持将Pandas DataFrame转换成PyFlink表。在内部实现上，会在客户端将Pandas DataFrame序列化成Arrow列存格式，序列化后的数据 在作业执行期间，在Arrow源中会被反序列化，并进行处理。Arrow源除了可以用在批作业中外，还可以用于流作业，它将正确处理检查点并提供恰好一次的保证。")])]),a._v(" "),s("h3",{attrs:{id:"一-示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一-示例"}},[a._v("#")]),a._v(" (一)：示例")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("import pandas as pd\nimport numpy as np\n\n# 创建一个Pandas DataFrame\npdf = pd.DataFrame(np.random.rand(1000, 2))\n\n# 由Pandas DataFrame创建PyFlink表\ntable = t_env.from_pandas(pdf)\n\n# 由Pandas DataFrame创建指定列名的PyFlink表\ntable = t_env.from_pandas(pdf, ['f0', 'f1'])\n\n# 由Pandas DataFrame创建指定列类型的PyFlink表\ntable = t_env.from_pandas(pdf, [DataTypes.DOUBLE(), DataTypes.DOUBLE()])\n\n# 由Pandas DataFrame创建列名和列类型的PyFlink表\ntable = t_env.from_pandas(pdf,\n                          DataTypes.ROW([DataTypes.FIELD(\"f0\", DataTypes.DOUBLE()),\n                                         DataTypes.FIELD(\"f1\", DataTypes.DOUBLE())])\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br")])]),s("h3",{attrs:{id:"二-将pyflink表转换为pandas-dataframe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二-将pyflink表转换为pandas-dataframe"}},[a._v("#")]),a._v(" 二：将PyFlink表转换为Pandas DataFrame")]),a._v(" "),s("ul",[s("li",[a._v("除此之外，还支持将PyFlink表转换为Pandas DataFrame。在内部实现上，它将执行表的计算逻辑，得到物化之后的表的执行结果，并 在客户端将其序列化为Arrow列存格式，最大Arrow批处理大小 由配置选项python.fn-execution.arrow.batch.size 确定。 序列化后的数据将被转换为Pandas DataFrame。这意味着需要把表的内容收集到客户端，因此在调用此函数之前，请确保表的内容可以容纳在内存中。")])]),a._v(" "),s("p",[a._v("以下示例显示了如何将PyFlink表转换为Pandas DataFrame：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('import pandas as pd\nimport numpy as np\n\n# 创建PyFlink Table\npdf = pd.DataFrame(np.random.rand(1000, 2))\ntable = t_env.from_pandas(pdf, ["a", "b"]).filter("a > 0.5")\n\n# 转换PyFlink Table为Pandas DataFrame\npdf = table.to_pandas()\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);