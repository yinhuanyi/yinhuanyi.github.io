(window.webpackJsonp=window.webpackJsonp||[]).push([[576],{2618:function(s,a,t){"use strict";t.r(a);var n=t(9),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"一-索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-索引"}},[s._v("#")]),s._v(" "),t("code",[s._v("(一) 索引")])]),s._v(" "),t("ul",[t("li",[s._v("索引就像是一张表的目录，在查找内容之前可以先在目录中查找索引位置，以此快速定位查询数据。保存索引数据的文件一般会与保存数据的目录分开")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("创建索引的依据：索引应该构建在经常被用作查询条件的字段上\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("当我们使用desc 查看表结构的时候，通常会看到PRI、UNI、MUL这三个key的类型")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PRI")]),s._v("：表示这个字段是主键约束，主键约束不能重复，也不能为空，一张表只能用一个主键\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UNI")]),s._v("：表示这个字段是唯一键约束，唯一键约束不能重复，但是可以为空\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MUL")]),s._v("：表示这个字段是一个复合约束\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[s._v("表索引类型")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：普通索引：仅加速查询\ncreate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("unique"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("fulltext"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("spacial"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" index 索引名称 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("btree"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("hass"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" on "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("表名称")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("字段"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 字段"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）create index name_and_age on "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("students")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）drop index name_and_age on students"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("）alter table students add index "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("age")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("）alter table students drop index age"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("）alter table students add primary "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("）alter table students drop primary key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：唯一索引：加速查询 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" 列值唯一（可以有"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v("）\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：主键索引：加速查询 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" 列值唯一 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("　表中只有一个（不可以有"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v("）\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("：组合索引：多列值组成一个索引，专门用于组合搜索，其效率大于索引合并\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("：全文索引：对文本的内容进行分词，进行搜索 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("ul",[t("li",[s._v("数据库索引类型")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("（一）"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TREE")]),s._v(" 索引：顺序索引，每一个叶子节点到根节点的距离是相同的，左前缀索引，适合查找范围内的数据 \n    适合"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tree索引的查询类型有：全键值，键值范围或键左前缀查找\n        全值匹配：精确查找某个值 \n        最左前缀匹配：只精确匹配起头部分，"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Qcache%'")]),s._v("\n        匹配范围值：id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n    不适合使用"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tree索引的场景\n        如果查找不是最左侧开始，索引无效\n        如果查询中某个列是范围查询，那么其右侧的列都无法再次使用索引优化查询\n\n\n（二）Hash索引：基于哈希表，特别适用于精确匹配索引中的所有列，但是只有memory存储引擎支持显示hash索引\n    适应场景：只支持值的比较，例如： id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n    不适用场景：模糊匹配查询、顺序查询\n\n（三）空间索引（"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SPATIAL")]),s._v("）"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("指依据空间对象的位置和形状或空间对象之间的某种空间关系按一定的顺序排列的一种数据结构\n    MyISAM支持空间索引\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("（四）全文索引")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FULLTEXT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：用于在文本中查找关键词\n     MyISAM支持全文索引\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("ul",[t("li",[s._v("索引优化策略")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：独立使用列，尽量避免其参与运算\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：左前缀索引：查询字段的时候，条件过滤时，最左前缀精确匹配\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：多列索引："),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AND")]),s._v(" 连接字段时适合多列索引；选择合适的索引次序，将选择性最高的放在左侧，范围匹配的放在右侧\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[s._v("索引的调优可以使用explain进行分析")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("explain select id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("name from students where name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yhy%'")]),s._v("\\"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("G")]),s._v("\n\n           id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  # 当前程序语句中每个select语句的编号 \n  select_type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SIMPLE")]),s._v("  # "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("查询类型，简单类型为simple，复杂类型为：subquery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("子查询"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("，derived（用户from中的子查询） union（union语句的第一个之后的select语句）union select（匿名临时表）\n        table"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" student1 # 查询关联到的表\n         type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ref  # 关联类型，或访问类型mysql如何查找表中的行的方式，all（全表扫描） index（根据索引的次序进行全表扫描，如果在extra列出现using index表示覆盖索引）range（服务扫描，有限制的根据索引实现的范围扫描，扫描位置为索引的某一点到另一点结束）ref（根据索引，返回表中所有匹配单个值的行） eq_ref（仅仅返回一行，但需要与某个参考值做比较） "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v("或system（直接返回单个行，效果最佳）\npossible_keys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" name_age_unique # 查询可能会用到的索引\n          key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" name_age_unique # 查询使用到的索引\n      key_len"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("752")]),s._v(" # 使用到索引中使用的字节数\n          ref"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" # 在利用key字段所表示的索引进行查询所用的列或某个常量值\n         rows"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" # mysql估计找到目标行所读取的行数\n        Extra"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Using where # 额外信息，如 using index（使用覆盖索引） using where （mysql服务器将在存储引擎内存层再进行过滤）using temporary（mysql对结果排序会使用临时表） using filesort（在磁盘创建临时表或内存中排序）\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("ul",[t("li",[s._v("查看表的状态")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：show table status\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：show table status like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'students'")]),s._v("\\"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("G")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"二-存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-存储引擎"}},[s._v("#")]),s._v(" "),t("code",[s._v("(二) 存储引擎")])]),s._v(" "),t("ul",[t("li",[s._v("Innodb 存储引擎")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 所有的InnoDB表的数据和索引存储于同一个表文件中，但是表数据和表结构分离，例如\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("opt\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8614")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" students"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("frm\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("98304")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" students"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ibd\n\n    db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("opt文件是存放表数据和表索引的\n    students"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("frm文件是存放表结构的\n    因此，表数据和表结构分离"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 每个表单独使用一个表文件来存储数据和索引\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：Mariadb默认的存储引擎是XtraDB，但是为了与MySQL兼容，因此也取名做InnoDB，因为MySQL的默认存储引擎是InnoDB。\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("：使用聚集索引（数据和索引在一起），也支持自适应hash索引，锁粒度为行级别，支持支持热备工具")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Xtrabackup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("：支持事务的存储引擎，适合处理大量的短期事务\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("ul",[t("li",[s._v("MyISAM 存储引擎")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：所有的MyISAM表的数据和索引存放在不同的文件中，表结构也分离，例如：\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10630")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("frm\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYD")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYI")]),s._v("\nuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("frm：为表结构\nuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYD")]),s._v("：为表数据\nuser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYI")]),s._v("：为表索引\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：支持全文索引（fulltext index），压缩，空间函数，\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：不支持事物，表级锁，适用于只读，读多写少\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"三-mysql的并发访问控制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-mysql的并发访问控制"}},[s._v("#")]),s._v(" "),t("code",[s._v("(三) MySQL的并发访问控制")])]),s._v(" "),t("ul",[t("li",[s._v("锁种类")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("读锁：共享锁，允许给其他人读，不允许他人写\n写锁：独占锁"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 不允许其他人读和写\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("锁类型")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("显示锁：用户手动请求读锁或写锁\n隐式锁：由存储引擎自行根据需要加的，无需我们管理\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("给表施加锁机制")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("（一）lock tables 方式\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：lock tables 表名称 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("read"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("      施加锁\n        例如：（"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）lock tables home read"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n             （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）lock tables home write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：unlock tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    给表解锁   \n\n\n（二）flush tables 方式\n\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：flush tables 表名称 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("read"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" lock"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：unlock tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"四-mysql-事物机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-mysql-事物机制"}},[s._v("#")]),s._v(" "),t("code",[s._v("(四) MySQL 事物机制")])]),s._v(" "),t("ul",[t("li",[s._v("事物日志介绍：管理事物机制的日志")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("redo日志：记录"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("执行的语句，这些"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("语句还没有同步到磁盘上，没有修改数据。如果数据奔溃，可以通过撤销"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("执行的语句来进行还原。但是，如果已经同步到磁盘上的"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("语句而言，就只能使用undo来回滚之前的数据了\nundo日志：记录没有执行"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL")]),s._v("的样子，也就是记录修改数据之前的数据记录下来\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("ACID测试：用来判断存储引擎是否满足事物机制")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("A")]),s._v("：automicity"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 原子性，整个事物中的所有操作要么全部成功提交，要么全部失败回滚\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("C")]),s._v("：consistency "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 一致性，数据库总是从一个一致性状态转化为另一个一致性状态\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("I")]),s._v("：isolation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 隔离性，事物不会相互影响，一个事物所作出的操作在提交之前，是不能为其他事物所见，隔离有多种级别，主要是为了并发\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("D")]),s._v("：durability "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 持久性，事物一旦提交，其所作的修改会保存在数据库中，不能丢失\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("事物操作演示1")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：show global variables where Variable_name like "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%commit%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  查看全局变量\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("："),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" session autocommit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 修改事务日志自动提交功能 \n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：show variables where Variable_name like ‘"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("commit"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 查看当前会话的全局变量\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("：start transaction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  启用事务日志机制\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("：在表中插入数据，但是不提交（commit）\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("：rollback"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 事务回滚\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("ul",[t("li",[s._v("事物操作演示2")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：insert into home "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("values")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yhy1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 添加一条记录\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：savepoint first"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 设置一个保存点\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：update home "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yhy2'")]),s._v(" where id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 跟新一条记录\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("：savepoint second"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 设置第二个保持点\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("：insert into home "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("values")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yhy3'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 再添加一条记录\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("：rollback to second"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 回滚到第二个保存点\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("：rollback to first"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 回顾到第一个保持点\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("：commit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 提交数据\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"五-mysql-用户及权限管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五-mysql-用户及权限管理"}},[s._v("#")]),s._v(" "),t("code",[s._v("(五) MySQL 用户及权限管理")])]),s._v(" "),t("ul",[t("li",[s._v("用户账号的管理")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：创建用户\n    create user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uplooking'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.%.%'")]),s._v(" identified by "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 创建用户和密码\n    show grants "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uplooking'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.%.%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   查看用户的权限\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：删除用户\n    drop user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uplooking'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.%.%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("：修改用户的登入密码\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uplooking'")]),s._v("@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.%.%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    （"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）使用update命令，直接修改 mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user 用户表，修改之后flush priveleges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"六-mysql-忘记root密码怎么办"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六-mysql-忘记root密码怎么办"}},[s._v("#")]),s._v(" "),t("code",[s._v("(六) MySQL 忘记root密码怎么办")])]),s._v(" "),t("ul",[t("li",[s._v("对于RedHat 7 而言")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("（"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）编辑"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("systemd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("system"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mariadb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service文件，在mysqld_safe 后面加上"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("skip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("grant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tables "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("skip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("networking\n（"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）使用update命令修改管理员密码，且让进程重读权限表\n（"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("）停止mysqd进程，移除上述两个选项，重启mysqld\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[s._v("对于 RedHat 6 或 RedHat 7")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("直接在"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf文件中，找到"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("，在后面加上下面两个指令，就ok了\n    skip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("grant"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tables"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on\n    skip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("networking"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"七-mysql-查询缓存机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七-mysql-查询缓存机制"}},[s._v("#")]),s._v(" "),t("code",[s._v("(七) MySQL 查询缓存机制")])]),s._v(" "),t("ul",[t("li",[s._v("查询缓存机制：缓存的是查询语句的整个查询结果，是一个完整的select语句的缓存结果")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("哪些查询可能不会被缓存 ：查询中包含"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UDF")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("、存储函数、用户自定义变量、临时表、mysql库中系统表、或者包含列级别的权限表、有着不确定值的函数，如：now")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n与查询缓存相关的服务器全局变量"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\nquery_cache_min_res_unit：查询缓存分配内存块的最小的分配单位，较小的值较少内存浪费，但是会导致更加平凡的内存分配操作 ，较大的值会导致浪费\nquery_cache_limit：能够缓存的最大查询结果，对有较大结果的查询语句，建议在select中使用"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SQL_NO_CACHE")]),s._v("\nquery_cache_size：查询缓存总共可用的内存空间，单位是字节，必须是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("整数倍`\nquery_cache_type："),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OFF")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEMAND")]),s._v("\nquery_cache_wlock_invalidate：如果某个数据表被其他的连接锁定，是否仍然可以从查询缓存中返回结果，默认值为off，表示可以返回数据，on为不允许\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("缓存命中率---\x3e MySQL数据库调优依据")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("缓存命中率计算公式： Qcache_hits "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Qcache_hits"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Com_select"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);