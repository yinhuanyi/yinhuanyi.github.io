(window.webpackJsonp=window.webpackJsonp||[]).push([[609],{2675:function(t,s,a){"use strict";a.r(s);var e=a(9),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"一-依赖安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-依赖安装"}},[t._v("#")]),t._v(" 一："),a("code",[t._v("依赖安装")])]),t._v(" "),a("h3",{attrs:{id:"一-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-安装"}},[t._v("#")]),t._v(" (一) 安装")]),t._v(" "),a("ul",[a("li",[t._v("安装依赖")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum install -y gcc gcc-c++ autoconf pcre pcre-devel make automake wget httpd-tools vim\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("配置目录")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd /opt && mkdir app backup logs download work\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"二-nginx处理网络io"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-nginx处理网络io"}},[t._v("#")]),t._v(" 二："),a("code",[t._v("Nginx处理网络IO")])]),t._v(" "),a("h3",{attrs:{id:"一-实现io流非阻塞模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-实现io流非阻塞模式"}},[t._v("#")]),t._v(" (一) 实现IO流非阻塞模式")]),t._v(" "),a("ul",[a("li",[t._v("思想：基于循环一直遍历stream列表，如果有数据需要处理，就处理。缺陷：当stream列表中都没有数据，会浪费CPU资源")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("while True:\n\tfor i in stream_list:\n\t\tif i has data:\n\t\t\tread until unavailable\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"二-select模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-select模型"}},[t._v("#")]),t._v(" (二) SELECT模型")]),t._v(" "),a("ul",[a("li",[t._v("思想：select函数相当于一个代理，会把有数据的stream流过滤出来")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("while True:\n\tselect(stream_list) # 将有数据的stream过滤出来\n\tfor i in stream_list_data: # 对有数据的stream列表进行遍历\n\t\tif i has data:\n\t\t\tread until unavailable\n\t\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h3",{attrs:{id:"三-epoll模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-epoll模型"}},[t._v("#")]),t._v(" (三) Epoll模型")]),t._v(" "),a("ul",[a("li",[t._v("思想：解决了SELECT模型对文件句柄的打开限制，常用callback回调机制")])]),t._v(" "),a("h3",{attrs:{id:"三-nginx的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-nginx的优势"}},[t._v("#")]),t._v(" 三："),a("code",[t._v("Nginx的优势")])]),t._v(" "),a("ul",[a("li",[t._v("1：CPU亲缘性")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("在配置文件中，可以定义NGINX使用的CPU个数，让不同的worker绑定到不同的CPU上，避免了CPU频繁切换\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("2：sendfile")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("在处理静态文件的时候，数据的传输无需经过用户层空间，直接在内核空间即可完成二进制数据传输，这就是sendfile的作用\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"四-nginx的安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-nginx的安装"}},[t._v("#")]),t._v(" 四："),a("code",[t._v("Nginx的安装")])]),t._v(" "),a("h3",{attrs:{id:"一-nginx最新版本安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-nginx最新版本安装"}},[t._v("#")]),t._v(" (一) Nginx最新版本安装")]),t._v(" "),a("ul",[a("li",[t._v("编辑/etc/yum.repos.d/nginx.repo")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[nginx-stable]\nname=nginx stable repo\nbaseurl=http://nginx.org/packages/centos/$releasever/$basearch/\ngpgcheck=1\nenabled=1\ngpgkey=https://nginx.org/keys/nginx_signing.key\nmodule_hotfixes=true\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("ul",[a("li",[t._v("安装")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum install yum-utils\nyum install nginx\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("查看版本号和编译参数")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[root@node1 ~]# nginx -v\nnginx version: nginx/1.18.0\n\n[root@node1 ~]# nginx -V\nnginx version: nginx/1.18.0\nbuilt by gcc 4.8.5 20150623 (Red Hat 4.8.5-39) (GCC) \nbuilt with OpenSSL 1.0.2k-fips  26 Jan 2017\nTLS SNI support enabled\nconfigure arguments: --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-compat --with-file-aio --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -fPIC' --with-ld-opt='-Wl,-z,relro -Wl,-z,now -pie'\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("ul",[a("li",[t._v("查看NGINX的安装目录")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("rpm -ql nginx\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"二-nginx基本配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-nginx基本配置"}},[t._v("#")]),t._v(" (二) Nginx基本配置")]),t._v(" "),a("ul",[a("li",[t._v("虚拟主机配置方式")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1: 基于主机多IP方式\n2：基于端口的配置\n3：基于多个host名称的方式 （使用较多）\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);